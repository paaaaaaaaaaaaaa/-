<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>КиберСфера</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚡</text></svg>" />
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        
        /* МОДЕРНИЗИРОВАННЫЕ КУРСОРЫ В СТИЛЕ CYBERPUNK 2077 */
/* Улучшенные: оптимизированные SVG, добавлены анимации, исправлены проблемы с производительностью */

/* Основной курсор - УЛУЧШЕННЫЙ */
* {
    cursor: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><defs><filter id="cyber-glow"><feGaussianBlur stdDeviation="1.5" result="blur"/><feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge></filter><radialGradient id="cyber-main"><stop offset="0%" stop-color="%2300f3ff"/><stop offset="70%" stop-color="%23ff00c8"/><stop offset="100%" stop-color="%239d00ff"/></radialGradient></defs><g filter="url(%23cyber-glow)"><path d="M16 4 L28 16 L16 28 L4 16 Z" fill="none" stroke="url(%23cyber-main)" stroke-width="1.8" stroke-linejoin="round"/><circle cx="16" cy="16" r="3" fill="%2300f3ff"><animate attributeName="r" values="3;2.5;3" dur="2s" repeatCount="indefinite"/></circle><circle cx="16" cy="16" r="1" fill="%23ffffff"/></g></svg>') 16 16, auto;
}

/* Курсор для кликабельных элементов - УЛУЧШЕННЫЙ */
a, button, .btn, .auth-btn, .register-btn, .buy-btn, .nav-link, 
.grid-item, .service-card, .product-card, .tournament-item,
.gallery-item, .review-card, .contact-item, .stat, .payment-method,
.zone-option, .admin-tab, .social-link, .settings-btn,
.user-avatar-with-balance, .admin-vk-button,
input[type="submit"], input[type="button"], .modal-close,
.burger-menu, .switch, .slider, .checkbox-group input,
[role="button"], [onclick], [data-page], .clickable {
    cursor: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><defs><filter id="cyber-hover-glow"><feGaussianBlur stdDeviation="2" result="blur"/><feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge></filter><radialGradient id="cyber-hover"><stop offset="0%" stop-color="%23ff00c8"/><stop offset="60%" stop-color="%2300f3ff"/><stop offset="100%" stop-color="%239d00ff"/></radialGradient></defs><g filter="url(%23cyber-hover-glow)"><rect x="8" y="8" width="16" height="16" rx="3" fill="none" stroke="url(%23cyber-hover)" stroke-width="1.8"/><circle cx="16" cy="16" r="3.5" fill="%23ffffff"><animate attributeName="r" values="3.5;4;3.5" dur="1.5s" repeatCount="indefinite"/></circle><path d="M12 12 L20 20 M20 12 L12 20" stroke="%23ffffff" stroke-width="1.5" stroke-linecap="round"/></g></svg>') 16 16, pointer;
}

/* Курсор для текстовых полей - УЛУЧШЕННЫЙ */
input[type="text"], input[type="email"], input[type="password"], 
input[type="tel"], input[type="number"], input[type="date"], 
input[type="time"], input[type="datetime-local"], input[type="url"],
textarea, [contenteditable="true"], [contenteditable] {
    cursor: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><defs><filter id="cyber-text-glow"><feGaussianBlur stdDeviation="1.5" result="blur"/><feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge></filter><radialGradient id="cyber-text"><stop offset="0%" stop-color="%2300ff88"/><stop offset="60%" stop-color="%2300f3ff"/><stop offset="100%" stop-color="%23ff00c8"/></radialGradient></defs><g filter="url(%23cyber-text-glow)"><rect x="10" y="8" width="12" height="18" rx="2" fill="none" stroke="url(%23cyber-text)" stroke-width="1.8"/><rect x="12" y="12" width="8" height="1.5" fill="%23ffffff"><animate attributeName="height" values="1.5;4;1.5" dur="1s" repeatCount="indefinite"/></rect><rect x="12" y="17" width="8" height="1.5" fill="%23ffffff"/><rect x="12" y="22" width="8" height="1.5" fill="%23ffffff"/></g></svg>') 16 16, text;
}

/* Курсор загрузки - УЛУЧШЕННЫЙ */
.preloader, .loading-bar, .loading-progress, [aria-busy="true"], 
.waiting, .loading, .progress {
    cursor: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><defs><filter id="cyber-load-glow"><feGaussianBlur stdDeviation="2" result="blur"/><feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge></filter><radialGradient id="cyber-load"><stop offset="0%" stop-color="%23ffee00"/><stop offset="50%" stop-color="%23ff7700"/><stop offset="100%" stop-color="%23ff00c8"/></radialGradient></defs><g filter="url(%23cyber-load-glow)"><circle cx="16" cy="16" r="13" fill="none" stroke="url(%23cyber-load)" stroke-width="2" stroke-dasharray="60 20"><animateTransform attributeName="transform" type="rotate" from="0 16 16" to="360 16 16" dur="1.5s" repeatCount="indefinite"/></circle><circle cx="16" cy="16" r="4" fill="%23ffffff"><animate attributeName="fill" values="%23ffffff;%23ffee00;%23ffffff" dur="2s" repeatCount="indefinite"/></circle></g></svg>') 16 16, wait;
}

/* Курсор запрета - УЛУЧШЕННЫЙ */
.btn:disabled, input:disabled, button:disabled, .auth-btn:disabled,
.disabled, [aria-disabled="true"], .not-allowed {
    cursor: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><defs><filter id="cyber-disabled-glow"><feGaussianBlur stdDeviation="1.5" result="blur"/><feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge></filter><radialGradient id="cyber-disabled"><stop offset="0%" stop-color="%23ff0000"/><stop offset="60%" stop-color="%23ff7700"/><stop offset="100%" stop-color="%23ffee00"/></radialGradient></defs><g filter="url(%23cyber-disabled-glow)"><circle cx="16" cy="16" r="11" fill="none" stroke="url(%23cyber-disabled)" stroke-width="1.8"/><path d="M10 10 L22 22 M22 10 L10 22" stroke="%23ffffff" stroke-width="2" stroke-linecap="round"/><circle cx="16" cy="16" r="2.5" fill="%23ffffff"><animate attributeName="fill" values="%23ffffff;%23ff0000;%23ffffff" dur="1.5s" repeatCount="indefinite"/></circle></g></svg>') 16 16, not-allowed;
}

/* Курсор перемещения - НОВЫЙ */
[data-draggable], .draggable, .sortable, .move-cursor {
    cursor: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><defs><filter id="cyber-move-glow"><feGaussianBlur stdDeviation="1.5" result="blur"/><feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge></filter><radialGradient id="cyber-move"><stop offset="0%" stop-color="%2300f3ff"/><stop offset="60%" stop-color="%239d00ff"/><stop offset="100%" stop-color="%2300ff88"/></radialGradient></defs><g filter="url(%23cyber-move-glow)"><circle cx="16" cy="16" r="10" fill="none" stroke="url(%23cyber-move)" stroke-width="1.8"/><path d="M16 8 L16 24 M8 16 L24 16" stroke="%23ffffff" stroke-width="1.5" stroke-linecap="round"/><circle cx="16" cy="16" r="3" fill="%2300ff88"><animate attributeName="cx" values="16;17;16;15;16" dur="2s" repeatCount="indefinite"/><animate attributeName="cy" values="16;17;16;15;16" dur="2.5s" repeatCount="indefinite"/></circle></g></svg>') 16 16, move;
}

/* Курсор изменения размера - НОВЫЙ */
.resize, .resizable, [data-resizable] {
    cursor: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><defs><filter id="cyber-resize-glow"><feGaussianBlur stdDeviation="1.5" result="blur"/><feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge></filter><radialGradient id="cyber-resize"><stop offset="0%" stop-color="%23ff00c8"/><stop offset="60%" stop-color="%23ff7700"/><stop offset="100%" stop-color="%23ffee00"/></radialGradient></defs><g filter="url(%23cyber-resize-glow)"><path d="M8 8 L24 24 M24 8 L8 24" stroke="url(%23cyber-resize)" stroke-width="1.8" stroke-linecap="round"/><circle cx="16" cy="16" r="3" fill="%23ffffff"><animate attributeName="r" values="3;4;3" dur="1s" repeatCount="indefinite"/></circle><path d="M10 22 L14 18 L18 22 L22 18" stroke="%23ffffff" stroke-width="1" fill="none"/></g></svg>') 16 16, nwse-resize;
}

/* Курсор помощи/справки - НОВЫЙ */
[title]:not([title=""]), [data-tooltip], .help-cursor {
    cursor: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><defs><filter id="cyber-help-glow"><feGaussianBlur stdDeviation="1.5" result="blur"/><feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge></filter><radialGradient id="cyber-help"><stop offset="0%" stop-color="%2300f3ff"/><stop offset="60%" stop-color="%2300ff88"/><stop offset="100%" stop-color="%239d00ff"/></radialGradient></defs><g filter="url(%23cyber-help-glow)"><circle cx="16" cy="16" r="11" fill="none" stroke="url(%23cyber-help)" stroke-width="1.8"/><circle cx="16" cy="12" r="1.5" fill="%23ffffff"/><path d="M16 16 L16 22" stroke="%23ffffff" stroke-width="1.5" stroke-linecap="round"><animate attributeName="y2" values="22;24;22" dur="1.5s" repeatCount="indefinite"/></path><circle cx="16" cy="16" r="2.5" fill="%2300ff88" opacity="0.5"/></g></svg>') 16 16, help;
}

/* Курсор для ссылок на внешние ресурсы - НОВЫЙ */
a[href^="http"]:not([href*="kibersfera"]), a[target="_blank"], .external-link {
    cursor: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><defs><filter id="cyber-external-glow"><feGaussianBlur stdDeviation="1.5" result="blur"/><feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge></filter><radialGradient id="cyber-external"><stop offset="0%" stop-color="%2300ff88"/><stop offset="60%" stop-color="%2300f3ff"/><stop offset="100%" stop-color="%239d00ff"/></radialGradient></defs><g filter="url(%23cyber-external-glow)"><path d="M12 12 L20 12 L20 20 M12 12 L20 20" stroke="url(%23cyber-external)" stroke-width="1.8" stroke-linecap="round" fill="none"/><circle cx="20" cy="12" r="2" fill="%23ffffff"><animate attributeName="r" values="2;2.5;2" dur="1s" repeatCount="indefinite"/></circle><circle cx="12" cy="20" r="2" fill="%23ffffff"/><path d="M20 8 L24 8 L24 12" stroke="%23ffffff" stroke-width="1" stroke-linecap="round"/></g></svg>') 16 16, alias;
}

/* Анимация пульсации для всех курсоров при наведении */
a:hover, button:hover, .btn:hover, .nav-link:hover, 
.grid-item:hover, .service-card:hover, .product-card:hover,
.gallery-item:hover, .review-card:hover, .social-link:hover {
    animation: cursorPulse 0.5s ease-in-out;
}

@keyframes cursorPulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(0.98); }
}

/* Улучшенная производительность курсоров */
* {
    image-rendering: optimizeSpeed;
    image-rendering: -moz-crisp-edges;
    image-rendering: -webkit-optimize-contrast;
    image-rendering: optimize-contrast;
    image-rendering: pixelated;
    -ms-interpolation-mode: nearest-neighbor;
}

/* Оптимизация для устройств с сенсорным экраном */
@media (hover: none) and (pointer: coarse) {
    /* На мобильных устройствах используем стандартные курсоры для лучшей производительности */
    * {
        cursor: auto !important;
    }
    
    a, button, .btn, .nav-link {
        cursor: pointer !important;
    }
    
    input, textarea {
        cursor: text !important;
    }
}

/* Улучшенная поддержка для браузеров с ограниченной поддержкой SVG курсоров */
@supports not (cursor: url('data:image/svg+xml,<svg/>'), pointer) {
    a, button, .btn, .nav-link {
        cursor: pointer;
    }
    
    input, textarea {
        cursor: text;
    }
    
    .preloader, .loading-bar {
        cursor: wait;
    }
    
    .btn:disabled, input:disabled {
        cursor: not-allowed;
    }
}

/* Оптимизация для темной/светлой темы */
.light-theme {
    /* Для светлой темы уменьшаем интенсивность свечения */
    * {
        cursor: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><defs><filter id="cyber-glow-light"><feGaussianBlur stdDeviation="1" result="blur"/><feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge></filter><radialGradient id="cyber-main-light"><stop offset="0%" stop-color="%23008cff"/><stop offset="70%" stop-color="%23d400a6"/><stop offset="100%" stop-color="%237a00cc"/></radialGradient></defs><g filter="url(%23cyber-glow-light)"><path d="M16 4 L28 16 L16 28 L4 16 Z" fill="none" stroke="url(%23cyber-main-light)" stroke-width="1.5" stroke-linejoin="round"/><circle cx="16" cy="16" r="2.5" fill="%23008cff"/><circle cx="16" cy="16" r="1" fill="%231a1a2e"/></g></svg>') 16 16, auto;
    }
}

/* Исправление для элементов, которые должны иметь стандартный курсор */
select, .no-cyber-cursor {
    cursor: default !important;
}

/* Оптимизация для элементов с динамическим контентом */
.dynamic-content, .ajax-content, .lazy-load {
    cursor: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><defs><filter id="cyber-dynamic-glow"><feGaussianBlur stdDeviation="1" result="blur"/><feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge></filter><radialGradient id="cyber-dynamic"><stop offset="0%" stop-color="%2300f3ff"/><stop offset="60%" stop-color="%239d00ff"/><stop offset="100%" stop-color="%2300ff88"/></radialGradient></defs><g filter="url(%23cyber-dynamic-glow)"><circle cx="16" cy="16" r="10" fill="none" stroke="url(%23cyber-dynamic)" stroke-width="1.5" stroke-dasharray="3,3"/><circle cx="16" cy="16" r="4" fill="%23ffffff"><animateTransform attributeName="transform" type="rotate" from="0 16 16" to="360 16 16" dur="3s" repeatCount="indefinite"/></circle></g></svg>') 16 16, progress;
}

        :root {
            --neon-cyan: #00f3ff;
            --neon-pink: #ff00c8;
            --neon-purple: #9d00ff;
            --neon-green: #00ff88;
            --neon-yellow: #ffee00;
            --neon-orange: #ff7700;
            --neon-red: #ff0000;
            --dark-bg: #0a0a12;
            --darker-bg: #050508;
            --panel-bg: rgba(15, 15, 25, 0.9);
            --text-primary: #e0e0ff;
            --text-secondary: #a0a0c0;
            --glow-cyan: 0 0 10px rgba(0, 243, 255, 0.7), 0 0 20px rgba(0, 243, 255, 0.5), 0 0 30px rgba(0, 243, 255, 0.3);
            --glow-pink: 0 0 10px rgba(255, 0, 200, 0.7), 0 0 20px rgba(255, 0, 200, 0.5), 0 0 30px rgba(255, 0, 200, 0.3);
            --glow-purple: 0 0 10px rgba(157, 0, 255, 0.7), 0 0 20px rgba(157, 0, 255, 0.5), 0 0 30px rgba(157, 0, 255, 0.3);
            --glow-red: 0 0 10px rgba(255, 0, 0, 0.7), 0 0 20px rgba(255, 0, 0, 0.5), 0 0 30px rgba(255, 0, 0, 0.3);
        }

        /* Светлая тема */
        .light-theme {
            --neon-cyan: #008cff;
            --neon-pink: #d400a6;
            --neon-purple: #7a00cc;
            --neon-green: #00cc6a;
            --neon-yellow: #e6d800;
            --neon-orange: #e65c00;
            --neon-red: #cc0000;
            --dark-bg: #f0f2f5;
            --darker-bg: #e1e5eb;
            --panel-bg: rgba(255, 255, 255, 0.95);
            --text-primary: #1a1a2e;
            --text-secondary: #4a4a6e;
            --glow-cyan: 0 0 10px rgba(0, 140, 255, 0.5), 0 0 20px rgba(0, 140, 255, 0.3);
            --glow-pink: 0 0 10px rgba(212, 0, 166, 0.5), 0 0 20px rgba(212, 0, 166, 0.3);
            --glow-purple: 0 0 10px rgba(122, 0, 204, 0.5), 0 0 20px rgba(122, 0, 204, 0.3);
            --glow-red: 0 0 10px rgba(204, 0, 0, 0.5), 0 0 20px rgba(204, 0, 0, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Orbitron', monospace;
            background-color: var(--dark-bg);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
            transition: all 0.5s ease;
        }

        /* Улучшенный прелоадер - ЦЕНТРИРОВАННЫЙ */
        .preloader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--darker-bg);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 1s ease, visibility 1s ease;
        }

        .preloader.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .loader-container {
            text-align: center;
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 100%;
            height: 100%;
        }

        .loader-rings {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 300px;
            height: 300px;
        }

        .loader-ring {
            position: absolute;
            border-radius: 50%;
            border: 2px solid transparent;
            animation: rotate 3s linear infinite;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            margin: auto;
        }

        .ring-1 {
            width: 240px;
            height: 240px;
            border-top: 2px solid var(--neon-cyan);
            border-bottom: 2px solid var(--neon-cyan);
            animation-duration: 4s;
        }

        .ring-2 {
            width: 280px;
            height: 280px;
            border-left: 2px solid var(--neon-pink);
            border-right: 2px solid var(--neon-pink);
            animation-duration: 6s;
            animation-direction: reverse;
        }

        .ring-3 {
            width: 320px;
            height: 320px;
            border-top: 2px solid var(--neon-purple);
            border-bottom: 2px solid var(--neon-purple);
            animation-duration: 8s;
        }

        .loader-logo {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            background: conic-gradient(from 0deg, var(--neon-cyan), var(--neon-pink), var(--neon-purple), var(--neon-cyan));
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            animation: rotate 3s linear infinite, pulse 2s infinite alternate, glowPulse 4s infinite alternate;
            box-shadow: 
                0 0 30px var(--neon-cyan),
                0 0 60px var(--neon-pink),
                0 0 90px var(--neon-purple);
            margin: 0 auto 2rem;
            position: relative;
            z-index: 2;
        }

        .loader-logo::before {
            content: '';
            position: absolute;
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: var(--darker-bg);
        }

        .loader-logo::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--neon-cyan);
            box-shadow: 0 0 20px var(--neon-cyan);
            animation: pulseDot 2s infinite alternate;
        }

        .loader-text {
            font-size: 3rem;
            font-weight: 900;
            background: linear-gradient(90deg, var(--neon-cyan), var(--neon-pink), var(--neon-purple));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-transform: uppercase;
            letter-spacing: 6px;
            text-shadow: 0 0 20px rgba(0, 243, 255, 0.7);
            animation: textGlow 2s infinite alternate, textShake 5s infinite;
            margin-bottom: 1rem;
            position: relative;
            z-index: 2;
        }

        .loader-subtitle {
            margin-top: 1rem;
            color: var(--text-secondary);
            font-size: 1.2rem;
            letter-spacing: 3px;
            animation: fadeInOut 3s infinite, subtitleSlide 4s infinite;
            position: relative;
            z-index: 2;
        }

        .loading-bar {
            width: 400px;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            margin: 3rem auto 0;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
            box-shadow: 0 0 10px rgba(0, 243, 255, 0.3);
            position: relative;
            z-index: 2;
        }

        .loading-progress {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, var(--neon-cyan), var(--neon-pink), var(--neon-purple));
            border-radius: 10px;
            transition: width 0.3s ease;
            box-shadow: 0 0 20px var(--neon-cyan);
            position: relative;
            overflow: hidden;
        }

        .loading-progress::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: loadingShine 2s infinite;
        }

        .lightning-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
            overflow: hidden;
        }

        .lightning {
            position: absolute;
            width: 100%;
            height: 3px;
            background: linear-gradient(to right, transparent, var(--neon-red), transparent);
            box-shadow: 
                0 0 10px var(--neon-red),
                0 0 20px var(--neon-red),
                0 0 30px var(--neon-red);
            opacity: 0;
            animation: lightningFlash 3s infinite;
            filter: blur(1px);
        }

        .lightning::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to right, transparent, rgba(255, 0, 0, 0.7), transparent);
            filter: blur(3px);
        }

        /* Остальные анимации */
        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 0 30px var(--neon-cyan), 0 0 60px var(--neon-pink), 0 0 90px var(--neon-purple); }
            50% { transform: scale(1.08); box-shadow: 0 0 40px var(--neon-cyan), 0 0 80px var(--neon-pink), 0 0 120px var(--neon-purple); }
            100% { transform: scale(1); box-shadow: 0 0 30px var(--neon-cyan), 0 0 60px var(--neon-pink), 0 0 90px var(--neon-purple); }
        }

        @keyframes pulseDot {
            0% { transform: scale(1); box-shadow: 0 0 10px var(--neon-cyan); }
            100% { transform: scale(1.3); box-shadow: 0 0 25px var(--neon-cyan), 0 0 40px var(--neon-cyan); }
        }

        @keyframes glowPulse {
            0% { opacity: 0.5; }
            100% { opacity: 0.9; }
        }

        @keyframes textGlow {
            0% { text-shadow: 0 0 10px rgba(0, 243, 255, 0.5); filter: brightness(1); }
            50% { text-shadow: 0 0 30px rgba(0, 243, 255, 0.9), 0 0 50px rgba(255, 0, 200, 0.7); filter: brightness(1.3); }
            100% { text-shadow: 0 0 10px rgba(0, 243, 255, 0.5); filter: brightness(1); }
        }

        @keyframes textShake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-2px); }
            20%, 40%, 60%, 80% { transform: translateX(2px); }
        }

        @keyframes fadeInOut {
            0% { opacity: 0.3; }
            50% { opacity: 1; }
            100% { opacity: 0.3; }
        }

        @keyframes subtitleSlide {
            0% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
            100% { transform: translateY(0); }
        }

        @keyframes loadingShine {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        @keyframes lightningFlash {
            0% { opacity: 0; transform: translateX(-100%); }
            1% { opacity: 1; transform: translateX(0); }
            2% { opacity: 0.5; transform: translateX(10%); }
            3% { opacity: 1; transform: translateX(20%); }
            4% { opacity: 0; transform: translateX(30%); }
            100% { opacity: 0; transform: translateX(100%); }
        }

        @keyframes lightningFlashReverse {
            0% { opacity: 0; transform: translateX(100%); }
            1% { opacity: 1; transform: translateX(0); }
            2% { opacity: 0.5; transform: translateX(-10%); }
            3% { opacity: 1; transform: translateX(-20%); }
            4% { opacity: 0; transform: translateX(-30%); }
            100% { opacity: 0; transform: translateX(-100%); }
        }

        /* Улучшенный киберпанк фон */
        .cyber-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -4;
            background: 
                radial-gradient(circle at 20% 30%, rgba(0, 243, 255, 0.08) 0%, transparent 25%),
                radial-gradient(circle at 80% 70%, rgba(255, 0, 200, 0.08) 0%, transparent 25%),
                radial-gradient(circle at 40% 80%, rgba(157, 0, 255, 0.08) 0%, transparent 25%),
                radial-gradient(circle at 60% 20%, rgba(0, 255, 136, 0.08) 0%, transparent 25%),
                linear-gradient(135deg, #0a0a12 0%, #0d0d1a 50%, #0a0a12 100%);
        }

        .light-theme .cyber-bg {
            background: 
                radial-gradient(circle at 20% 30%, rgba(0, 140, 255, 0.08) 0%, transparent 25%),
                radial-gradient(circle at 80% 70%, rgba(212, 0, 166, 0.08) 0%, transparent 25%),
                radial-gradient(circle at 40% 80%, rgba(122, 0, 204, 0.08) 0%, transparent 25%),
                radial-gradient(circle at 60% 20%, rgba(0, 204, 106, 0.08) 0%, transparent 25%),
                linear-gradient(135deg, #f0f2f5 0%, #e1e5eb 50%, #f0f2f5 100%);
        }

        .grid-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(0, 243, 255, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 243, 255, 0.05) 1px, transparent 1px);
            background-size: 40px 40px;
            z-index: -3;
            opacity: 0.4;
            animation: gridMove 20s linear infinite;
        }

        .light-theme .grid-overlay {
            background-image: 
                linear-gradient(rgba(0, 140, 255, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 140, 255, 0.05) 1px, transparent 1px);
        }

        @keyframes gridMove {
            0% { transform: translate(0, 0); }
            100% { transform: translate(40px, 40px); }
        }

        .scanline {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--neon-cyan), var(--neon-pink), transparent);
            z-index: -2;
            animation: scan 6s linear infinite;
            opacity: 0.5;
            box-shadow: 0 0 10px var(--neon-cyan);
        }

        @keyframes scan {
            0% { top: 0%; opacity: 0; }
            10% { opacity: 0.7; }
            90% { opacity: 0.7; }
            100% { top: 100%; opacity: 0; }
        }

        /* Плавающие частицы */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            overflow: hidden;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background: var(--neon-cyan);
            box-shadow: 0 0 10px var(--neon-cyan);
            animation: float 15s infinite linear;
        }

        .particle:nth-child(2n) {
            background: var(--neon-pink);
            box-shadow: 0 0 10px var(--neon-pink);
        }

        .particle:nth-child(3n) {
            background: var(--neon-purple);
            box-shadow: 0 0 10px var(--neon-purple);
        }

        .particle:nth-child(4n) {
            background: var(--neon-green);
            box-shadow: 0 0 10px var(--neon-green);
        }

        @keyframes float {
            0% {
                transform: translateY(100vh) translateX(0);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) translateX(100px);
                opacity: 0;
            }
        }

        /* ИСПРАВЛЕННАЯ ШАПКА - ЛОГОТИП СЛЕВА, КНОПКИ СПРАВА */
        header {
            background: rgba(10, 10, 18, 0.95);
            backdrop-filter: blur(15px);
            border-bottom: 1px solid rgba(0, 243, 255, 0.3);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
        }

        .light-theme header {
            background: rgba(255, 255, 255, 0.95);
            border-bottom: 1px solid rgba(0, 140, 255, 0.3);
        }

        .header-container {
            max-width: 1900px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 1rem;
        }

        /* ЛОГОТИП ВЛЕВО */
        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
            cursor: pointer;
            margin-right: auto;
        }

        .logo-icon {
            width: 65px;
            height: 65px;
            border-radius: 50%;
            background: conic-gradient(from 0deg, var(--neon-cyan), var(--neon-pink), var(--neon-purple), var(--neon-cyan));
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            animation: rotate 8s linear infinite;
            box-shadow: var(--glow-cyan);
        }

        .logo-icon::before {
            content: '';
            position: absolute;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--dark-bg);
        }

        .logo-icon::after {
            content: '';
            position: absolute;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--neon-cyan);
            box-shadow: 0 0 10px var(--neon-cyan);
        }

        .logo-text {
            font-size: 2.2rem;
            font-weight: 900;
            background: linear-gradient(90deg, var(--neon-cyan), var(--neon-pink), var(--neon-purple));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: 0 0 10px rgba(0, 243, 255, 0.5);
        }

        /* НАВИГАЦИЯ ПО ЦЕНТРУ */
        nav {
            display: flex;
            justify-content: center;
            flex: 1;
        }

        nav ul {
            display: flex;
            list-style: none;
            gap: 2rem;
            align-items: center;
        }

        nav a {
            color: var(--text-primary);
            text-decoration: none;
            font-weight: 700;
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            padding: 0.6rem 1.2rem;
            position: relative;
            transition: all 0.3s;
            border: 1px solid rgba(0, 243, 255, 0.3);
            border-radius: 5px;
            background: rgba(0, 243, 255, 0.05);
            white-space: nowrap;
        }

        .light-theme nav a {
            border: 1px solid rgba(0, 140, 255, 0.3);
            background: rgba(0, 140, 255, 0.05);
        }

        nav a::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background: linear-gradient(90deg, var(--neon-cyan), var(--neon-pink));
            transition: width 0.3s;
        }

        nav a:hover {
            color: var(--neon-cyan);
            text-shadow: 0 0 10px var(--neon-cyan);
            background: rgba(0, 243, 255, 0.1);
            border-color: var(--neon-cyan);
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.5);
            transform: translateY(-2px);
        }

        .light-theme nav a:hover {
            background: rgba(0, 140, 255, 0.1);
            box-shadow: 0 0 15px rgba(0, 140, 255, 0.5);
        }

        nav a:hover::before {
            width: 100%;
        }

        /* КНОПКИ АВТОРИЗАЦИИ СПРАВА */
        .auth-buttons {
            display: flex;
            gap: 1.5rem;
            align-items: center;
            margin-left: auto;
        }

        /* Кнопки авторизации */
        .auth-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.6rem 1.2rem;
            font-family: 'Orbitron', monospace;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            transition: all 0.4s;
            text-decoration: none;
            border: 2px solid var(--neon-cyan);
            background: transparent;
            color: var(--neon-cyan);
            box-shadow: 0 0 10px rgba(0, 243, 255, 0.3);
            text-align: center;
            font-size: 0.9rem;
            min-height: 42px;
        }

        .auth-btn-secondary {
            color: var(--neon-pink);
            border: 2px solid var(--neon-pink);
            box-shadow: 0 0 10px rgba(255, 0, 200, 0.3);
        }

        .light-theme .auth-btn-secondary {
            box-shadow: 0 0 10px rgba(212, 0, 166, 0.3);
        }

        .auth-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 243, 255, 0.3), transparent);
            transition: left 0.7s;
        }

        .auth-btn:hover {
            background: rgba(0, 243, 255, 0.15);
            box-shadow: 0 0 20px rgba(0, 243, 255, 0.7);
            transform: translateY(-3px);
        }

        .auth-btn:hover::before {
            left: 100%;
        }

        .auth-btn-secondary:hover {
            background: rgba(255, 0, 200, 0.15);
            box-shadow: 0 0 20px rgba(255, 0, 200, 0.7);
        }

        .light-theme .auth-btn-secondary:hover {
            background: rgba(212, 0, 166, 0.15);
            box-shadow: 0 0 20px rgba(212, 0, 166, 0.7);
        }

        /* ИСПРАВЛЕННОЕ МЕНЮ ПОЛЬЗОВАТЕЛЯ - ОБЪЕДИНЕННЫЙ БАЛАНС И АВАТАР */
        .user-menu {
            display: flex;
            align-items: center;
            gap: 2rem;
            margin-left: auto;
        }

        .user-avatar-with-balance {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            padding: 0.5rem 1rem;
            background: rgba(0, 243, 255, 0.05);
            border: 1px solid rgba(0, 243, 255, 0.3);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .light-theme .user-avatar-with-balance {
            background: rgba(0, 140, 255, 0.05);
            border: 1px solid rgba(0, 140, 255, 0.3);
        }

        .user-avatar-with-balance:hover {
            background: rgba(0, 243, 255, 0.1);
            border-color: var(--neon-cyan);
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.3);
        }

        .light-theme .user-avatar-with-balance:hover {
            background: rgba(0, 140, 255, 0.1);
            box-shadow: 0 0 15px rgba(0, 140, 255, 0.3);
        }

        .user-avatar {
            width: 38px;
            height: 38px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--neon-cyan), var(--neon-purple));
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: var(--dark-bg);
            cursor: pointer;
            border: 2px solid var(--neon-cyan);
            box-shadow: 0 0 10px var(--neon-cyan);
            font-size: 0.9rem;
        }

        .user-balance {
            color: var(--neon-yellow);
            font-weight: 700;
            text-shadow: 0 0 10px var(--neon-yellow);
            white-space: nowrap;
            font-size: 0.9rem;
        }

        .light-theme .user-balance {
            color: var(--neon-yellow);
        }

        /* Кнопки в меню пользователя стилизованы как навигационные */
        .user-menu .nav-link {
            color: var(--text-primary);
            text-decoration: none;
            font-weight: 700;
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            padding: 0.6rem 1.2rem;
            position: relative;
            transition: all 0.3s;
            border: 1px solid rgba(0, 243, 255, 0.3);
            border-radius: 5px;
            background: rgba(0, 243, 255, 0.05);
            white-space: nowrap;
            cursor: pointer;
        }

        .light-theme .user-menu .nav-link {
            border: 1px solid rgba(0, 140, 255, 0.3);
            background: rgba(0, 140, 255, 0.05);
        }

        .user-menu .nav-link::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background: linear-gradient(90deg, var(--neon-cyan), var(--neon-pink));
            transition: width 0.3s;
        }

        .user-menu .nav-link:hover {
            color: var(--neon-cyan);
            text-shadow: 0 0 10px var(--neon-cyan);
            background: rgba(0, 243, 255, 0.1);
            border-color: var(--neon-cyan);
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.5);
            transform: translateY(-2px);
        }

        .light-theme .user-menu .nav-link:hover {
            background: rgba(0, 140, 255, 0.1);
            box-shadow: 0 0 15px rgba(0, 140, 255, 0.5);
        }

        .user-menu .nav-link:hover::before {
            width: 100%;
        }

        /* Основной контент */
        main {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        section {
            margin-bottom: 6rem;
            position: relative;
        }

        h2 {
            font-size: 2.5rem;
            font-weight: 900;
            margin-bottom: 3rem;
            text-transform: uppercase;
            letter-spacing: 4px;
            position: relative;
            display: inline-block;
            text-shadow: 0 0 10px rgba(0, 243, 255, 0.5);
        }

        .light-theme h2 {
            text-shadow: 0 0 10px rgba(0, 140, 255, 0.5);
        }

        h2::after {
            content: '';
            position: absolute;
            bottom: -15px;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, var(--neon-cyan), var(--neon-pink), transparent);
            box-shadow: 0 0 10px var(--neon-cyan);
        }

        p {
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
            line-height: 1.7;
            font-size: 1.1rem;
        }

        /* Баннеры на страницах */
        .page-banner {
            background: linear-gradient(135deg, rgba(0, 243, 255, 0.1) 0%, rgba(255, 0, 200, 0.1) 100%);
            border: 1px solid rgba(0, 243, 255, 0.3);
            border-radius: 15px;
            padding: 4rem 3rem;
            margin: 2rem 0 4rem;
            text-align: center;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 30px rgba(0, 243, 255, 0.3);
        }

        .light-theme .page-banner {
            background: linear-gradient(135deg, rgba(0, 140, 255, 0.1) 0%, rgba(212, 0, 166, 0.1) 100%);
            border: 1px solid rgba(0, 140, 255, 0.3);
            box-shadow: 0 0 30px rgba(0, 140, 255, 0.3);
        }

        .page-banner::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(0,243,255,0.1)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
            opacity: 0.3;
            z-index: -1;
        }

        .light-theme .page-banner::before {
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(0,140,255,0.1)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
        }

        .page-banner h1 {
            font-size: 3.5rem;
            font-weight: 900;
            margin-bottom: 1.5rem;
            background: linear-gradient(90deg, var(--neon-cyan), var(--neon-pink), var(--neon-purple));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-transform: uppercase;
            letter-spacing: 4px;
            text-shadow: 0 0 20px rgba(0, 243, 255, 0.5);
        }

        .light-theme .page-banner h1 {
            text-shadow: 0 0 20px rgba(0, 140, 255, 0.5);
        }

        .page-banner p {
            font-size: 1.3rem;
            color: var(--text-primary);
            max-width: 600px;
            margin: 0 auto;
            text-shadow: 0 0 10px rgba(0, 243, 255, 0.3);
        }

        .light-theme .page-banner p {
            text-shadow: 0 0 10px rgba(0, 140, 255, 0.3);
        }

        /* Секция приветствия - РАМКА ТОЛЬКО ВОКРУГ ТЕКСТА */
        .welcome-section {
            text-align: center;
            padding: 6rem 0 8rem;
            position: relative;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .welcome-banner {
            /* РАМКА ТОЛЬКО ВОКРУГ ЭТОГО БЛОКА */
            border: 3px solid transparent;
            border-radius: 20px;
            background: linear-gradient(135deg, rgba(0, 243, 255, 0.05) 0%, rgba(255, 0, 200, 0.05) 100%);
            box-shadow: 
                0 0 25px rgba(0, 243, 255, 0.3),
                0 0 50px rgba(255, 0, 200, 0.2),
                inset 0 0 25px rgba(0, 243, 255, 0.1);
            padding: 4rem 3rem;
            margin: 2rem 0;
            position: relative;
            overflow: hidden;
            animation: borderGlow 4s ease-in-out infinite alternate;
        }

        /* Анимация свечения рамки */
        @keyframes borderGlow {
            0% {
                border-color: rgba(0, 243, 255, 0.5);
                box-shadow: 
                    0 0 25px rgba(0, 243, 255, 0.3),
                    0 0 50px rgba(255, 0, 200, 0.2),
                    inset 0 0 25px rgba(0, 243, 255, 0.1);
            }
            100% {
                border-color: rgba(255, 0, 200, 0.5);
                box-shadow: 
                    0 0 35px rgba(0, 243, 255, 0.5),
                    0 0 60px rgba(255, 0, 200, 0.3),
                    inset 0 0 35px rgba(157, 0, 255, 0.2);
            }
        }

        .light-theme .welcome-banner {
            background: linear-gradient(135deg, rgba(0, 140, 255, 0.05) 0%, rgba(212, 0, 166, 0.05) 100%);
            animation: borderGlowLight 4s ease-in-out infinite alternate;
        }

        @keyframes borderGlowLight {
            0% {
                border-color: rgba(0, 140, 255, 0.5);
                box-shadow: 
                    0 0 25px rgba(0, 140, 255, 0.3),
                    0 0 50px rgba(212, 0, 166, 0.2),
                    inset 0 0 25px rgba(0, 140, 255, 0.1);
            }
            100% {
                border-color: rgba(212, 0, 166, 0.5);
                box-shadow: 
                    0 0 35px rgba(0, 140, 255, 0.5),
                    0 0 60px rgba(212, 0, 166, 0.3),
                    inset 0 0 35px rgba(122, 0, 204, 0.2);
            }
        }

        .welcome-banner::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80%;
            height: 80%;
            background: radial-gradient(circle, rgba(0, 243, 255, 0.1) 0%, transparent 70%);
            z-index: -1;
        }

        .light-theme .welcome-banner::before {
            background: radial-gradient(circle, rgba(0, 140, 255, 0.1) 0%, transparent 70%);
        }

        .welcome-banner h1 {
            font-size: 4.5rem;
            font-weight: 900;
            margin-bottom: 2rem;
            text-transform: uppercase;
            letter-spacing: 6px;
            background: linear-gradient(90deg, var(--neon-cyan), var(--neon-pink), var(--neon-purple), var(--neon-cyan));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            background-size: 300% 100%;
            animation: gradientShift 5s ease infinite;
            text-shadow: 0 0 20px rgba(0, 243, 255, 0.5);
        }

        .light-theme .welcome-banner h1 {
            text-shadow: 0 0 20px rgba(0, 140, 255, 0.5);
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .welcome-banner p {
            max-width: 800px;
            margin: 0 auto 3rem;
            font-size: 1.3rem;
            color: var(--text-primary);
            text-shadow: 0 0 10px rgba(0, 243, 255, 0.3);
        }

        .light-theme .welcome-banner p {
            text-shadow: 0 0 10px rgba(0, 140, 255, 0.3);
        }

        /* Новые интерактивные элементы на главной */
        .interactive-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 2rem;
            margin: 4rem auto;
            max-width: 1000px;
        }

        .grid-item {
            background: var(--panel-bg);
            border: 1px solid rgba(0, 243, 255, 0.2);
            padding: 2.5rem 2rem;
            border-radius: 10px;
            text-align: center;
            transition: all 0.4s;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .light-theme .grid-item {
            border: 1px solid rgba(0, 140, 255, 0.2);
        }

        .grid-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 243, 255, 0.1), transparent);
            transition: left 0.7s;
        }

        .light-theme .grid-item::before {
            background: linear-gradient(90deg, transparent, rgba(0, 140, 255, 0.1), transparent);
        }

        .grid-item:hover::before {
            left: 100%;
        }

        .grid-item:hover {
            transform: translateY(-10px);
            border-color: var(--neon-cyan);
            box-shadow: 0 10px 30px rgba(0, 243, 255, 0.3);
        }

        .light-theme .grid-item:hover {
            box-shadow: 0 10px 30px rgba(0, 140, 255, 0.3);
        }

        /* ИСПРАВЛЕНИЕ ИКОНОК */
        .grid-icon, .service-icon, .product-icon {
            font-size: 3rem;
            margin-bottom: 1.5rem;
            color: var(--neon-cyan);
            text-shadow: 0 0 15px var(--neon-cyan);
            display: block;
            line-height: 1;
        }

        .grid-item h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: var(--neon-cyan);
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .floating-elements {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
            z-index: -1;
        }

        .floating-element {
            position: absolute;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: conic-gradient(from 0deg, var(--neon-cyan), var(--neon-pink));
            opacity: 0.1;
            animation: floatRandom 15s infinite linear;
        }

        .floating-element:nth-child(2) {
            background: conic-gradient(from 90deg, var(--neon-purple), var(--neon-green));
            width: 40px;
            height: 40px;
            animation-delay: -5s;
            animation-duration: 12s;
        }

        .floating-element:nth-child(3) {
            background: conic-gradient(from 180deg, var(--neon-pink), var(--neon-yellow));
            width: 70px;
            height: 70px;
            animation-delay: -10s;
            animation-duration: 18s;
        }

        @keyframes floatRandom {
            0% {
                transform: translate(0, 0) rotate(0deg);
            }
            25% {
                transform: translate(100px, -50px) rotate(90deg);
            }
            50% {
                transform: translate(200px, 50px) rotate(180deg);
            }
            75% {
                transform: translate(100px, 150px) rotate(270deg);
            }
            100% {
                transform: translate(0, 0) rotate(360deg);
            }
        }

        .interactive-stats {
            display: flex;
            justify-content: center;
            gap: 3rem;
            margin: 3rem 0;
            flex-wrap: wrap;
        }

        .stat {
            text-align: center;
            padding: 1.5rem;
            background: rgba(0, 243, 255, 0.05);
            border-radius: 10px;
            border: 1px solid rgba(0, 243, 255, 0.2);
            min-width: 150px;
            transition: all 0.3s;
            cursor: pointer;
        }

        .light-theme .stat {
            background: rgba(0, 140, 255, 0.05);
            border: 1px solid rgba(0, 140, 255, 0.2);
        }

        .stat:hover {
            transform: scale(1.05);
            border-color: var(--neon-cyan);
            box-shadow: 0 0 20px rgba(0, 243, 255, 0.3);
        }

        .light-theme .stat:hover {
            box-shadow: 0 0 20px rgba(0, 140, 255, 0.3);
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 900;
            color: var(--neon-cyan);
            margin-bottom: 0.5rem;
            text-shadow: 0 0 10px rgba(0, 243, 255, 0.5);
        }

        .light-theme .stat-value {
            text-shadow: 0 0 10px rgba(0, 140, 255, 0.5);
        }

        .stat-label {
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 0.9rem;
        }

        /* ОБЩИЕ СТИЛИ ДЛЯ ВСЕХ КНОПОК */
        .btn, .register-btn, .buy-btn, .btn-secondary, .btn-success, .btn-danger {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-height: 54px;
            padding: 1rem 2.5rem;
            font-family: 'Orbitron', monospace;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 2px;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            transition: all 0.4s;
            text-decoration: none;
            border: 2px solid var(--neon-cyan);
            background: transparent;
            color: var(--neon-cyan);
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.3);
            text-align: center;
        }

        .light-theme .btn, 
        .light-theme .register-btn, 
        .light-theme .buy-btn {
            box-shadow: 0 0 15px rgba(0, 140, 255, 0.3);
        }

        .btn::before, .register-btn::before, .buy-btn::before, .btn-secondary::before, .btn-success::before, .btn-danger::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 243, 255, 0.3), transparent);
            transition: left 0.7s;
        }

        .light-theme .btn::before, 
        .light-theme .register-btn::before, 
        .light-theme .buy-btn::before {
            background: linear-gradient(90deg, transparent, rgba(0, 140, 255, 0.3), transparent);
        }

        .btn:hover, .register-btn:hover, .buy-btn:hover {
            background: rgba(0, 243, 255, 0.15);
            box-shadow: 0 0 25px rgba(0, 243, 255, 0.7);
            transform: translateY(-3px);
        }

        .light-theme .btn:hover, 
        .light-theme .register-btn:hover, 
        .light-theme .buy-btn:hover {
            background: rgba(0, 140, 255, 0.15);
            box-shadow: 0 0 25px rgba(0, 140, 255, 0.7);
        }

        .btn:hover::before, .register-btn:hover::before, .buy-btn:hover::before {
            left: 100%;
        }

        /* Специфические стили для разных типов кнопок */
        .btn-secondary {
            color: var(--neon-pink);
            border: 2px solid var(--neon-pink);
            box-shadow: 0 0 15px rgba(255, 0, 200, 0.3);
        }

        .light-theme .btn-secondary {
            box-shadow: 0 0 15px rgba(212, 0, 166, 0.3);
        }

        .btn-secondary:hover {
            background: rgba(255, 0, 200, 0.15);
            box-shadow: 0 0 25px rgba(255, 0, 200, 0.7);
        }

        .light-theme .btn-secondary:hover {
            background: rgba(212, 0, 166, 0.15);
            box-shadow: 0 0 25px rgba(212, 0, 166, 0.7);
        }

        .btn-success {
            color: var(--neon-green);
            border: 2px solid var(--neon-green);
            box-shadow: 0 0 15px rgba(0, 255, 136, 0.3);
        }

        .light-theme .btn-success {
            box-shadow: 0 0 15px rgba(0, 204, 106, 0.3);
        }

        .btn-success:hover {
            background: rgba(0, 255, 136, 0.15);
            box-shadow: 0 0 25px rgba(0, 255, 136, 0.7);
        }

        .light-theme .btn-success:hover {
            background: rgba(0, 204, 106, 0.15);
            box-shadow: 0 0 25px rgba(0, 204, 106, 0.7);
        }

        .btn-danger {
            color: var(--neon-red);
            border: 2px solid var(--neon-red);
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.3);
        }

        .light-theme .btn-danger {
            box-shadow: 0 0 15px rgba(204, 0, 0, 0.3);
        }

        .btn-danger:hover {
            background: rgba(255, 0, 0, 0.15);
            box-shadow: 0 0 25px rgba(255, 0, 0, 0.7);
        }

        .light-theme .btn-danger:hover {
            background: rgba(204, 0, 0, 0.15);
            box-shadow: 0 0 25px rgba(204, 0, 0, 0.7);
        }

        /* Галерея */
        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }

        .gallery-item {
            position: relative;
            height: 250px;
            overflow: hidden;
            border: 1px solid rgba(0, 243, 255, 0.3);
            transition: all 0.4s;
            background: var(--panel-bg);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .light-theme .gallery-item {
            border: 1px solid rgba(0, 140, 255, 0.3);
        }

        .gallery-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(0, 243, 255, 0.1), rgba(255, 0, 200, 0.1));
            opacity: 0;
            transition: opacity 0.4s;
            z-index: 1;
        }

        .light-theme .gallery-item::before {
            background: linear-gradient(135deg, rgba(0, 140, 255, 0.1), rgba(212, 0, 166, 0.1));
        }

        .gallery-item:hover {
            border-color: var(--neon-cyan);
            box-shadow: 0 0 25px rgba(0, 243, 255, 0.5);
            transform: translateY(-10px) scale(1.02);
        }

        .light-theme .gallery-item:hover {
            box-shadow: 0 0 25px rgba(0, 140, 255, 0.5);
        }

        .gallery-item:hover::before {
            opacity: 1;
        }

        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.7s;
        }

        .gallery-item:hover img {
            transform: scale(1.1);
        }

        .image-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 243, 255, 0.05);
            color: var(--neon-cyan);
            font-size: 1.5rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-weight: 700;
        }

        .light-theme .image-placeholder {
            background: rgba(0, 140, 255, 0.05);
        }

        /* Услуги */
        .services {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 2.5rem;
            margin-top: 3rem;
        }

        .service-card {
            background: var(--panel-bg);
            border: 1px solid rgba(0, 243, 255, 0.2);
            padding: 2.5rem 2rem;
            transition: all 0.4s;
            position: relative;
            overflow: hidden;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }

        .light-theme .service-card {
            border: 1px solid rgba(0, 140, 255, 0.2);
        }

        .service-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background: linear-gradient(to bottom, var(--neon-cyan), var(--neon-pink));
            transform: scaleY(0);
            transition: transform 0.4s;
        }

        .service-card:hover {
            border-color: var(--neon-cyan);
            box-shadow: 0 0 30px rgba(0, 243, 255, 0.3);
            transform: translateY(-10px);
        }

        .light-theme .service-card:hover {
            box-shadow: 0 0 30px rgba(0, 140, 255, 0.3);
        }

        .service-card:hover::before {
            transform: scaleY(1);
        }

        .service-icon {
            font-size: 3.5rem;
            margin-bottom: 1.5rem;
            color: var(--neon-cyan);
            text-shadow: 0 0 15px var(--neon-cyan);
            display: block;
            line-height: 1;
        }

        .service-card h3 {
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: var(--neon-cyan);
        }

        /* Турниры */
        .tournament-list {
            margin-top: 3rem;
        }

        .tournament-item {
            background: var(--panel-bg);
            border: 1px solid rgba(0, 243, 255, 0.2);
            padding: 2rem;
            margin-bottom: 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.4s;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }

        .light-theme .tournament-item {
            border: 1px solid rgba(0, 140, 255, 0.2);
        }

        .tournament-item:hover {
            border-color: var(--neon-cyan);
            box-shadow: 0 0 25px rgba(0, 243, 255, 0.3);
            transform: translateX(10px);
        }

        .light-theme .tournament-item:hover {
            box-shadow: 0 0 25px rgba(0, 140, 255, 0.3);
        }

        .tournament-info {
            flex: 1;
        }

        .tournament-game {
            font-weight: 700;
            color: var(--neon-cyan);
            text-transform: uppercase;
            letter-spacing: 2px;
            font-size: 1.3rem;
            margin-bottom: 0.5rem;
            text-shadow: 0 0 10px rgba(0, 243, 255, 0.5);
        }

        .light-theme .tournament-game {
            text-shadow: 0 0 10px rgba(0, 140, 255, 0.5);
        }

        .tournament-date {
            color: var(--text-secondary);
            font-size: 1rem;
            margin-bottom: 0.5rem;
        }

        .tournament-prize {
            color: var(--neon-pink);
            font-weight: 700;
            font-size: 1.2rem;
            text-shadow: 0 0 10px rgba(255, 0, 200, 0.5);
        }

        .light-theme .tournament-prize {
            text-shadow: 0 0 10px rgba(212, 0, 166, 0.5);
        }

        /* Отзывы */
        .reviews {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 2.5rem;
            margin-top: 3rem;
        }

        .review-card {
            background: var(--panel-bg);
            border: 1px solid rgba(0, 243, 255, 0.2);
            padding: 2.5rem;
            position: relative;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            transition: all 0.4s;
        }

        .light-theme .review-card {
            border: 1px solid rgba(0, 140, 255, 0.2);
        }

        .review-card:hover {
            border-color: var(--neon-cyan);
            box-shadow: 0 0 25px rgba(0, 243, 255, 0.3);
            transform: translateY(-10px);
        }

        .light-theme .review-card:hover {
            box-shadow: 0 0 25px rgba(0, 140, 255, 0.3);
        }

        .review-card::before {
            content: '"';
            position: absolute;
            top: 10px;
            left: 15px;
            font-size: 5rem;
            color: rgba(0, 243, 255, 0.3);
            font-family: Georgia, serif;
            line-height: 1;
        }

        .light-theme .review-card::before {
            color: rgba(0, 140, 255, 0.3);
        }

        .review-text {
            margin-bottom: 2rem;
            font-style: italic;
            position: relative;
            z-index: 1;
            font-size: 1.1rem;
        }

        .review-author {
            text-align: right;
            color: var(--neon-cyan);
            font-weight: 700;
            font-size: 1.1rem;
            text-shadow: 0 0 10px rgba(0, 243, 255, 0.5);
        }

        .light-theme .review-author {
            text-shadow: 0 0 10px rgba(0, 140, 255, 0.5);
        }

        .review-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
            justify-content: flex-end;
        }

        /* Форма бронирования */
        .booking-form {
            background: var(--panel-bg);
            border: 1px solid rgba(0, 243, 255, 0.2);
            padding: 3rem;
            max-width: 700px;
            margin: 0 auto;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }

        .light-theme .booking-form {
            border: 1px solid rgba(0, 140, 255, 0.2);
        }

        .form-group {
            margin-bottom: 2rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.8rem;
            color: var(--neon-cyan);
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 1rem;
            font-weight: 700;
        }

        .form-control {
            width: 100%;
            background: rgba(10, 10, 18, 0.8);
            border: 1px solid rgba(0, 243, 255, 0.3);
            padding: 1rem;
            color: var(--text-primary);
            font-family: 'Orbitron', monospace;
            transition: all 0.4s;
            font-size: 1rem;
        }

        .light-theme .form-control {
            background: rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(0, 140, 255, 0.3);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--neon-cyan);
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.5);
        }

        .light-theme .form-control:focus {
            box-shadow: 0 0 15px rgba(0, 140, 255, 0.5);
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        .checkbox-group input {
            margin: 0;
            width: 20px;
            height: 20px;
        }

        /* Контакты */
        .contact-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2.5rem;
            margin-top: 3rem;
        }

        .contact-item {
            text-align: center;
            padding: 2rem;
            background: var(--panel-bg);
            border: 1px solid rgba(0, 243, 255, 0.2);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            transition: all 0.4s;
        }

        .light-theme .contact-item {
            border: 1px solid rgba(0, 140, 255, 0.2);
        }

        .contact-item:hover {
            border-color: var(--neon-cyan);
            box-shadow: 0 0 25px rgba(0, 243, 255, 0.3);
            transform: translateY(-10px);
        }

        .light-theme .contact-item:hover {
            box-shadow: 0 0 25px rgba(0, 140, 255, 0.3);
        }

        .contact-item h3 {
            color: var(--neon-cyan);
            margin-bottom: 1.5rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-size: 1.3rem;
            text-shadow: 0 0 10px rgba(0, 243, 255, 0.5);
        }

        .light-theme .contact-item h3 {
            text-shadow: 0 0 10px rgba(0, 140, 255, 0.5);
        }

        .social-links {
            display: flex;
            gap: 1.5rem;
            margin-top: 3rem;
            justify-content: center;
        }

        .social-link {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: 2px solid rgba(0, 243, 255, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--neon-cyan);
            text-decoration: none;
            transition: all 0.4s;
            font-weight: 700;
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.3);
        }

        .light-theme .social-link {
            border: 2px solid rgba(0, 140, 255, 0.5);
            box-shadow: 0 0 15px rgba(0, 140, 255, 0.3);
        }

        .social-link:hover {
            background: rgba(0, 243, 255, 0.15);
            box-shadow: 0 0 25px rgba(0, 243, 255, 0.7);
            transform: translateY(-5px) scale(1.1);
        }

        .light-theme .social-link:hover {
            background: rgba(0, 140, 255, 0.15);
            box-shadow: 0 0 25px rgba(0, 140, 255, 0.7);
        }

        /* Футер */
        footer {
            background: rgba(5, 5, 8, 0.95);
            border-top: 1px solid rgba(0, 243, 255, 0.3);
            padding: 3rem 0;
            text-align: center;
            margin-top: 6rem;
            box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.5);
        }

        .light-theme footer {
            background: rgba(240, 242, 245, 0.95);
            border-top: 1px solid rgba(0, 140, 255, 0.3);
        }

        .footer-text {
            color: var(--text-secondary);
            font-size: 1rem;
        }

        /* Настройки */
        .settings-container {
            position: relative;
        }

        .settings-btn {
            background: transparent;
            border: none;
            color: var(--neon-cyan);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 50%;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 44px;
            height: 44px;
        }

        .settings-btn:hover {
            background: rgba(0, 243, 255, 0.1);
            transform: rotate(90deg);
        }

        .light-theme .settings-btn:hover {
            background: rgba(0, 140, 255, 0.1);
        }

        .settings-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: var(--panel-bg);
            border: 1px solid rgba(0, 243, 255, 0.3);
            border-radius: 10px;
            padding: 1.5rem;
            min-width: 280px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            backdrop-filter: blur(10px);
            transform: translateY(10px);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .light-theme .settings-dropdown {
            border: 1px solid rgba(0, 140, 255, 0.3);
        }

        .settings-dropdown.active {
            transform: translateY(0);
            opacity: 1;
            visibility: visible;
        }

        .settings-title {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            color: var(--neon-cyan);
            text-transform: uppercase;
            letter-spacing: 1px;
            text-align: center;
        }

        .setting-option {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(0, 243, 255, 0.1);
        }

        .light-theme .setting-option {
            border-bottom: 1px solid rgba(0, 140, 255, 0.1);
        }

        .setting-label {
            color: var(--text-primary);
            font-weight: 500;
        }

        /* Переключатели */
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 243, 255, 0.2);
            transition: .4s;
            border-radius: 34px;
        }

        .light-theme .slider {
            background-color: rgba(0, 140, 255, 0.2);
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: var(--neon-cyan);
            transition: .4s;
            border-radius: 50%;
            box-shadow: 0 0 10px var(--neon-cyan);
        }

        input:checked + .slider {
            background-color: rgba(0, 243, 255, 0.4);
        }

        .light-theme input:checked + .slider {
            background-color: rgba(0, 140, 255, 0.4);
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        /* Адаптивность */
        @media (max-width: 768px) {
            .header-container {
                flex-direction: column;
                gap: 1.5rem;
            }
            
            nav {
                order: 3;
                width: 100%;
            }
            
            nav ul {
                flex-wrap: wrap;
                justify-content: center;
                gap: 1rem;
            }
            
            .welcome-banner h1 {
                font-size: 2.8rem;
            }
            
            .welcome-banner p {
                font-size: 1.1rem;
            }
            
            .interactive-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
            
            .interactive-stats {
                gap: 1.5rem;
            }
            
            .gallery {
                grid-template-columns: 1fr;
            }
            
            .services {
                grid-template-columns: 1fr;
            }
            
            .tournament-item {
                flex-direction: column;
                gap: 1.5rem;
                text-align: center;
            }
            
            h2 {
                font-size: 2rem;
            }

            .auth-buttons {
                flex-direction: row;
                gap: 0.5rem;
            }
            
            .logo {
                margin: 0;
            }

            .page-banner {
                padding: 2rem 1.5rem;
            }

            .page-banner h1 {
                font-size: 2.5rem;
            }

            .page-banner p {
                font-size: 1.1rem;
            }
            
            .logo-text {
                font-size: 1.8rem;
            }
            
            .logo-icon {
                width: 50px;
                height: 50px;
            }
            
            .logo-icon::before {
                width: 40px;
                height: 40px;
            }
            
            /* Адаптивность для баннера с рамкой */
            .welcome-banner {
                margin: 1rem;
                padding: 3rem 1rem;
            }
            
            /* Оптимизация для мобильных устройств */
            .particles, .lightning-overlay {
                display: none;
            }

            .settings-dropdown {
                right: -50px;
                min-width: 250px;
            }
            
            /* Адаптивность для меню пользователя */
            .user-menu {
                gap: 1rem;
                flex-wrap: wrap;
                justify-content: center;
            }

            /* Адаптивность для объединенной кнопки баланса и аватара */
            .user-avatar-with-balance {
                padding: 0.4rem 0.8rem;
            }
            
            .user-balance {
                font-size: 0.8rem;
            }
            
            /* Исправление формы регистрации */
            .booking-form {
                padding: 2rem 1.5rem;
                margin: 1rem;
            }
            
            .form-row {
                flex-direction: column;
                gap: 0;
            }
        }
        
        /* Дополнительные адаптивные стили для очень маленьких экранов */
        @media (max-width: 480px) {
            main {
                padding: 1rem;
            }
            
            .page-banner {
                padding: 1.5rem 1rem;
                margin: 1rem 0 2rem;
            }
            
            .page-banner h1 {
                font-size: 2rem;
            }
            
            .page-banner p {
                font-size: 1rem;
            }
            
            .booking-form {
                padding: 1.5rem 1rem;
            }
            
            .booking-form h3 {
                font-size: 1.5rem;
            }
            
            .form-group {
                margin-bottom: 1.5rem;
            }
            
            .form-control {
                padding: 0.8rem;
            }
            
            .btn, .register-btn, .buy-btn {
                padding: 0.8rem 1.5rem;
                font-size: 0.9rem;
            }
            
            .user-menu .nav-link {
                padding: 0.5rem 1rem;
                font-size: 0.9rem;
            }
        }

        /* Оптимизация производительности анимаций */
        .particle, .lightning, .loader-ring, .loader-logo, .logo-icon, .floating-element, .scanline, .loading-progress::after, .grid-overlay {
            will-change: transform, opacity;
        }

        /* Анимации появления */
        .fade-in {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.8s ease, transform 0.8s ease;
        }

        .fade-in.visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* Задержки для анимаций */
        .delay-1 { transition-delay: 0.2s; }
        .delay-2 { transition-delay: 0.4s; }
        .delay-3 { transition-delay: 0.6s; }
        .delay-4 { transition-delay: 0.8s; }
        .delay-5 { transition-delay: 1s; }

        /* Модальные окна */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(5, 5, 8, 0.98);
            z-index: 1000;
            backdrop-filter: blur(10px);
            animation: modalFadeIn 0.5s ease-out;
        }

        .light-theme .modal {
            background: rgba(240, 242, 245, 0.98);
        }

        @keyframes modalFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: var(--panel-bg);
            border: 1px solid var(--neon-cyan);
            width: 90%;
            max-width: 600px;
            padding: 3rem;
            position: relative;
            box-shadow: 0 0 50px rgba(0, 243, 255, 0.5);
            animation: modalSlideIn 0.5s ease-out;
        }

        .light-theme .modal-content {
            box-shadow: 0 0 50px rgba(0, 140, 255, 0.5);
        }

        @keyframes modalSlideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2.5rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid rgba(0, 243, 255, 0.3);
        }

        .light-theme .modal-header {
            border-bottom: 1px solid rgba(0, 140, 255, 0.3);
        }

        .modal-title {
            font-size: 1.8rem;
            font-weight: 900;
            background: linear-gradient(90deg, var(--neon-cyan), var(--neon-pink));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-transform: uppercase;
            letter-spacing: 3px;
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--neon-cyan);
            font-size: 2rem;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.4s;
        }

        .modal-close:hover {
            transform: rotate(90deg);
            color: var(--neon-pink);
            text-shadow: 0 0 15px var(--neon-pink);
        }

        /* Улучшенные формы */
        .form-row {
            display: flex;
            gap: 1.5rem;
        }

        .form-row .form-group {
            flex: 1;
        }

        .form-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 2.5rem;
            gap: 1.5rem;
        }

        .form-actions .btn {
            flex: 1;
        }

        /* Уведомления */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1.5rem 2rem;
            background: var(--panel-bg);
            border-left: 5px solid var(--neon-cyan);
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.5);
            z-index: 1001;
            transform: translateX(150%);
            transition: transform 0.5s ease;
            max-width: 400px;
            backdrop-filter: blur(10px);
        }

        .light-theme .notification {
            border-left: 5px solid var(--neon-cyan);
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            border-left-color: var(--neon-green);
        }

        .notification.error {
            border-left-color: var(--neon-pink);
        }

        /* Личный кабинет */
        .profile-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .profile-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--neon-cyan), var(--neon-purple));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            font-weight: bold;
            color: var(--dark-bg);
            margin: 0 auto 1.5rem;
            border: 3px solid var(--neon-cyan);
            box-shadow: 0 0 20px var(--neon-cyan);
        }

        .profile-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 3rem;
        }

        .stat-card {
            background: var(--panel-bg);
            border: 1px solid rgba(0, 243, 255, 0.2);
            padding: 2rem;
            text-align: center;
            transition: all 0.4s;
        }

        .light-theme .stat-card {
            border: 1px solid rgba(0, 140, 255, 0.2);
        }

        .stat-card:hover {
            border-color: var(--neon-cyan);
            box-shadow: 0 0 20px rgba(0, 243, 255, 0.3);
            transform: translateY(-5px);
        }

        .light-theme .stat-card:hover {
            box-shadow: 0 0 20px rgba(0, 140, 255, 0.3);
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 900;
            color: var(--neon-cyan);
            margin-bottom: 0.5rem;
            text-shadow: 0 0 10px rgba(0, 243, 255, 0.5);
        }

        .light-theme .stat-value {
            text-shadow: 0 0 10px rgba(0, 140, 255, 0.5);
        }

        .stat-label {
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 0.9rem;
        }

        /* Админ панель */
        .admin-panel {
            background: var(--panel-bg);
            border: 1px solid rgba(0, 243, 255, 0.3);
            padding: 2rem;
            margin-top: 2rem;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }

        .light-theme .admin-panel {
            border: 1px solid rgba(0, 140, 255, 0.3);
        }

        .admin-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            border-bottom: 1px solid rgba(0, 243, 255, 0.3);
            padding-bottom: 1rem;
        }

        .light-theme .admin-tabs {
            border-bottom: 1px solid rgba(0, 140, 255, 0.3);
        }

        .admin-tab {
            padding: 1rem 2rem;
            background: transparent;
            border: 1px solid rgba(0, 243, 255, 0.3);
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 700;
        }

        .light-theme .admin-tab {
            border: 1px solid rgba(0, 140, 255, 0.3);
        }

        .admin-tab.active {
            background: rgba(0, 243, 255, 0.1);
            border-color: var(--neon-cyan);
            color: var(--neon-cyan);
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.3);
        }

        .light-theme .admin-tab.active {
            background: rgba(0, 140, 255, 0.1);
            box-shadow: 0 0 15px rgba(0, 140, 255, 0.3);
        }

        .admin-content {
            display: none;
        }

        .admin-content.active {
            display: block;
        }

        .user-list, .review-list {
            display: grid;
            gap: 1rem;
        }

        .user-item, .review-item {
            background: rgba(10, 10, 18, 0.5);
            border: 1px solid rgba(0, 243, 255, 0.2);
            padding: 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
        }

        .light-theme .user-item, 
        .light-theme .review-item {
            background: rgba(255, 255, 255, 0.5);
            border: 1px solid rgba(0, 140, 255, 0.2);
        }

        .user-item:hover, .review-item:hover {
            border-color: var(--neon-cyan);
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.2);
        }

        .light-theme .user-item:hover, 
        .light-theme .review-item:hover {
            box-shadow: 0 0 15px rgba(0, 140, 255, 0.2);
        }

        .user-info, .review-info {
            flex: 1;
        }

        .user-name, .review-author {
            font-weight: 700;
            color: var(--neon-cyan);
            margin-bottom: 0.5rem;
        }

        .user-email, .review-text {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .admin-actions {
            display: flex;
            gap: 0.5rem;
        }

        /* Переключение страниц */
        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        /* Анимация перехода между страницами */
        .page-transition {
            animation: pageFadeIn 0.8s ease-out;
        }

        @keyframes pageFadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Продукты и магазин */
        .products {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2.5rem;
            margin-top: 3rem;
        }

        .product-card {
            background: var(--panel-bg);
            border: 1px solid rgba(0, 243, 255, 0.2);
            padding: 2rem 1.5rem;
            text-align: center;
            transition: all 0.4s;
            position: relative;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .light-theme .product-card {
            border: 1px solid rgba(0, 140, 255, 0.2);
        }

        .product-card.featured {
            border-color: var(--neon-yellow);
            transform: scale(1.05);
        }

        .product-card.featured::before {
            content: 'ПОПУЛЯРНО';
            position: absolute;
            top: 20px;
            right: -30px;
            background: var(--neon-yellow);
            color: var(--dark-bg);
            padding: 5px 30px;
            transform: rotate(45deg);
            font-weight: 700;
            font-size: 0.8rem;
            letter-spacing: 1px;
        }

        .product-card:hover {
            border-color: var(--neon-cyan);
            box-shadow: 0 0 30px rgba(0, 243, 255, 0.4);
            transform: translateY(-10px);
        }

        .light-theme .product-card:hover {
            box-shadow: 0 0 30px rgba(0, 140, 255, 0.4);
        }

        .product-card.featured:hover {
            border-color: var(--neon-yellow);
            box-shadow: 0 0 30px rgba(255, 238, 0, 0.4);
        }

        .light-theme .product-card.featured:hover {
            box-shadow: 0 0 30px rgba(230, 216, 0, 0.4);
        }

        .product-icon {
            font-size: 3rem;
            margin-bottom: 1.2rem;
            color: var(--neon-cyan);
            text-shadow: 0 0 15px var(--neon-cyan);
            display: block;
            line-height: 1;
        }

        .product-card.featured .product-icon {
            color: var(--neon-yellow);
            text-shadow: 0 0 15px var(--neon-yellow);
        }

        .product-card h3 {
            font-size: 1.3rem;
            margin-bottom: 1rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: var(--neon-cyan);
        }

        .product-card.featured h3 {
            color: var(--neon-yellow);
        }

        .product-price {
            font-size: 1.8rem;
            font-weight: 900;
            margin: 1.2rem 0;
            color: var(--neon-pink);
            text-shadow: 0 0 10px rgba(255, 0, 200, 0.5);
        }

        .light-theme .product-price {
            text-shadow: 0 0 10px rgba(212, 0, 166, 0.5);
        }

        .product-card.featured .product-price {
            color: var(--neon-yellow);
            text-shadow: 0 0 10px rgba(255, 238, 0, 0.5);
        }

        .light-theme .product-card.featured .product-price {
            text-shadow: 0 0 10px rgba(230, 216, 0, 0.5);
        }

        .product-features {
            list-style: none;
            margin: 1.2rem 0;
            text-align: left;
            flex-grow: 1;
        }

        .product-features li {
            padding: 0.4rem 0;
            color: var(--text-secondary);
            position: relative;
            padding-left: 1.5rem;
            font-size: 0.95rem;
        }

        .product-features li::before {
            content: '✓';
            position: absolute;
            left: 0;
            color: var(--neon-green);
            font-weight: bold;
        }

        /* Подтверждение выхода */
        .confirm-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(5, 5, 8, 0.95);
            z-index: 1002;
            backdrop-filter: blur(10px);
        }

        .light-theme .confirm-modal {
            background: rgba(240, 242, 245, 0.95);
        }

        .confirm-modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .confirm-content {
            background: var(--panel-bg);
            border: 1px solid var(--neon-cyan);
            padding: 3rem;
            max-width: 500px;
            width: 90%;
            text-align: center;
            box-shadow: 0 0 50px rgba(0, 243, 255, 0.5);
        }

        .light-theme .confirm-content {
            box-shadow: 0 0 50px rgba(0, 140, 255, 0.5);
        }

        .confirm-title {
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            color: var(--neon-cyan);
        }

        .confirm-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 2rem;
        }

        .confirm-buttons .btn {
            min-width: 120px;
        }

        /* ИСПРАВЛЕННАЯ ШЕСТЕРЁНКА */
        .advanced-gear {
            width: 24px;
            height: 24px;
            position: relative;
            transition: all 0.4s ease;
        }

        .advanced-gear::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: conic-gradient(from 0deg, var(--neon-cyan), var(--neon-pink), var(--neon-purple), var(--neon-cyan));
            mask: radial-gradient(circle at center, transparent 30%, black 31%);
            -webkit-mask: radial-gradient(circle at center, transparent 30%, black 31%);
            animation: rotate 3s linear infinite paused;
            box-shadow: 0 0 5px var(--neon-cyan);
            transition: all 0.4s ease;
        }

        .settings-btn:hover .advanced-gear::before {
            animation-play-state: running;
            box-shadow: 0 0 8px var(--neon-pink);
        }

        .advanced-gear::after {
            content: '';
            position: absolute;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: var(--neon-cyan);
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            box-shadow: 0 0 5px var(--neon-cyan);
            transition: all 0.4s ease;
        }

        .settings-btn:hover .advanced-gear::after {
            background: var(--neon-pink);
            box-shadow: 0 0 8px var(--neon-pink);
        }

        /* Стили для баланса */
        .balance-container {
            text-align: center;
            padding: 3rem 0;
        }

        .balance-amount {
            font-size: 4rem;
            font-weight: 900;
            color: var(--neon-yellow);
            text-shadow: 0 0 20px var(--neon-yellow);
            margin: 2rem 0;
        }

        .payment-methods {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }

        .payment-method {
            background: var(--panel-bg);
            border: 1px solid rgba(0, 243, 255, 0.2);
            padding: 2rem;
            border-radius: 10px;
            text-align: center;
            transition: all 0.4s;
            cursor: pointer;
        }

        .light-theme .payment-method {
            border: 1px solid rgba(0, 140, 255, 0.2);
        }

        .payment-method:hover {
            border-color: var(--neon-yellow);
            box-shadow: 0 0 20px rgba(255, 238, 0, 0.3);
            transform: translateY(-5px);
        }

        .light-theme .payment-method:hover {
            box-shadow: 0 0 20px rgba(230, 216, 0, 0.3);
        }

        .payment-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: var(--neon-yellow);
            text-shadow: 0 0 10px var(--neon-yellow);
        }

        .payment-title {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: var(--neon-yellow);
        }

        .payment-description {
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
        }

        .payment-form {
            display: none;
            margin-top: 2rem;
            padding: 2rem;
            background: var(--panel-bg);
            border: 1px solid rgba(0, 243, 255, 0.2);
            border-radius: 10px;
        }

        .payment-form.active {
            display: block;
        }

        .payment-amount {
            font-size: 2rem;
            font-weight: 700;
            color: var(--neon-yellow);
            margin: 1rem 0;
        }

        /* Стили для форматирования денег */
        .money {
            font-family: 'Orbitron', monospace;
            letter-spacing: 1px;
        }

        /* Стили для полей с масками */
        .masked-input {
            font-family: 'Orbitron', monospace;
            letter-spacing: 1px;
        }

        /* Стили для ограничения баланса */
        .balance-limit-info {
            margin-top: 1rem;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .balance-limit-warning {
            color: var(--neon-yellow);
            font-weight: 700;
            text-shadow: 0 0 10px rgba(255, 238, 0, 0.5);
        }

        /* ИСПРАВЛЕННОЕ МОДАЛЬНОЕ ОКНО ПОКУПКИ - КОМПАКТНОЕ */
        .purchase-modal .modal-content {
            max-width: 500px;
            max-height: 85vh;
            overflow-y: auto;
            padding: 1.5rem;
        }

        .purchase-modal .modal-header {
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
        }

        .purchase-modal .form-group {
            margin-bottom: 1.2rem;
        }

        .purchase-modal .form-control {
            padding: 0.8rem;
            font-size: 0.9rem;
        }

        .purchase-modal .btn {
            padding: 0.8rem 1.5rem;
            font-size: 0.9rem;
            min-height: 44px;
        }

        .purchase-details {
            background: rgba(0, 243, 255, 0.05);
            border: 1px solid rgba(0, 243, 255, 0.2);
            border-radius: 8px;
            padding: 1.2rem;
            margin-bottom: 1.5rem;
        }

        .light-theme .purchase-details {
            background: rgba(0, 140, 255, 0.05);
            border: 1px solid rgba(0, 140, 255, 0.2);
        }

        .purchase-summary {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.8rem;
            font-size: 0.95rem;
        }

        .purchase-item {
            font-weight: 700;
            color: var(--neon-cyan);
        }

        .purchase-price {
            font-weight: 700;
            color: var(--neon-pink);
        }

        .purchase-total {
            display: flex;
            justify-content: space-between;
            border-top: 1px solid rgba(0, 243, 255, 0.3);
            padding-top: 0.8rem;
            margin-top: 0.8rem;
            font-size: 1.1rem;
        }

        .light-theme .purchase-total {
            border-top: 1px solid rgba(0, 140, 255, 0.3);
        }

        .total-label {
            font-weight: 700;
            color: var(--neon-cyan);
        }

        .total-amount {
            font-weight: 900;
            color: var(--neon-yellow);
            text-shadow: 0 0 10px var(--neon-yellow);
        }

        .zone-selection {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 0.8rem;
            margin-bottom: 1.5rem;
        }

        .zone-option {
            background: rgba(0, 243, 255, 0.05);
            border: 1px solid rgba(0, 243, 255, 0.2);
            border-radius: 8px;
            padding: 1rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .light-theme .zone-option {
            background: rgba(0, 140, 255, 0.05);
            border: 1px solid rgba(0, 140, 255, 0.2);
        }

        .zone-option:hover {
            border-color: var(--neon-cyan);
            box-shadow: 0 0 12px rgba(0, 243, 255, 0.3);
        }

        .light-theme .zone-option:hover {
            box-shadow: 0 0 12px rgba(0, 140, 255, 0.3);
        }

        .zone-option.selected {
            border-color: var(--neon-yellow);
            background: rgba(255, 238, 0, 0.1);
            box-shadow: 0 0 15px rgba(255, 238, 0, 0.3);
        }

        .light-theme .zone-option.selected {
            background: rgba(230, 216, 0, 0.1);
            box-shadow: 0 0 15px rgba(230, 216, 0, 0.3);
        }

        .zone-icon {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .zone-name {
            font-weight: 700;
            margin-bottom: 0.3rem;
            font-size: 0.9rem;
        }

        .zone-description {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .purchase-confirmation {
            background: rgba(0, 255, 136, 0.05);
            border: 1px solid var(--neon-green);
            border-radius: 8px;
            padding: 1.2rem;
            margin-top: 1.5rem;
            display: none;
        }

        .light-theme .purchase-confirmation {
            background: rgba(0, 204, 106, 0.05);
        }

        .purchase-confirmation.active {
            display: block;
        }

        .confirmation-title {
            color: var(--neon-green);
            font-weight: 700;
            margin-bottom: 0.8rem;
            text-align: center;
            font-size: 1.1rem;
        }

        .confirmation-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 0.8rem;
            margin-bottom: 1.2rem;
        }

        .confirmation-item {
            display: flex;
            justify-content: space-between;
            padding-bottom: 0.4rem;
            border-bottom: 1px solid rgba(0, 255, 136, 0.2);
            font-size: 0.9rem;
        }

        .light-theme .confirmation-item {
            border-bottom: 1px solid rgba(0, 204, 106, 0.2);
        }

        .confirmation-label {
            font-weight: 700;
            color: var(--neon-green);
        }

        .confirmation-value {
            color: var(--text-primary);
        }

        /* Дополнительные исправления для мобильных устройств */
        @media (max-width: 768px) {
            .purchase-modal .modal-content {
                padding: 1rem;
                max-height: 90vh;
            }
            
            .purchase-modal .zone-selection {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .purchase-modal .form-actions {
                flex-direction: column;
                gap: 1rem;
            }
        }

        @media (max-width: 480px) {
            .purchase-modal .zone-selection {
                grid-template-columns: 1fr;
            }
            
            .purchase-modal .modal-content {
                padding: 0.8rem;
            }
        }

        /* НОВЫЕ СТИЛИ ДЛЯ МОБИЛЬНОЙ ВЕРСИИ */

        /* Бургер-меню */
        .burger-menu {
            display: none;
            flex-direction: column;
            justify-content: space-between;
            width: 30px;
            height: 21px;
            background: transparent;
            border: none;
            cursor: pointer;
            padding: 0;
            position: relative;
            z-index: 101;
        }

        .burger-menu span {
            display: block;
            height: 3px;
            width: 100%;
            background-color: var(--neon-cyan);
            border-radius: 3px;
            transition: all 0.3s ease;
        }

        .burger-menu.active span:nth-child(1) {
            transform: translateY(9px) rotate(45deg);
        }

        .burger-menu.active span:nth-child(2) {
            opacity: 0;
        }

        .burger-menu.active span:nth-child(3) {
            transform: translateY(-9px) rotate(-45deg);
        }

        /* Мобильная навигация */
        .mobile-nav {
            position: fixed;
            top: 0;
            right: -100%;
            width: 80%;
            max-width: 300px;
            height: 100vh;
            background: var(--panel-bg);
            backdrop-filter: blur(15px);
            z-index: 100;
            transition: right 0.3s ease;
            padding: 80px 20px 20px;
            overflow-y: auto;
            box-shadow: -5px 0 20px rgba(0, 0, 0, 0.5);
            border-left: 1px solid rgba(0, 243, 255, 0.3);
        }

        .mobile-nav.active {
            right: 0;
        }

        .mobile-nav ul {
            list-style: none;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .mobile-nav a {
            display: block;
            color: var(--text-primary);
            text-decoration: none;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            padding: 1rem 1.5rem;
            border: 1px solid rgba(0, 243, 255, 0.3);
            border-radius: 5px;
            background: rgba(0, 243, 255, 0.05);
            transition: all 0.3s;
        }

        .light-theme .mobile-nav a {
            border: 1px solid rgba(0, 140, 255, 0.3);
            background: rgba(0, 140, 255, 0.05);
        }

        .mobile-nav a:hover {
            color: var(--neon-cyan);
            background: rgba(0, 243, 255, 0.1);
            border-color: var(--neon-cyan);
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.5);
        }

        .light-theme .mobile-nav a:hover {
            background: rgba(0, 140, 255, 0.1);
            box-shadow: 0 0 15px rgba(0, 140, 255, 0.5);
        }

        .mobile-nav .user-section {
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid rgba(0, 243, 255, 0.3);
        }

        .light-theme .mobile-nav .user-section {
            border-top: 1px solid rgba(0, 140, 255, 0.3);
        }

        .mobile-nav .user-avatar-with-balance {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: rgba(0, 243, 255, 0.05);
            border: 1px solid rgba(0, 243, 255, 0.3);
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .light-theme .mobile-nav .user-avatar-with-balance {
            background: rgba(0, 140, 255, 0.05);
            border: 1px solid rgba(0, 140, 255, 0.3);
        }

        .mobile-nav .auth-buttons {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-top: 1rem;
        }

        /* Оверлей для мобильного меню */
        .mobile-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(5, 5, 8, 0.8);
            z-index: 99;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .mobile-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .light-theme .mobile-overlay {
            background: rgba(240, 242, 245, 0.8);
        }

        /* Адаптация для мобильных устройств */
        @media (max-width: 768px) {
            .burger-menu {
                display: flex;
            }

            nav {
                display: none;
            }

            .auth-buttons {
                display: none;
            }

            .user-menu {
                display: none;
            }

            .header-container {
                flex-direction: row;
                justify-content: space-between;
            }

            .logo {
                margin-right: 0;
            }

            .welcome-banner h1 {
                font-size: 2.5rem;
                letter-spacing: 3px;
            }

            .welcome-banner p {
                font-size: 1rem;
            }

            .page-banner h1 {
                font-size: 2.2rem;
            }

            .page-banner p {
                font-size: 1rem;
            }

            .interactive-stats {
                gap: 1rem;
            }

            .stat {
                min-width: 120px;
                padding: 1rem;
            }

            .stat-value {
                font-size: 1.8rem;
            }

            .stat-label {
                font-size: 0.8rem;
            }

            .grid-item {
                padding: 1.5rem 1rem;
            }

            .grid-icon, .service-icon, .product-icon {
                font-size: 2.5rem;
            }

            .grid-item h3, .service-card h3, .product-card h3 {
                font-size: 1.3rem;
            }

            .gallery {
                grid-template-columns: 1fr;
            }

            .services {
                grid-template-columns: 1fr;
            }

            .products {
                grid-template-columns: 1fr;
            }

            .product-card.featured {
                transform: none;
            }

            .tournament-item {
                flex-direction: column;
                text-align: center;
                gap: 1rem;
            }

            .booking-form {
                padding: 1.5rem;
            }

            .contact-info {
                grid-template-columns: 1fr;
            }

            .payment-methods {
                grid-template-columns: 1fr;
            }

            .profile-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .admin-tabs {
                flex-direction: column;
            }

            .admin-tab {
                width: 100%;
                text-align: center;
            }

            .form-row {
                flex-direction: column;
            }

            .form-actions {
                flex-direction: column;
            }

            .modal-content {
                padding: 1.5rem;
            }

            .modal-title {
                font-size: 1.5rem;
            }

            .purchase-modal .zone-selection {
                grid-template-columns: 1fr;
            }

            .social-links {
                flex-wrap: wrap;
            }

            .footer-text {
                font-size: 0.9rem;
            }
        }

        @media (max-width: 480px) {
            .welcome-banner h1 {
                font-size: 2rem;
            }

            .page-banner h1 {
                font-size: 1.8rem;
            }

            h2 {
                font-size: 1.5rem;
            }

            .balance-amount {
                font-size: 3rem;
            }

            .stat-value {
                font-size: 1.5rem;
            }

            .profile-avatar {
                width: 100px;
                height: 100px;
                font-size: 2.5rem;
            }

            .loader-text {
                font-size: 2.2rem;
            }

            .loader-subtitle {
                font-size: 1rem;
            }

            .loading-bar {
                width: 300px;
            }
        }

        /* Оптимизация для планшетов */
        @media (min-width: 769px) and (max-width: 1024px) {
            .interactive-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .services {
                grid-template-columns: repeat(2, 1fr);
            }

            .gallery {
                grid-template-columns: repeat(2, 1fr);
            }

            .products {
                grid-template-columns: repeat(2, 1fr);
            }

            .profile-stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Стили для ВКонтакте интеграции */
        .vk-preview-post {
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            border-left: 4px solid var(--neon-cyan);
        }
        
        .vk-preview-text {
            color: var(--text-primary);
            margin-bottom: 1rem;
            line-height: 1.5;
        }
        
        .vk-preview-image {
            max-width: 100%;
            border-radius: 8px;
            margin-bottom: 1rem;
        }
        
        .vk-preview-link {
            display: block;
            padding: 0.8rem;
            background: rgba(0,243,255,0.1);
            border-radius: 6px;
            color: var(--neon-cyan);
            text-decoration: none;
            border: 1px solid rgba(0,243,255,0.3);
        }
        
        .vk-post-item {
            background: rgba(10,10,18,0.5);
            border: 1px solid rgba(0,243,255,0.2);
            padding: 1.5rem;
            margin-bottom: 1rem;
            border-radius: 8px;
            transition: all 0.3s;
        }
        
        .vk-post-item:hover {
            border-color: var(--neon-cyan);
            box-shadow: 0 0 15px rgba(0,243,255,0.2);
        }
        
        .vk-post-date {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }
        
        .vk-post-stats {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
            font-size: 0.9rem;
        }
        
        .vk-stat {
            display: flex;
            align-items: center;
            gap: 0.3rem;
            color: var(--text-secondary);
        }
        
        .light-theme .vk-post-item {
            background: rgba(255,255,255,0.5);
        }

        /* Стили для VK модального окна */
        .vk-modal .modal-content {
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .vk-preview {
            margin-top: 2rem;
            padding: 1.5rem;
            background: var(--panel-bg);
            border: 1px solid rgba(0,243,255,0.3);
            border-radius: 10px;
        }

        /* НОВЫЕ СТИЛИ ДЛЯ УЛУЧШЕННОЙ КНОПКИ VK */
        .admin-vk-section {
            text-align: center;
            margin: 2rem 0;
            padding: 2rem;
            background: var(--panel-bg);
            border: 1px solid rgba(0, 243, 255, 0.3);
            border-radius: 15px;
            backdrop-filter: blur(10px);
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }

        .light-theme .admin-vk-section {
            border: 1px solid rgba(0, 140, 255, 0.3);
        }

        .admin-vk-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 243, 255, 0.1), transparent);
            transition: left 0.7s;
        }

        .admin-vk-section:hover::before {
            left: 100%;
        }

        .admin-vk-section p {
            color: var(--text-primary);
            margin-bottom: 1.5rem;
            font-size: 1.2rem;
            text-shadow: 0 0 10px rgba(0, 243, 255, 0.3);
        }

        .light-theme .admin-vk-section p {
            text-shadow: 0 0 10px rgba(0, 140, 255, 0.3);
        }

        .admin-vk-button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 1.2rem 2.5rem;
            background: linear-gradient(135deg, #0077FF 0%, #0077FF 50%, #0077FF 100%);
            color: white;
            text-decoration: none;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 2px;
            border-radius: 12px;
            border: 2px solid #0077FF;
            box-shadow: 
                0 0 20px rgba(0, 119, 255, 0.6),
                0 0 40px rgba(0, 119, 255, 0.3),
                inset 0 0 15px rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
            transition: all 0.4s ease;
            font-family: 'Orbitron', monospace;
            min-height: 60px;
            backdrop-filter: blur(10px);
        }

        .admin-vk-button:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 
                0 0 30px rgba(0, 119, 255, 0.9),
                0 0 60px rgba(0, 119, 255, 0.5),
                0 10px 30px rgba(0, 0, 0, 0.4),
                inset 0 0 20px rgba(255, 255, 255, 0.3);
            background: linear-gradient(135deg, #0088FF 0%, #0066CC 50%, #0088FF 100%);
            border-color: #00aaff;
        }

        .admin-vk-button:active {
            transform: translateY(-2px) scale(1.02);
        }

        .admin-vk-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: left 0.7s;
        }

        .admin-vk-button:hover::before {
            left: 100%;
        }

        .admin-vk-button::after {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, #0077FF, #00aaff, #0077FF, #00aaff);
            border-radius: 14px;
            z-index: -1;
            opacity: 0;
            transition: opacity 0.4s;
            animation: vkBorderGlow 3s linear infinite;
            background-size: 400% 400%;
        }

        .admin-vk-button:hover::after {
            opacity: 1;
        }

        @keyframes vkBorderGlow {
            0% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
            100% {
                background-position: 0% 50%;
            }
        }

        .admin-vk-icon {
            font-size: 1.5rem;
            margin-right: 0.8rem;
            filter: drop-shadow(0 0 5px rgba(255, 255, 255, 0.7));
            transition: transform 0.3s ease;
        }

        .admin-vk-button:hover .admin-vk-icon {
            transform: scale(1.2) rotate(5deg);
        }

        .admin-vk-badge {
            background: linear-gradient(135deg, var(--neon-pink), var(--neon-purple));
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            margin-left: 0.8rem;
            font-weight: 700;
            box-shadow: 0 0 15px rgba(255, 0, 200, 0.6);
            animation: badgePulse 2s infinite;
            border: 1px solid rgba(255, 255, 255, 0.3);
            text-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
        }

        @keyframes badgePulse {
            0%, 100% {
                box-shadow: 0 0 15px rgba(255, 0, 200, 0.6);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 0 25px rgba(255, 0, 200, 0.9);
                transform: scale(1.05);
            }
        }

        .light-theme .admin-vk-badge {
            background: linear-gradient(135deg, var(--neon-pink), var(--neon-purple));
            box-shadow: 0 0 15px rgba(212, 0, 166, 0.6);
        }

        .light-theme .admin-vk-button {
            background: linear-gradient(135deg, #0077FF 0%, #0055AA 50%, #0077FF 100%);
            border: 2px solid #0077FF;
            box-shadow: 
                0 0 20px rgba(0, 119, 255, 0.5),
                0 0 40px rgba(0, 119, 255, 0.2),
                inset 0 0 15px rgba(255, 255, 255, 0.3);
        }

        .light-theme .admin-vk-button:hover {
            box-shadow: 
                0 0 30px rgba(0, 119, 255, 0.7),
                0 0 60px rgba(0, 119, 255, 0.3),
                0 10px 30px rgba(0, 0, 0, 0.2),
                inset 0 0 20px rgba(255, 255, 255, 0.4);
        }

        /* Адаптивность для мобильных устройств */
        /* ==================== */
/* ТЕЛЕФОННАЯ ВЕРСИЯ - УЛУЧШЕННАЯ */
/* ==================== */

@media (max-width: 768px) {
    /* Улучшенная навигация для телефонов */
    .header-container {
        padding: 0.5rem 1rem;
        flex-wrap: wrap;
        gap: 1rem;
    }
    
    .logo {
        order: 1;
        margin-right: 0;
    }
    
    .burger-menu {
        order: 2;
        display: flex;
        z-index: 101;
    }
    
    .settings-container {
        order: 3;
        margin-left: auto;
    }
    
    .auth-buttons {
        order: 4;
        display: none; /* Скрываем на телефоне, показываем в мобильном меню */
    }
    
    /* Улучшенный логотип для телефонов */
    .logo-icon {
        width: 45px;
        height: 45px;
    }
    
    .logo-icon::before {
        width: 35px;
        height: 35px;
    }
    
    .logo-text {
        font-size: 1.5rem;
        letter-spacing: 1px;
    }
    
    /* Улучшенное мобильное меню */
    .mobile-nav {
        width: 85%;
        max-width: 320px;
        padding: 80px 1.5rem 1.5rem;
    }
    
    .mobile-nav a {
        padding: 0.8rem 1rem;
        font-size: 0.9rem;
        margin-bottom: 0.5rem;
    }
    
    .mobile-nav .user-avatar-with-balance {
        padding: 0.8rem;
        margin-bottom: 1rem;
    }
    
    /* Улучшенный главный баннер для телефонов */
    .welcome-banner {
        padding: 2.5rem 1.5rem;
        margin: 1rem 0.5rem;
    }
    
    .welcome-banner h1 {
        font-size: 2.2rem;
        letter-spacing: 3px;
        line-height: 1.2;
    }
    
    .welcome-banner p {
        font-size: 1rem;
        line-height: 1.5;
        margin-bottom: 2rem;
    }
    
    /* Улучшенные интерактивные элементы */
    .interactive-grid {
        gap: 1.2rem;
        margin: 2.5rem auto;
    }
    
    .grid-item {
        padding: 1.8rem 1.2rem;
    }
    
    .grid-item h3 {
        font-size: 1.2rem;
    }
    
    .grid-icon {
        font-size: 2.2rem;
        margin-bottom: 1rem;
    }
    
    /* Улучшенная статистика */
    .interactive-stats {
        gap: 1rem;
        margin: 2rem 0;
    }
    
    .stat {
        min-width: 110px;
        padding: 1rem;
    }
    
    .stat-value {
        font-size: 1.6rem;
    }
    
    .stat-label {
        font-size: 0.75rem;
    }
    
    /* Улучшенные кнопки для сенсорных устройств */
    .btn, .register-btn, .buy-btn, .auth-btn {
        min-height: 48px;
        padding: 0.8rem 1.8rem;
        font-size: 0.9rem;
        letter-spacing: 1px;
    }
    
    /* Увеличиваем область клика для кнопок на сенсорных устройствах */
    .nav-link, .btn, .buy-btn, .register-btn {
        min-height: 44px;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    
    /* Улучшенные баннеры страниц */
    .page-banner {
        padding: 2.5rem 1.5rem;
        margin: 1.5rem 0.5rem;
    }
    
    .page-banner h1 {
        font-size: 2rem;
        line-height: 1.2;
    }
    
    .page-banner p {
        font-size: 1rem;
        line-height: 1.5;
    }
    
    /* Улучшенные карточки услуг */
    .services {
        gap: 1.5rem;
    }
    
    .service-card {
        padding: 2rem 1.5rem;
    }
    
    .service-icon {
        font-size: 2.8rem;
    }
    
    .service-card h3 {
        font-size: 1.3rem;
    }
    
    /* Улучшенные карточки товаров */
    .products {
        gap: 1.5rem;
    }
    
    .product-card {
        padding: 1.8rem 1.2rem;
    }
    
    .product-icon {
        font-size: 2.5rem;
    }
    
    .product-card h3 {
        font-size: 1.2rem;
    }
    
    .product-price {
        font-size: 1.6rem;
    }
    
    /* Улучшенные турниры */
    .tournament-item {
        padding: 1.5rem;
        text-align: left;
        align-items: flex-start;
    }
    
    .tournament-game {
        font-size: 1.1rem;
    }
    
    /* Улучшенная форма бронирования */
    .booking-form {
        padding: 1.8rem 1.2rem;
        margin: 0.5rem;
    }
    
    .form-group {
        margin-bottom: 1.5rem;
    }
    
    .form-control {
        padding: 0.9rem;
        font-size: 1rem;
    }
    
    /* Улучшенные отзывы */
    .reviews {
        gap: 1.5rem;
    }
    
    .review-card {
        padding: 2rem 1.5rem;
    }
    
    /* Улучшенные контакты */
    .contact-item {
        padding: 1.8rem 1.2rem;
    }
    
    /* Улучшенный футер */
    footer {
        padding: 2rem 1rem;
        margin-top: 3rem;
    }
    
    /* Улучшенные модальные окна для телефонов */
    .modal-content {
        width: 95%;
        max-width: 95%;
        margin: 0.5rem;
        padding: 1.5rem;
    }
    
    .modal-header {
        margin-bottom: 1.5rem;
        padding-bottom: 1rem;
    }
    
    .modal-title {
        font-size: 1.4rem;
    }
    
    /* Специальные улучшения для purchase-modal на телефонах */
    .purchase-modal .modal-content {
        max-height: 90vh;
        overflow-y: auto;
        padding: 1.2rem;
    }
    
    .purchase-modal .zone-selection {
        grid-template-columns: repeat(2, 1fr);
        gap: 0.6rem;
    }
    
    .zone-option {
        padding: 0.8rem;
    }
    
    .zone-icon {
        font-size: 1.3rem;
    }
    
    .zone-name {
        font-size: 0.85rem;
    }
    
    .zone-description {
        font-size: 0.7rem;
    }
    
    /* Улучшенный профиль */
    .profile-avatar {
        width: 100px;
        height: 100px;
        font-size: 2.5rem;
    }
    
    .profile-stats {
        grid-template-columns: repeat(2, 1fr);
        gap: 1rem;
    }
    
    .stat-card {
        padding: 1.5rem 1rem;
    }
    
    /* Улучшенная админ-панель */
    .admin-panel {
        padding: 1.5rem 1rem;
    }
    
    .admin-tabs {
        flex-direction: column;
        gap: 0.5rem;
    }
    
    .admin-tab {
        padding: 0.8rem;
        font-size: 0.9rem;
    }
    
    /* Улучшенные формы ввода */
    input, textarea, select {
        font-size: 16px !important; /* Предотвращает масштабирование в iOS */
    }
    
    /* Улучшенные социальные иконки */
    .social-links {
        gap: 1rem;
        flex-wrap: wrap;
    }
    
    .social-link {
        width: 44px;
        height: 44px;
        font-size: 1.2rem;
    }
    
    /* Улучшенный баланс */
    .balance-amount {
        font-size: 2.8rem;
        margin: 1.5rem 0;
    }
    
    .payment-methods {
        grid-template-columns: 1fr;
        gap: 1.2rem;
    }
    
    .payment-method {
        padding: 1.5rem 1rem;
    }
    
    .payment-icon {
        font-size: 2.5rem;
    }
    
    .payment-title {
        font-size: 1.3rem;
    }
    
    /* Улучшенные новости */
    .news-post {
        padding: 1.5rem;
    }
    
    .news-post-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5rem;
    }
    
    .news-post-stats {
        font-size: 0.9rem;
    }
    
    /* Улучшенная кнопка VK */
    .admin-vk-section {
        padding: 1.5rem 1rem;
    }
    
    .admin-vk-button {
        padding: 1rem 1.8rem;
        font-size: 0.9rem;
        min-height: 54px;
    }
    
    .admin-vk-icon {
        font-size: 1.3rem;
        margin-right: 0.6rem;
    }
    
    .admin-vk-badge {
        padding: 0.2rem 0.6rem;
        font-size: 0.7rem;
        margin-left: 0.6rem;
    }
}

/* ==================== */
/* ОЧЕНЬ МАЛЕНЬКИЕ ТЕЛЕФОНЫ (до 480px) */
/* ==================== */

@media (max-width: 480px) {
    /* Еще более компактная версия */
    .header-container {
        padding: 0.5rem;
    }
    
    .logo-icon {
        width: 40px;
        height: 40px;
    }
    
    .logo-icon::before {
        width: 30px;
        height: 30px;
    }
    
    .logo-text {
        font-size: 1.3rem;
    }
    
    .welcome-banner {
        padding: 2rem 1rem;
    }
    
    .welcome-banner h1 {
        font-size: 1.8rem;
        letter-spacing: 2px;
    }
    
    .welcome-banner p {
        font-size: 0.95rem;
    }
    
    h2 {
        font-size: 1.4rem;
        margin-bottom: 2rem;
    }
    
    /* Компактная сетка */
    .interactive-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
    }
    
    .grid-item {
        padding: 1.5rem 1rem;
    }
    
    /* Компактная статистика */
    .interactive-stats {
        flex-direction: column;
        gap: 0.8rem;
    }
    
    .stat {
        width: 100%;
        min-width: auto;
    }
    
    /* Компактные кнопки */
    .btn, .register-btn, .buy-btn {
        width: 100%;
        padding: 0.9rem;
    }
    
    /* Компактные формы */
    .booking-form {
        padding: 1.5rem 1rem;
    }
    
    .form-control {
        padding: 0.8rem;
    }
    
    /* Компактные карточки */
    .service-card, .product-card, .review-card, .contact-item {
        padding: 1.5rem 1rem;
    }
    
    /* Компактные модальные окна */
    .modal-content {
        padding: 1.2rem 1rem;
    }
    
    .purchase-modal .zone-selection {
        grid-template-columns: 1fr;
    }
    
    .zone-option {
        padding: 0.7rem;
    }
    
    /* Компактный профиль */
    .profile-avatar {
        width: 90px;
        height: 90px;
        font-size: 2.2rem;
    }
    
    .profile-stats {
        grid-template-columns: 1fr;
    }
    
    /* Компактный баланс */
    .balance-amount {
        font-size: 2.2rem;
    }
    
    /* Компактные новости */
    .news-post {
        padding: 1.2rem 1rem;
    }
    
    /* Компактный VK блок */
    .admin-vk-section {
        padding: 1.2rem 0.8rem;
    }
    
    .admin-vk-button {
        padding: 0.9rem 1.2rem;
        font-size: 0.85rem;
        min-height: 50px;
        flex-direction: column;
        gap: 0.3rem;
    }
    
    .admin-vk-icon {
        margin-right: 0;
        font-size: 1.1rem;
    }
    
    .admin-vk-badge {
        margin-left: 0;
    }
}

/* ==================== */
/* ГОРИЗОНТАЛЬНАЯ ОРИЕНТАЦИЯ ТЕЛЕФОНА */
/* ==================== */

@media (max-height: 600px) and (orientation: landscape) {
    .welcome-section {
        min-height: auto;
        padding: 3rem 0;
    }
    
    .welcome-banner {
        padding: 2rem 1.5rem;
        margin: 1rem 0;
    }
    
    .welcome-banner h1 {
        font-size: 1.8rem;
        margin-bottom: 1rem;
    }
    
    .welcome-banner p {
        font-size: 0.9rem;
        margin-bottom: 1.5rem;
    }
    
    .interactive-grid {
        grid-template-columns: repeat(3, 1fr);
        gap: 1rem;
        margin: 2rem auto;
    }
    
    .grid-item {
        padding: 1.2rem 0.8rem;
    }
    
    .interactive-stats {
        flex-direction: row;
        gap: 0.8rem;
        margin: 1.5rem 0;
    }
    
    .stat {
        padding: 0.8rem;
    }
    
    /* Компактный header в ландшафте */
    .header-container {
        padding: 0.5rem;
    }
    
    .logo-icon {
        width: 35px;
        height: 35px;
    }
    
    .logo-text {
        font-size: 1.2rem;
    }
    
    /* Компактное мобильное меню в ландшафте */
    .mobile-nav {
        padding-top: 70px;
    }
}

/* ==================== */
/* ОПТИМИЗАЦИЯ ДЛЯ IOS */
/* ==================== */

@supports (-webkit-touch-callout: none) {
    /* iOS specific styles */
    .btn, .nav-link, .auth-btn {
        -webkit-tap-highlight-color: rgba(0, 243, 255, 0.3);
    }
    
    input, textarea {
        border-radius: 0;
        -webkit-appearance: none;
    }
    
    /* Улучшаем скролл на iOS */
    .mobile-nav {
        -webkit-overflow-scrolling: touch;
    }
    
    /* Предотвращаем увеличение текста в полях ввода */
    input[type="text"],
    input[type="email"],
    input[type="password"],
    input[type="tel"],
    textarea {
        font-size: 16px !important;
    }
}

/* ==================== */
/* ОПТИМИЗАЦИЯ ДЛЯ ANDROID */
/* ==================== */

@supports not (-webkit-touch-callout: none) {
    /* Android specific styles */
    .btn:active, .nav-link:active, .auth-btn:active {
        transform: scale(0.98);
        transition: transform 0.1s;
    }
}

/* ==================== */
/* УЛУЧШЕННАЯ ТИПОГРАФИКА ДЛЯ МОБИЛЬНЫХ */
/* ==================== */

@media (max-width: 768px) {
    body {
        font-size: 14px;
        line-height: 1.5;
    }
    
    h1, h2, h3 {
        line-height: 1.2;
    }
    
    p {
        margin-bottom: 1rem;
        line-height: 1.5;
    }
    
    /* Улучшаем читаемость текста */
    .text-primary, .text-secondary {
        line-height: 1.5;
    }
}

/* ==================== */
/* АДАПТИВНЫЕ ИЗОБРАЖЕНИЯ */
/* ==================== */

@media (max-width: 768px) {
    .gallery-item {
        height: 200px;
    }
    
    .image-placeholder {
        font-size: 1.2rem;
    }
    
    /* Оптимизация для медленных сетей */
    .particles, .lightning-overlay {
        display: none;
    }
    
    /* Отключаем сложные анимации на телефонах для экономии батареи */
    .loader-ring, .floating-element, .grid-overlay {
        animation-duration: 0s;
        animation-iteration-count: 1;
    }
}

/* ==================== */
/* УЛУЧШЕНИЯ ДЛЯ СЕНСОРНОГО ВВОДА */
/* ==================== */

@media (hover: none) and (pointer: coarse) {
    /* Увеличиваем минимальный размер кликабельных элементов для пальцев */
    .btn, .nav-link, .auth-btn, .buy-btn, .register-btn {
        min-height: 44px;
        min-width: 44px;
    }
    
    /* Увеличиваем отступы для лучшего тапа */
    .nav-link {
        padding: 0.8rem 1.2rem;
    }
    
    /* Улучшаем feedback при тапе */
    .btn:active, .nav-link:active, .auth-btn:active {
        opacity: 0.8;
        transform: translateY(1px);
    }
    
    /* Отключаем hover эффекты для сенсорных устройств */
    .grid-item:hover,
    .service-card:hover,
    .product-card:hover,
    .gallery-item:hover,
    .review-card:hover,
    .contact-item:hover {
        transform: none;
        border-color: rgba(0, 243, 255, 0.2);
    }
    
    /* Включаем активные состояния для тапа */
    .grid-item:active,
    .service-card:active,
    .product-card:active,
    .gallery-item:active,
    .review-card:active,
    .contact-item:active {
        transform: scale(0.98);
        border-color: var(--neon-cyan);
    }
}

/* ==================== */
/* УЛУЧШЕНИЯ ДЛЯ КЛАВИАТУРЫ НА ТЕЛЕФОНЕ */
/* ==================== */

@media (max-width: 768px) {
    /* Поднимаем форму при фокусе на поле ввода */
    input:focus, textarea:focus, select:focus {
        scroll-margin-top: 100px;
    }
    
    /* Улучшаем видимость активного поля ввода */
    .form-control:focus {
        box-shadow: 0 0 0 2px var(--neon-cyan);
    }
}

/* ==================== */
/* СПЕЦИАЛЬНЫЕ ФИКСЫ ДЛЯ РАЗНЫХ УСТРОЙСТВ */
/* ==================== */

/* Фикс для Safari на iOS */
@supports (-webkit-overflow-scrolling: touch) {
    .modal-content {
        max-height: -webkit-fill-available;
    }
}

/* Фикс для Chrome на Android */
@media (max-width: 768px) {
    select.form-control {
        height: 48px;
        line-height: 48px;
    }
}

/* ==================== */
/* ТЕМНАЯ/СВЕТЛАЯ ТЕМА ДЛЯ МОБИЛЬНЫХ */
/* ==================== */

@media (max-width: 768px) {
    .light-theme .mobile-nav {
        background: rgba(255, 255, 255, 0.98);
    }
    
    .light-theme .mobile-nav a {
        color: var(--text-primary);
    }
    
    .light-theme .mobile-overlay {
        background: rgba(240, 242, 245, 0.9);
    }
}

/* ==================== */
/* АНИМАЦИИ ДЛЯ МОБИЛЬНЫХ (ОПТИМИЗИРОВАННЫЕ) */
/* ==================== */

@media (max-width: 768px) {
    .page-transition {
        animation: mobilePageFadeIn 0.4s ease-out;
    }
    
    @keyframes mobilePageFadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }
    
    .modal.active .modal-content {
        animation: mobileModalSlideIn 0.3s ease-out;
    }
    
    @keyframes mobileModalSlideIn {
        from { transform: translateY(20px); opacity: 0; }
        to { transform: translateY(0); opacity: 1; }
    }
}

/* ==================== */
/* ДОПОЛНИТЕЛЬНЫЕ УЛУЧШЕНИЯ */
/* ==================== */

/* Улучшение для очень маленьких экранов в портретной ориентации */
@media (max-width: 360px) {
    .logo-text {
        font-size: 1.1rem;
    }
    
    .auth-btn {
        padding: 0.6rem 1rem;
        font-size: 0.8rem;
    }
    
    .welcome-banner h1 {
        font-size: 1.6rem;
    }
    
    .page-banner h1 {
        font-size: 1.6rem;
    }
    
    .product-price {
        font-size: 1.4rem;
    }
}

/* Фикс для высоты экрана на современных телефонах */
@media (max-height: 700px) and (orientation: portrait) {
    .welcome-section {
        padding: 3rem 0 4rem;
    }
    
    .grid-item {
        padding: 1.2rem;
    }
}
        /* Анимация появления для кнопки */
        .admin-vk-section {
            animation: fadeInUp 0.8s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* СТИЛИ ДЛЯ СТРАНИЦЫ НОВОСТЕЙ */
        .news-container {
            display: grid;
            gap: 2rem;
            margin-top: 3rem;
        }

        .news-post {
            background: var(--panel-bg);
            border: 1px solid rgba(0, 243, 255, 0.2);
            border-radius: 10px;
            padding: 2rem;
            transition: all 0.3s;
        }

        .light-theme .news-post {
            border: 1px solid rgba(0, 140, 255, 0.2);
        }

        .news-post:hover {
            border-color: var(--neon-cyan);
            box-shadow: 0 0 20px rgba(0, 243, 255, 0.3);
        }

        .light-theme .news-post:hover {
            box-shadow: 0 0 20px rgba(0, 140, 255, 0.3);
        }

        .news-post-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(0, 243, 255, 0.1);
        }

        .light-theme .news-post-header {
            border-bottom: 1px solid rgba(0, 140, 255, 0.1);
        }

        .news-post-date {
            color: var(--neon-cyan);
            font-weight: 700;
            font-size: 1.1rem;
        }

        .news-post-stats {
            display: flex;
            gap: 1rem;
        }

        .news-stat {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .news-text {
            color: var(--text-primary);
            line-height: 1.6;
            margin-bottom: 1.5rem;
        }

        .news-image {
            max-width: 100%;
            border-radius: 8px;
            margin-top: 1rem;
        }

        .news-actions {
            text-align: center;
            margin-top: 3rem;
        }

        .news-loading {
            text-align: center;
            padding: 3rem;
            color: var(--text-secondary);
        }

        .news-error {
            text-align: center;
            padding: 3rem;
            color: var(--neon-pink);
            background: rgba(255, 0, 200, 0.05);
            border: 1px solid rgba(255, 0, 200, 0.3);
            border-radius: 10px;
        }
/* ==================== */
/* КРИТИЧЕСКИЕ ИСПРАВЛЕНИЯ ДЛЯ МОБИЛЬНЫХ */
/* ==================== */

/* 1. Отключаем сложные анимации на мобильных */
@media (max-width: 768px) {
    .particle, .lightning, .floating-element, 
    .grid-overlay, .scanline, .loader-ring,
    .loader-logo, .logo-icon, .loader-ring {
        display: none !important;
        animation: none !important;
    }
    
    /* Отключаем сложные фоны */
    .cyber-bg, .grid-overlay {
        display: none !important;
    }
    
    /* Упрощаем прелоадер */
    .preloader {
        background: var(--dark-bg);
    }
    
    .loader-logo {
        width: 100px !important;
        height: 100px !important;
        animation: none !important;
    }
    
    .loader-ring {
        display: none !important;
    }
    
    .loading-bar {
        width: 280px !important;
    }
}

/* 2. Фикс для навигации на мобильных */
@media (max-width: 768px) {
    header {
        position: relative !important;
        height: auto;
        min-height: 60px;
    }
    
    .header-container {
        flex-wrap: nowrap !important;
        padding: 0 10px !important;
    }
    
    .logo {
        order: 1;
        flex: 1;
    }
    
    .burger-menu {
        order: 2;
        display: flex !important;
        margin-left: auto;
        margin-right: 10px;
    }
    
    .settings-container {
        order: 3;
        display: none; /* Скрываем на маленьких экранах */
    }
    
    .auth-buttons, .user-menu {
        display: none !important;
    }
    
    /* Мобильное меню */
    .mobile-nav {
        width: 100% !important;
        max-width: 100% !important;
        right: -100%;
    }
    
    .mobile-nav.active {
        right: 0;
    }
    
    .mobile-nav ul {
        padding: 0;
        margin: 0;
    }
    
    .mobile-nav a {
        margin: 5px 0;
        text-align: center;
    }
}

/* 3. Фикс для главной страницы */
@media (max-width: 768px) {
    .welcome-section {
        padding: 1rem !important;
        min-height: auto !important;
    }
    
    .welcome-banner {
        padding: 1.5rem !important;
        margin: 0.5rem !important;
        animation: none !important;
        box-shadow: none !important;
    }
    
    .welcome-banner h1 {
        font-size: 1.8rem !important;
        letter-spacing: 2px !important;
        line-height: 1.2 !important;
    }
    
    .welcome-banner p {
        font-size: 0.9rem !important;
        line-height: 1.4 !important;
    }
    
    .interactive-grid {
        grid-template-columns: 1fr !important;
        gap: 1rem !important;
        margin: 1rem 0 !important;
    }
    
    .grid-item {
        padding: 1rem !important;
    }
    
    .interactive-stats {
        flex-direction: column !important;
        gap: 0.5rem !important;
        margin: 1rem 0 !important;
    }
    
    .stat {
        width: 100% !important;
        margin: 5px 0;
    }
}

/* 4. Фикс для всех остальных страниц */
@media (max-width: 768px) {
    main {
        padding: 1rem !important;
    }
    
    .page-banner {
        padding: 1.5rem 1rem !important;
        margin: 0.5rem 0 !important;
        text-align: center;
    }
    
    .page-banner h1 {
        font-size: 1.6rem !important;
        line-height: 1.2 !important;
    }
    
    .page-banner p {
        font-size: 0.9rem !important;
    }
    
    h2 {
        font-size: 1.4rem !important;
        margin-bottom: 1.5rem !important;
        text-align: center;
    }
    
    /* Галерея */
    .gallery {
        grid-template-columns: repeat(2, 1fr) !important;
        gap: 0.5rem !important;
    }
    
    .gallery-item {
        height: 150px !important;
    }
    
    /* Услуги */
    .services {
        grid-template-columns: 1fr !important;
        gap: 1rem !important;
    }
    
    .service-card {
        padding: 1.5rem 1rem !important;
    }
    
    /* Турниры */
    .tournament-item {
        flex-direction: column !important;
        padding: 1rem !important;
        text-align: center;
    }
    
    /* Магазин */
    .products {
        grid-template-columns: 1fr !important;
        gap: 1rem !important;
    }
    
    /* Формы */
    .booking-form, .payment-form {
        padding: 1rem !important;
        margin: 0 !important;
    }
    
    .form-control {
        font-size: 16px !important; /* Важно для iOS */
    }
    
    /* Модальные окна */
    .modal-content {
        width: 95% !important;
        margin: 10px !important;
        padding: 1rem !important;
    }
    
    .purchase-modal .zone-selection {
        grid-template-columns: repeat(2, 1fr) !important;
        gap: 0.5rem !important;
    }
    
    .zone-option {
        padding: 0.5rem !important;
    }
}

/* 5. Фикс для очень маленьких экранов */
@media (max-width: 480px) {
    .gallery {
        grid-template-columns: 1fr !important;
    }
    
    .logo-text {
        font-size: 1.2rem !important;
    }
    
    .logo-icon {
        width: 35px !important;
        height: 35px !important;
    }
    
    .burger-menu {
        width: 25px !important;
        height: 18px !important;
    }
    
    .btn, .auth-btn, .register-btn, .buy-btn {
        padding: 0.7rem 1rem !important;
        font-size: 0.8rem !important;
        min-height: 40px !important;
    }
    
    .modal-content {
        padding: 0.8rem !important;
    }
    
    .purchase-modal .zone-selection {
        grid-template-columns: 1fr !important;
    }
}

/* 6. Оптимизация производительности */
@media (max-width: 768px) {
    /* Отключаем тяжелые CSS эффекты */
    * {
        transform: none !important;
        transition: none !important;
        animation: none !important;
        box-shadow: none !important;
        text-shadow: none !important;
        filter: none !important;
        backdrop-filter: none !important;
    }
    
    /* Сохраняем только необходимые анимации */
    .page-transition {
        animation: fadeIn 0.3s ease-out !important;
    }
    
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    
    /* Упрощаем кнопки */
    .btn:hover, .auth-btn:hover, .nav-link:hover {
        transform: none !important;
        box-shadow: none !important;
    }
    
    /* Упрощаем карточки */
    .grid-item:hover, .service-card:hover, .product-card:hover {
        transform: none !important;
        box-shadow: none !important;
    }
}

/* 7. Фикс для касаний на мобильных */
@media (hover: none) and (pointer: coarse) {
    /* Увеличиваем зону клика */
    .btn, .nav-link, .auth-btn, .buy-btn {
        min-height: 44px !important;
        min-width: 44px !important;
    }
    
    /* Увеличиваем отступы в навигации */
    .nav-link {
        padding: 12px 16px !important;
        margin: 4px 0 !important;
    }
    
    /* Feedback при касании */
    .btn:active, .nav-link:active {
        opacity: 0.7;
        background: rgba(0, 243, 255, 0.2) !important;
    }
    
    /* Отключаем hover эффекты */
    .grid-item:hover::before,
    .service-card:hover::before,
    .btn:hover::before {
        display: none !important;
    }
}

/* 8. Фикс для iOS */
@supports (-webkit-touch-callout: none) {
    /* Предотвращаем масштабирование */
    input, textarea, select {
        font-size: 16px !important;
        -webkit-text-size-adjust: 100%;
    }
    
    /* Улучшаем скролл */
    .mobile-nav {
        -webkit-overflow-scrolling: touch;
    }
    
    /* Фикс для fixed элементов */
    header {
        position: sticky;
        top: 0;
        -webkit-transform: translateZ(0);
        transform: translateZ(0);
    }
}

/* 9. Фикс для Android */
@supports not (-webkit-touch-callout: none) {
    .btn:active, .nav-link:active {
        transform: scale(0.98);
        transition: transform 0.1s;
    }
}

/* 10. Улучшение для медленных устройств */
@media (max-width: 768px) {
    /* Скрываем ненужные элементы */
    .floating-elements,
    .lightning-overlay,
    .particles,
    .grid-overlay,
    .scanline {
        display: none !important;
    }
    
    /* Упрощаем фон */
    body {
        background: var(--dark-bg) !important;
        background-image: none !important;
    }
    
    /* Уменьшаем качество градиентов */
    .logo-icon, .loader-logo {
        background: var(--neon-cyan) !important;
    }
}
/* ==================== */
/* СТИЛИ ДЛЯ ПОДТВЕРЖДЕНИЯ РЕГИСТРАЦИИ */
/* ==================== */

.confirmation-method-selector {
    display: flex;
    gap: 2rem;
    margin-bottom: 2rem;
    justify-content: center;
}

.confirmation-method {
    display: flex;
    align-items: center;
    gap: 0.8rem;
    padding: 1rem 1.5rem;
    background: var(--panel-bg);
    border: 2px solid rgba(0, 243, 255, 0.2);
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.3s;
    flex: 1;
    max-width: 250px;
}

.light-theme .confirmation-method {
    border: 2px solid rgba(0, 140, 255, 0.2);
}

.confirmation-method:hover {
    border-color: var(--neon-cyan);
    box-shadow: 0 0 15px rgba(0, 243, 255, 0.3);
}

.light-theme .confirmation-method:hover {
    border-color: var(--neon-cyan);
    box-shadow: 0 0 15px rgba(0, 140, 255, 0.3);
}

.confirmation-method.selected {
    border-color: var(--neon-green);
    background: rgba(0, 255, 136, 0.1);
    box-shadow: 0 0 20px rgba(0, 255, 136, 0.3);
}

.light-theme .confirmation-method.selected {
    background: rgba(0, 204, 106, 0.1);
    box-shadow: 0 0 20px rgba(0, 204, 106, 0.3);
}

.confirmation-method-icon {
    font-size: 1.8rem;
    color: var(--neon-cyan);
}

.confirmation-method.selected .confirmation-method-icon {
    color: var(--neon-green);
}

.confirmation-method-info {
    flex: 1;
}

.confirmation-method-title {
    font-weight: 700;
    color: var(--neon-cyan);
    margin-bottom: 0.3rem;
}

.confirmation-method.selected .confirmation-method-title {
    color: var(--neon-green);
}

.confirmation-method-desc {
    font-size: 0.85rem;
    color: var(--text-secondary);
}

.confirmation-checkbox {
    margin: 1.5rem 0;
    padding: 1rem;
    background: var(--panel-bg);
    border: 1px solid rgba(0, 243, 255, 0.2);
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.light-theme .confirmation-checkbox {
    border: 1px solid rgba(0, 140, 255, 0.2);
}

.confirmation-agreement {
    display: flex;
    align-items: center;
    gap: 1rem;
    cursor: pointer;
}

.confirmation-agreement input {
    width: 20px;
    height: 20px;
}

.confirmation-agreement span {
    color: var(--text-secondary);
    font-size: 0.95rem;
}

.confirmation-agreement span a {
    color: var(--neon-cyan);
    text-decoration: none;
}

.confirmation-agreement span a:hover {
    text-decoration: underline;
}

/* Модальное окно подтверждения */
.confirmation-modal .modal-content {
    max-width: 500px;
}

.confirmation-code-container {
    text-align: center;
    padding: 2rem;
}

.confirmation-method-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    background: rgba(0, 243, 255, 0.1);
    border: 1px solid var(--neon-cyan);
    border-radius: 20px;
    margin-bottom: 1.5rem;
    color: var(--neon-cyan);
    font-weight: 700;
}

.light-theme .confirmation-method-badge {
    background: rgba(0, 140, 255, 0.1);
}

.confirmation-sent-to {
    font-size: 1.1rem;
    color: var(--text-primary);
    margin-bottom: 1.5rem;
}

.confirmation-code {
    font-size: 2.5rem;
    font-weight: 900;
    letter-spacing: 10px;
    color: var(--neon-green);
    margin: 1.5rem 0;
    padding: 1rem;
    background: rgba(0, 255, 136, 0.05);
    border: 2px dashed var(--neon-green);
    border-radius: 10px;
    text-align: center;
    user-select: all;
}

.confirmation-code-inputs {
    display: flex;
    gap: 0.5rem;
    justify-content: center;
    margin: 2rem 0;
}

.confirmation-code-input {
    width: 50px;
    height: 70px;
    text-align: center;
    font-size: 2rem;
    font-weight: 900;
    font-family: 'Orbitron', monospace;
    background: var(--panel-bg);
    border: 2px solid rgba(0, 243, 255, 0.3);
    color: var(--neon-cyan);
    border-radius: 8px;
    transition: all 0.3s;
}

.light-theme .confirmation-code-input {
    border: 2px solid rgba(0, 140, 255, 0.3);
}

.confirmation-code-input:focus {
    border-color: var(--neon-cyan);
    box-shadow: 0 0 15px rgba(0, 243, 255, 0.5);
    outline: none;
}

.light-theme .confirmation-code-input:focus {
    box-shadow: 0 0 15px rgba(0, 140, 255, 0.5);
}

.confirmation-code-input.filled {
    border-color: var(--neon-green);
    background: rgba(0, 255, 136, 0.1);
}

.confirmation-timer {
    margin-top: 1rem;
    color: var(--text-secondary);
    font-size: 0.95rem;
}

.confirmation-timer span {
    color: var(--neon-cyan);
    font-weight: 700;
}

.confirmation-timer.expired {
    color: var(--neon-pink);
}

.confirmation-timer.expired span {
    color: var(--neon-pink);
}

.confirmation-actions {
    display: flex;
    gap: 1rem;
    justify-content: center;
    margin-top: 2rem;
}

.confirmation-actions .btn {
    min-width: 150px;
}

.confirmation-success {
    text-align: center;
    padding: 2rem;
    animation: fadeIn 0.5s ease;
}

.confirmation-success-icon {
    font-size: 4rem;
    color: var(--neon-green);
    margin-bottom: 1.5rem;
    animation: bounce 1s ease infinite;
}

@keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
}

.confirmation-success h3 {
    color: var(--neon-green);
    margin-bottom: 1rem;
    font-size: 1.8rem;
}

.confirmation-success p {
    color: var(--text-primary);
    margin-bottom: 2rem;
}

.confirmation-error {
    color: var(--neon-pink);
    text-align: center;
    margin-top: 1rem;
    font-size: 0.95rem;
    display: none;
}

.confirmation-error.show {
    display: block;
}

/* Индикатор подтвержденного аккаунта */
.user-confirmed-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.3rem;
    background: rgba(0, 255, 136, 0.1);
    color: var(--neon-green);
    padding: 0.3rem 0.8rem;
    border-radius: 12px;
    font-size: 0.8rem;
    font-weight: 700;
    margin-left: 0.5rem;
    border: 1px solid var(--neon-green);
}

.light-theme .user-confirmed-badge {
    background: rgba(0, 204, 106, 0.1);
}

/* Блок неподтвержденного аккаунта */
.unconfirmed-warning {
    background: linear-gradient(135deg, rgba(255, 238, 0, 0.1) 0%, rgba(255, 119, 0, 0.1) 100%);
    border: 1px solid var(--neon-yellow);
    border-radius: 10px;
    padding: 1.5rem;
    margin: 2rem 0;
    text-align: center;
}

.light-theme .unconfirmed-warning {
    background: linear-gradient(135deg, rgba(230, 216, 0, 0.1) 0%, rgba(230, 92, 0, 0.1) 100%);
}

.unconfirmed-warning h4 {
    color: var(--neon-yellow);
    margin-bottom: 0.8rem;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
}

.unconfirmed-warning p {
    color: var(--text-primary);
    margin-bottom: 1rem;
}

/* Адаптивность для подтверждения */
@media (max-width: 768px) {
    .confirmation-method-selector {
        flex-direction: column;
        align-items: center;
    }
    
    .confirmation-method {
        max-width: 100%;
        width: 100%;
    }
    
    .confirmation-code-inputs {
        gap: 0.3rem;
    }
    
    .confirmation-code-input {
        width: 40px;
        height: 60px;
        font-size: 1.8rem;
    }
    
    .confirmation-code {
        font-size: 2rem;
        letter-spacing: 8px;
        padding: 0.8rem;
    }
    
    .confirmation-actions {
        flex-direction: column;
    }
    
    .confirmation-actions .btn {
        width: 100%;
    }
}

@media (max-width: 480px) {
    .confirmation-code-inputs {
        gap: 0.2rem;
    }
    
    .confirmation-code-input {
        width: 35px;
        height: 50px;
        font-size: 1.5rem;
    }
    
    .confirmation-code {
        font-size: 1.8rem;
        letter-spacing: 6px;
        padding: 0.6rem;
    }
}
    </style>
</head>
<body>
    <!-- Улучшенный прелоадер с эффектом красных молний - ЦЕНТРИРОВАННЫЙ -->
    <div class="preloader" id="preloader">
        <div class="loader-container">
            <!-- Эффект красных молний - УВЕЛИЧЕННОЕ КОЛИЧЕСТВО -->
            <div class="lightning-overlay" id="lightning-container"></div>
            
            <!-- Анимированные кольца -->
            <div class="loader-rings">
                <div class="loader-ring ring-1"></div>
                <div class="loader-ring ring-2"></div>
                <div class="loader-ring ring-3"></div>
            </div>
            
            <!-- Основной логотип -->
            <div class="loader-logo"></div>
            
            <!-- Текст -->
            <div class="loader-text">КиберСфера</div>
            <div class="loader-subtitle">Инициализация киберпространства...</div>
            
            <!-- Прогресс-бар -->
            <div class="loading-bar">
                <div class="loading-progress" id="loading-progress"></div>
            </div>
        </div>
    </div>

    <div class="cyber-bg"></div>
    <div class="grid-overlay"></div>
    <div class="scanline"></div>
    <div class="particles" id="particles-container"></div>

    <!-- ИСПРАВЛЕННАЯ ШАПКА - ЛОГОТИП СЛЕВА, КНОПКИ СПРАВА -->
    <header>
        <div class="header-container">
            <!-- Логотип слева -->
            <div class="logo" id="home-link">
                <div class="logo-icon"></div>
                <div class="logo-text">КиберСфера</div>
            </div>
            
            <!-- Бургер-меню для мобильных устройств -->
            <button class="burger-menu" id="burger-menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
            
            <!-- Навигация по центру -->
            <nav>
                <ul>
                    <!-- Убрана кнопка "Главная" -->
                    <li><a href="#" class="nav-link" data-page="gallery">Галерея</a></li>
                    <li><a href="#" class="nav-link" data-page="services">Услуги</a></li>
                    <li><a href="#" class="nav-link" data-page="tournaments">Турниры</a></li>
                    <li><a href="#" class="nav-link" data-page="news">Новости</a></li>
                    <li><a href="#" class="nav-link" data-page="contacts">Контакты</a></li>
                    <li><a href="#" class="nav-link" data-page="store">Магазин</a></li>
                </ul>
            </nav>
            
            <!-- Кнопки авторизации и настройки справа -->
            <div class="auth-buttons" id="auth-buttons">
                <a href="#" class="auth-btn auth-btn-secondary" id="login-btn">Войти</a>
                <a href="#" class="auth-btn" id="register-btn">Регистрация</a>
                
                <!-- Кнопка настроек с улучшенной шестерёнкой -->
                <div class="settings-container">
                    <button class="settings-btn" id="settings-btn">
                        <!-- Улучшенная шестерёнка -->
                        <div class="advanced-gear"></div>
                    </button>
                    <div class="settings-dropdown" id="settings-dropdown">
                        <h3 class="settings-title">Настройки</h3>
                        <div class="setting-option">
                            <span class="setting-label">Светлая тема</span>
                            <label class="switch">
                                <input type="checkbox" id="theme-switch">
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ИСПРАВЛЕННОЕ МЕНЮ ПОЛЬЗОВАТЕЛЯ - ОБЪЕДИНЕННЫЙ БАЛАНС И АВАТАР -->
            <div class="user-menu" id="user-menu" style="display: none;">
                <!-- Объединенная кнопка аватара и баланса -->
                <div class="user-avatar-with-balance" id="user-avatar-balance">
                    <div class="user-avatar" id="user-avatar"></div>
                    <div class="user-balance">Баланс: <span id="user-balance-amount">0</span> ₽</div>
                </div>
                
                <a href="#" class="nav-link" data-page="profile">Кабинет</a>
                <a href="#" class="nav-link" data-page="admin" id="admin-link" style="display: none;">Админ</a>
                <a href="#" class="nav-link" id="logout-btn">Выйти</a>
                
                <!-- Кнопка настроек для авторизованного пользователя с улучшенной шестерёнкой -->
                <div class="settings-container">
                    <button class="settings-btn" id="settings-btn-user">
                        <!-- Улучшенная шестерёнка -->
                        <div class="advanced-gear"></div>
                    </button>
                    <div class="settings-dropdown" id="settings-dropdown-user">
                        <h3 class="settings-title">Настройки</h3>
                        <div class="setting-option">
                            <span class="setting-label">Светлая тема</span>
                            <label class="switch">
                                <input type="checkbox" id="theme-switch-user">
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Мобильная навигация -->
     
    <div class="mobile-overlay" id="mobile-overlay"></div>
    <div class="mobile-nav" id="mobile-nav">
        
        <ul>
            <!-- Убрана кнопка "Главная" -->
            <li><a href="#" class="nav-link" data-page="gallery">Галерея</a></li>
            <li><a href="#" class="nav-link" data-page="services">Услуги</a></li>
            <li><a href="#" class="nav-link" data-page="tournaments">Турниры</a></li>
            <li><a href="#" class="nav-link" data-page="news">Новости</a></li>
            <li><a href="#" class="nav-link" data-page="contacts">Контакты</a></li>
            <li><a href="#" class="nav-link" data-page="store">Магазин</a></li>
        </ul>
        
        <div class="user-section" id="mobile-user-section">
            <!-- Здесь будет динамически добавляться контент для авторизованных пользователей -->
        </div>
        
        <div class="auth-buttons" id="mobile-auth-buttons">
            <a href="#" class="auth-btn auth-btn-secondary" id="mobile-login-btn">Войти</a>
            <a href="#" class="auth-btn" id="mobile-register-btn">Регистрация</a>
        </div>
    </div>

    <!-- Главная страница - РАМКА ТОЛЬКО ВОКРУГ ТЕКСТА -->
    <div id="main-page" class="page active page-transition">
        <main>
            <section id="welcome" class="welcome-section fade-in visible">
                <!-- Плавающие элементы -->
                <div class="floating-elements">
                    <div class="floating-element"></div>
                    <div class="floating-element"></div>
                    <div class="floating-element"></div>
                </div>
                
                <!-- БАННЕР С РАМКОЙ ВОКРУГ ТЕКСТА -->
                <div class="welcome-banner">
                    <h1>КиберСфера</h1>
                    <p>Футуристичный киберспортивный хаб, где технологии встречаются с экстримом. Погрузитесь в мир высокооктановых киберспортивных баталий и инновационных игровых возможностей.</p>
                </div>
                
                <!-- Интерактивная статистика -->
                <div class="interactive-stats">
                    <div class="stat" data-value="1500">
                        <div class="stat-value">0</div>
                        <div class="stat-label">Игроков онлайн</div>
                    </div>
                    <div class="stat" data-value="42">
                        <div class="stat-value">0</div>
                        <div class="stat-label">Турниров в месяц</div>
                    </div>
                    <div class="stat" data-value="99">
                        <div class="stat-value">0</div>
                        <div class="stat-label">Уровень удовлетворенности</div>
                    </div>
                </div>
                
                <!-- Интерактивная сетка -->
                <div class="interactive-grid">
                    <div class="grid-item" data-page="tournaments">
                        <div class="grid-icon">⚡</div>
                        <h3>Турниры</h3>
                        <p>Примите участие в киберспортивных баталиях</p>
                    </div>
                    <div class="grid-item" data-page="services">
                        <div class="grid-icon">🎮</div>
                        <h3>Услуги</h3>
                        <p>Мощные игровые ПК и VR-зона</p>
                    </div>
                    <div class="grid-item" data-page="store">
                        <div class="grid-icon">🛒</div>
                        <h3>Магазин</h3>
                        <p>Игровое время и абонементы</p>
                    </div>
                </div>
                
                <button class="btn" id="register-main-btn">Присоединиться</button>
            </section>
        </main>

        <footer>
            <div class="footer-text">© 2025 КиберСфера. Все права защищены.</div>
           
        </footer>
    </div>

    <!-- Страница галереи -->
    <div id="gallery-page" class="page">
        <main>
            <div class="page-banner">
                <h1>Галерея</h1>
                <p>Погрузитесь в атмосферу нашего киберпространства</p>
            </div>
            
            <section>
                <h2>Наши игровые зоны</h2>
                <div class="gallery">
                    <div class="gallery-item">
                        <div class="image-placeholder">VR Зона</div>
                    </div>
                    <div class="gallery-item">
                        <div class="image-placeholder">Игровые ПК</div>
                    </div>
                    <div class="gallery-item">
                        <div class="image-placeholder">Турнирная зона</div>
                    </div>
                    <div class="gallery-item">
                        <div class="image-placeholder">Комфорт зона</div>
                    </div>
                    <div class="gallery-item">
                        <div class="image-placeholder">Бар и кухня</div>
                    </div>
                    <div class="gallery-item">
                        <div class="image-placeholder">Кибер-арт</div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Страница услуг -->
    <div id="services-page" class="page">
        <main>
            <div class="page-banner">
                <h1>Услуги</h1>
                <p>Полный спектр киберспортивных и развлекательных услуг</p>
            </div>
            
            <section>
                <h2>Наши предложения</h2>
                <div class="services">
                    <div class="service-card">
                        <div class="service-icon">🎮</div>
                        <h3>Игровые ПК</h3>
                        <p>Мощные компьютеры с RTX 4080, процессорами Intel i9 и мониторами 240 Гц</p>
                    </div>
                    <div class="service-card">
                        <div class="service-icon">🕶️</div>
                        <h3>VR Зона</h3>
                        <p>Погружение в виртуальную реальность с современным оборудованием</p>
                    </div>
                    <div class="service-card">
                        <div class="service-icon">🎯</div>
                        <h3>Турниры</h3>
                        <p>Регулярные киберспортивные соревнования с призовыми фондами</p>
                    </div>
                    <div class="service-card">
                        <div class="service-icon">🍕</div>
                        <h3>Питание</h3>
                        <p>Вкусные закуски и напитки прямо на месте</p>
                    </div>
                    <div class="service-card">
                        <div class="service-icon">👥</div>
                        <h3>Командные игры</h3>
                        <p>Организация командных баталий и корпоративных мероприятий</p>
                    </div>
                    <div class="service-card">
                        <div class="service-icon">🎓</div>
                        <h3>Обучение</h3>
                        <p>Тренировки с профессиональными игроками и киберспортивные курсы</p>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Страница турниров -->
    <div id="tournaments-page" class="page">
        <main>
            <div class="page-banner">
                <h1>Турниры</h1>
                <p>Примите участие в захватывающих киберспортивных соревнованиях</p>
            </div>
            
            <section>
                <h2>Ближайшие события</h2>
                <div class="tournament-list">
                    <div class="tournament-item">
                        <div class="tournament-info">
                            <div class="tournament-game">Counter-Strike 2</div>
                            <div class="tournament-date">15 апреля 2025 • 18:00</div>
                            <div class="tournament-prize">Призовой фонд: 50 000 ₽</div>
                        </div>
                        <button class="register-btn">Участвовать</button>
                    </div>
                    <div class="tournament-item">
                        <div class="tournament-info">
                            <div class="tournament-game">Dota 2</div>
                            <div class="tournament-date">22 апреля 2025 • 17:00</div>
                            <div class="tournament-prize">Призовой фонд: 75 000 ₽</div>
                        </div>
                        <button class="register-btn">Участвовать</button>
                    </div>
                    <div class="tournament-item">
                        <div class="tournament-info">
                            <div class="tournament-game">Valorant</div>
                            <div class="tournament-date">29 апреля 2025 • 19:00</div>
                            <div class="tournament-prize">Призовой фонд: 40 000 ₽</div>
                        </div>
                        <button class="register-btn">Участвовать</button>
                    </div>
                    <div class="tournament-item">
                        <div class="tournament-info">
                            <div class="tournament-game">League of Legends</div>
                            <div class="tournament-date">6 мая 2025 • 16:00</div>
                            <div class="tournament-prize">Призовой фонд: 60 000 ₽</div>
                        </div>
                        <button class="register-btn">Участвовать</button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Страница новостей -->
    <div id="news-page" class="page">
        <main>
            <div class="page-banner">
                <h1>Новости</h1>
                <p>Самые свежие новости из нашего сообщества ВКонтакте</p>
            </div>
            
            <section>
                <div class="news-container" id="news-container">
                    <div class="news-loading">
                        <h3>Загрузка новостей...</h3>
                        <p>Пожалуйста, подождите, новости загружаются из ВКонтакте</p>
                    </div>
                </div>
                
                <div class="news-actions">
                    <button class="btn" id="refresh-news">Обновить новости</button>
                </div>
            </section>
        </main>
    </div>

    <!-- Страница контактов -->
    <div id="contacts-page" class="page">
        <main>
            <div class="page-banner">
                <h1>Контакты</h1>
                <p>Свяжитесь с нами любым удобным способом</p>
            </div>
            
            <section>
                <h2>Как нас найти</h2>
                <div class="contact-info">
                    <div class="contact-item">
                        <h3>Адрес</h3>
                        <p>г. Пермь, ул. Ленина, 123<br>ТЦ "КиберПлаза", 3 этаж</p>
                    </div>
                    <div class="contact-item">
                        <h3>Телефон</h3>
                        <p>+7 (342) 123-45-67</p>
                    </div>
                    <div class="contact-item">
                        <h3>Email</h3>
                        <p>info@kibersfera.ru</p>
                    </div>
                    <div class="contact-item">
                        <h3>Часы работы</h3>
                        <p>Пн-Чт: 12:00 - 00:00<br>Пт-Вс: 12:00 - 02:00</p>
                    </div>
                </div>
                
                <div class="booking-form">
                    <h3>Забронировать место</h3>
                    <form id="booking-form">
                        <div class="form-group">
                            <label for="booking-name">Имя</label>
                            <input type="text" id="booking-name" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="booking-phone">Телефон</label>
                            <input type="tel" id="booking-phone" class="form-control masked-input" placeholder="+7 (___) ___-__-__" required>
                        </div>
                        <div class="form-group">
                            <label for="booking-date">Дата и время</label>
                            <input type="datetime-local" id="booking-date" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="booking-hours">Количество часов</label>
                            <input type="number" id="booking-hours" class="form-control" min="1" max="8" value="2" required>
                        </div>
                        <div class="form-group">
                            <label for="booking-comment">Комментарий</label>
                            <textarea id="booking-comment" class="form-control" rows="4"></textarea>
                        </div>
                        <button type="submit" class="btn">Забронировать</button>
                    </form>
                </div>
            </section>
        </main>
    </div>

    <!-- Страница магазина -->
    <div id="store-page" class="page">
        <main>
            <div class="page-banner">
                <h1>Магазин</h1>
                <p>Приобретите игровое время и абонементы</p>
            </div>
            
            <section>
                <h2>Наши предложения</h2>
                <div class="products">
                    <div class="product-card">
                        <div class="product-icon">⏱️</div>
                        <h3>1 час</h3>
                        <div class="product-price money">200 ₽</div>
                        <ul class="product-features">
                            <li>Доступ к игровому ПК</li>
                            <li>Бесплатные напитки</li>
                            <li>Участие в турнирах</li>
                        </ul>
                        <button class="buy-btn" data-product="1 час" data-price="200">Купить</button>
                    </div>
                    <div class="product-card featured">
                        <div class="product-icon">🔥</div>
                        <h3>5 часов</h3>
                        <div class="product-price money">800 ₽</div>
                        <ul class="product-features">
                            <li>Доступ к игровому ПК</li>
                            <li>Бесплатные напитки</li>
                            <li>Участие в турнирах</li>
                            <li>Скидка 20% на питание</li>
                        </ul>
                        <button class="buy-btn" data-product="5 часов" data-price="800">Купить</button>
                    </div>
                    <div class="product-card">
                        <div class="product-icon">⭐</div>
                        <h3>10 часов</h3>
                        <div class="product-price money">1 500 ₽</div>
                        <ul class="product-features">
                            <li>Доступ к игровому ПК</li>
                            <li>Бесплатные напитки</li>
                            <li>Участие в турнирах</li>
                            <li>Скидка 20% на питание</li>
                            <li>Приоритетное место</li>
                        </ul>
                        <button class="buy-btn" data-product="10 часов" data-price="1500">Купить</button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Страница баланса -->
    <div id="balance-page" class="page">
        <main>
            <div class="page-banner">
                <h1>Баланс</h1>
                <p>Управляйте вашими средствами и пополняйте счет</p>
            </div>
            
            <section>
                <div class="balance-container">
                    <h2>Ваш текущий баланс</h2>
                    <div class="balance-amount money" id="balance-amount">0 ₽</div>
                    <div class="balance-limit-info">
                        Максимальный баланс: <span class="balance-limit-warning">10 000 ₽</span>
                    </div>
                    
                    <h2>Пополнить баланс</h2>
                    <div class="payment-methods">
                        <div class="payment-method" data-method="card">
                            <div class="payment-icon">💳</div>
                            <h3 class="payment-title">Банковская карта</h3>
                            <p class="payment-description">Мгновенное пополнение с любой карты</p>
                            <button class="btn-secondary">Выбрать</button>
                        </div>
                        
                        <div class="payment-method" data-method="qiwi">
                            <div class="payment-icon">🧾</div>
                            <h3 class="payment-title">QIWI Кошелек</h3>
                            <p class="payment-description">Пополнение через QIWI за 1 минуту</p>
                            <button class="btn-secondary">Выбрать</button>
                        </div>
                        
                        <div class="payment-method" data-method="yoomoney">
                            <div class="payment-icon">💰</div>
                            <h3 class="payment-title">ЮMoney</h3>
                            <p class="payment-description">Быстрое пополнение через ЮMoney</p>
                            <button class="btn-secondary">Выбрать</button>
                        </div>
                        
                        <div class="payment-method" data-method="crypto">
                            <div class="payment-icon">₿</div>
                            <h3 class="payment-title">Криптовалюта</h3>
                            <p class="payment-description">Пополнение Bitcoin, Ethereum и др.</p>
                            <button class="btn-secondary">Выбрать</button>
                        </div>
                    </div>
                    
                    <!-- Форма пополнения картой -->
                    <div class="payment-form" id="card-payment-form">
                        <h3>Пополнение банковской картой</h3>
                        <form id="card-payment-form-content">
                            <div class="form-group">
                                <label for="card-amount">Сумма пополнения (₽)</label>
                                <input type="text" id="card-amount" class="form-control masked-input money" placeholder="1 000" required>
                            </div>
                            <div class="form-group">
                                <label for="card-number">Номер карты</label>
                                <input type="text" id="card-number" class="form-control masked-input" placeholder="0000 0000 0000 0000" required>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="card-expiry">Срок действия</label>
                                    <input type="text" id="card-expiry" class="form-control masked-input" placeholder="ММ/ГГ" required>
                                </div>
                                <div class="form-group">
                                    <label for="card-cvc">CVC</label>
                                    <input type="text" id="card-cvc" class="form-control masked-input" placeholder="123" required>
                                </div>
                            </div>
                            <div class="payment-amount">К оплате: <span id="card-payment-amount" class="money">1 000</span> ₽</div>
                            <button type="submit" class="btn-success">Оплатить</button>
                        </form>
                    </div>
                    
                    <!-- Форма пополнения QIWI -->
                    <div class="payment-form" id="qiwi-payment-form">
                        <h3>Пополнение через QIWI</h3>
                        <form id="qiwi-payment-form-content">
                            <div class="form-group">
                                <label for="qiwi-amount">Сумма пополнения (₽)</label>
                                <input type="text" id="qiwi-amount" class="form-control masked-input money" placeholder="1 000" required>
                            </div>
                            <div class="form-group">
                                <label for="qiwi-phone">Номер QIWI кошелька</label>
                                <input type="tel" id="qiwi-phone" class="form-control masked-input" placeholder="+7 (___) ___-__-__" required>
                            </div>
                            <div class="payment-amount">К оплате: <span id="qiwi-payment-amount" class="money">1 000</span> ₽</div>
                            <button type="submit" class="btn-success">Перейти к оплате</button>
                        </form>
                    </div>
                    
                    <!-- Форма пополнения ЮMoney -->
                    <div class="payment-form" id="yoomoney-payment-form">
                        <h3>Пополнение через ЮMoney</h3>
                        <form id="yoomoney-payment-form-content">
                            <div class="form-group">
                                <label for="yoomoney-amount">Сумма пополнения (₽)</label>
                                <input type="text" id="yoomoney-amount" class="form-control masked-input money" placeholder="1 000" required>
                            </div>
                            <div class="payment-amount">К оплате: <span id="yoomoney-payment-amount" class="money">1 000</span> ₽</div>
                            <button type="submit" class="btn-success">Перейти к оплате</button>
                        </form>
                    </div>
                    
                    <!-- Форма пополнения криптовалютой -->
                    <div class="payment-form" id="crypto-payment-form">
                        <h3>Пополнение криптовалютой</h3>
                        <form id="crypto-payment-form-content">
                            <div class="form-group">
                                <label for="crypto-amount">Сумма пополнения (₽)</label>
                                <input type="text" id="crypto-amount" class="form-control masked-input money" placeholder="1 000" required>
                            </div>
                            <div class="form-group">
                                <label for="crypto-currency">Криптовалюта</label>
                                <select id="crypto-currency" class="form-control" required>
                                    <option value="btc">Bitcoin (BTC)</option>
                                    <option value="eth">Ethereum (ETH)</option>
                                    <option value="usdt">Tether (USDT)</option>
                                    <option value="ltc">Litecoin (LTC)</option>
                                </select>
                            </div>
                            <div class="payment-amount">К оплате: <span id="crypto-payment-amount" class="money">1 000</span> ₽</div>
                            <div class="form-group">
                                <label>Адрес для оплаты:</label>
                                <div class="form-control" style="font-family: monospace; background: rgba(0,0,0,0.3);">1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa</div>
                            </div>
                            <button type="submit" class="btn-success">Скопировать адрес</button>
                        </form>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Страница регистрации -->
    <div id="registration-page" class="page">
        <main>
            <div class="page-banner">
                <h1>Регистрация</h1>
                <p>Присоединяйтесь к нашему киберсообществу</p>
            </div>
            
            <section>
                <div class="booking-form">
                    <h3>Создать аккаунт</h3>
                    <form id="registration-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="reg-firstname">Имя</label>
                                <input type="text" id="reg-firstname" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="reg-lastname">Фамилия</label>
                                <input type="text" id="reg-lastname" class="form-control" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="reg-username">Имя пользователя</label>
                            <input type="text" id="reg-username" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="reg-email">Email</label>
                            <input type="email" id="reg-email" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="reg-phone">Телефон</label>
                            <input type="tel" id="reg-phone" class="form-control masked-input" placeholder="+7 (___) ___-__-__" required>
                        </div>
                        <div class="form-group">
                            <label for="reg-birthdate">Дата рождения</label>
                            <input type="date" id="reg-birthdate" class="form-control" max="2025-12-31" required>
                        </div>
                        <div class="form-group">
                            <label for="reg-password">Пароль</label>
                            <input type="password" id="reg-password" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="reg-confirm-password">Подтвердите пароль</label>
                            <input type="password" id="reg-confirm-password" class="form-control" required>
                        </div>
                        <!-- Выбор метода подтверждения -->
<div class="form-group">
    <label>Способ подтверждения аккаунта:</label>
    <div class="confirmation-method-selector">
        <div class="confirmation-method" data-method="email">
            <div class="confirmation-method-icon">📧</div>
            <div class="confirmation-method-info">
                <div class="confirmation-method-title">По Email</div>
                <div class="confirmation-method-desc">Код придёт на указанную почту</div>
            </div>
        </div>
        <div class="confirmation-method" data-method="phone">
            <div class="confirmation-method-icon">📱</div>
            <div class="confirmation-method-info">
                <div class="confirmation-method-title">По SMS</div>
                <div class="confirmation-method-desc">Код придёт на номер телефона</div>
            </div>
        </div>
    </div>
    <input type="hidden" id="confirmation-method" name="confirmation-method" value="email" required>
</div>

<!-- Согласие на подтверждение -->
<div class="confirmation-checkbox">
    <label class="confirmation-agreement">
        <input type="checkbox" id="confirmation-agreement" required>
        <span>
            Я согласен(на) на подтверждение аккаунта выбранным способом и принимаю 
            <a href="#" onclick="showNotification('В демо-версии правила не загружены', 'error'); return false;">
                условия использования
            </a>
        </span>
    </label>
</div>
                        <div class="form-actions">
                            <button type="button" class="btn-secondary" id="reg-cancel-btn">Отмена</button>
                            <button type="submit" class="btn">Зарегистрироваться</button>
                        </div>
                    </form>
                </div>
            </section>
        </main>
    </div>

    <!-- Страница профиля -->
    <div id="profile-page" class="page">
        <main>
            <div class="page-banner">
                <h1>Личный кабинет</h1>
                <p>Управляйте вашей учетной записью и активностью</p>
            </div>
            
            <section>
                <div class="profile-header">
                    <div class="profile-avatar" id="profile-avatar"></div>
                    <h2 id="profile-name"></h2>
                    <p id="profile-email"></p>
                </div>
                
                <div class="profile-stats">
                    <div class="stat-card">
                        <div class="stat-value" id="stat-tournaments">0</div>
                        <div class="stat-label">Турниров</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-hours">0</div>
                        <div class="stat-label">Часов игры</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-reviews">0</div>
                        <div class="stat-label">Отзывов</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-joined">2025</div>
                        <div class="stat-label">Год регистрации</div>
                    </div>
                </div>
                
                <h2>Редактировать профиль</h2>
                <div class="booking-form">
                    <form id="profile-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="profile-firstname">Имя</label>
                                <input type="text" id="profile-firstname" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="profile-lastname">Фамилия</label>
                                <input type="text" id="profile-lastname" class="form-control" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="profile-username">Имя пользователя</label>
                            <input type="text" id="profile-username" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="profile-email">Email</label>
                            <input type="email" id="profile-email" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="profile-phone">Телефон</label>
                            <input type="tel" id="profile-phone" class="form-control masked-input" placeholder="+7 (___) ___-__-__" required>
                        </div>
                        <div class="form-group">
                            <label for="profile-birthdate">Дата рождения</label>
                            <input type="date" id="profile-birthdate" class="form-control" max="2025-12-31" required>
                        </div>
                        <button type="submit" class="btn">Сохранить изменения</button>
                    </form>
                </div>
            </section>
        </main>
    </div>

    <!-- Страница админ-панели -->
    <div id="admin-page" class="page">
        <main>
            <div class="page-banner">
                <h1>Административная панель</h1>
                <p>Управление пользователями и контентом</p>
            </div>
            
            <section>
                <div class="admin-panel">
                    <div class="admin-tabs">
                        <button class="admin-tab active" data-tab="users">Пользователи</button>
                        <button class="admin-tab" data-tab="reviews">Отзывы</button>
                        <button class="admin-tab" data-tab="stats">Статистика</button>
                        <button class="admin-tab" data-tab="vk">📱 ВКонтакте</button>
                    </div>
                    
                    <div id="users-tab" class="admin-content active">
                        <h3>Управление пользователями</h3>
                        <div class="user-list" id="admin-users-list">
                            <!-- Список пользователей будет загружен динамически -->
                        </div>
                    </div>
                    
                    <div id="reviews-tab" class="admin-content">
                        <h3>Управление отзывами</h3>
                        <div class="review-list" id="admin-reviews-list">
                            <!-- Список отзывов будет загружен динамически -->
                        </div>
                    </div>
                    
                    <div id="stats-tab" class="admin-content">
                        <h3>Статистика платформы</h3>
                        <div class="profile-stats">
                            <div class="stat-card">
                                <div class="stat-value" id="admin-total-users">0</div>
                                <div class="stat-label">Всего пользователей</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="admin-total-reviews">0</div>
                                <div class="stat-label">Всего отзывов</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="admin-active-today">0</div>
                                <div class="stat-label">Активных сегодня</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="admin-new-week">0</div>
                                <div class="stat-label">Новых за неделю</div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="vk-tab" class="admin-content">
                        <h3>Управление ВКонтакте</h3>
                        <p>Публикуйте посты в вашем сообществе ВКонтакте прямо из админ-панели.</p>
                        
                        <!-- УЛУЧШЕННАЯ КНОПКА VK ДЛЯ АДМИНИСТРАТОРОВ -->
                        <div class="admin-vk-section">
                            <p>Присоединяйтесь к нашему сообществу ВКонтакте</p>
                            <a href="vk.html" class="admin-vk-button" target="_blank">
                                <span class="admin-vk-icon">👥</span>
                                Мы ВКонтакте
                                <span class="admin-vk-badge">NEW</span>
                            </a>
                        </div>
                        
                        <div class="form-actions">
                            <button class="btn" id="open-vk-modal">Открыть панель ВКонтакте</button>
                        </div>
                        
                        <div class="profile-stats" style="margin-top: 3rem;">
                            <div class="stat-card">
                                <div class="stat-value" id="vk-stats-posts">0</div>
                                <div class="stat-label">Опубликовано постов</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="vk-stats-scheduled">0</div>
                                <div class="stat-label">Запланировано</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="vk-stats-failed">0</div>
                                <div class="stat-label">Ошибок</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="vk-stats-last">-</div>
                                <div class="stat-label">Последняя публикация</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Модальное окно входа -->
    <div class="modal" id="login-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Вход в систему</h2>
                <button class="modal-close">&times;</button>
            </div>
            <form id="login-form">
                <div class="form-group">
                    <label for="login-email">Email</label>
                    <input type="email" id="login-email" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="login-password">Пароль</label>
                    <input type="password" id="login-password" class="form-control" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" id="login-cancel-btn">Отмена</button>
                    <button type="submit" class="btn">Войти</button>
                </div>
            </form>
        </div>
    </div>
<!-- Модальное окно подтверждения регистрации -->
<div class="modal confirmation-modal" id="confirmation-modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2 class="modal-title">Подтверждение регистрации</h2>
            <button class="modal-close">&times;</button>
        </div>
        
        <div class="confirmation-code-container">
            <!-- Бейдж метода подтверждения -->
            <div class="confirmation-method-badge" id="confirmation-method-badge">
                <span class="confirmation-method-icon" id="confirmation-badge-icon">📧</span>
                <span id="confirmation-badge-text">Подтверждение по Email</span>
            </div>
            
            <!-- Куда отправлен код -->
            <div class="confirmation-sent-to">
                Код подтверждения отправлен на: 
                <strong id="confirmation-target">example@email.com</strong>
            </div>
            
            <!-- Генерация кода (для демонстрации) -->
            <div class="confirmation-code" id="demo-confirmation-code">
                123456
            </div>
            
            <!-- Поле ввода кода -->
            <div class="confirmation-code-inputs" id="confirmation-inputs-container">
                <input type="text" class="confirmation-code-input" maxlength="1" data-index="0">
                <input type="text" class="confirmation-code-input" maxlength="1" data-index="1">
                <input type="text" class="confirmation-code-input" maxlength="1" data-index="2">
                <input type="text" class="confirmation-code-input" maxlength="1" data-index="3">
                <input type="text" class="confirmation-code-input" maxlength="1" data-index="4">
                <input type="text" class="confirmation-code-input" maxlength="1" data-index="5">
            </div>
            
            <!-- Таймер обратного отсчета -->
            <div class="confirmation-timer" id="confirmation-timer">
                Отправить код повторно через: <span id="timer-count">60</span> сек.
            </div>
            
            <!-- Ошибка -->
            <div class="confirmation-error" id="confirmation-error">
                Неверный код подтверждения. Пожалуйста, проверьте и попробуйте снова.
            </div>
            
            <!-- Успешное подтверждение (скрыто по умолчанию) -->
            <div class="confirmation-success" id="confirmation-success" style="display: none;">
                <div class="confirmation-success-icon">✓</div>
                <h3>Аккаунт подтвержден!</h3>
                <p>Вы успешно подтвердили ваш аккаунт. Теперь вы можете пользоваться всеми возможностями платформы.</p>
                <button class="btn-success" id="confirmation-continue-btn">Продолжить</button>
            </div>
            
            <!-- Действия -->
            <div class="confirmation-actions" id="confirmation-actions">
                <button class="btn-secondary" id="resend-code-btn" disabled>Отправить повторно</button>
                <button class="btn-success" id="verify-code-btn">Подтвердить</button>
            </div>
        </div>
    </div>
</div>
    <!-- ИСПРАВЛЕННОЕ МОДАЛЬНОЕ ОКНО ПОКУПКИ - КОМПАКТНОЕ -->
    <div class="modal purchase-modal" id="purchase-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Покупка игрового времени</h2>
                <button class="modal-close">&times;</button>
            </div>
            
            <div class="purchase-details">
                <div class="purchase-summary">
                    <div class="purchase-item" id="purchase-product-name">Товар: 5 часов</div>
                    <div class="purchase-price" id="purchase-product-price">Цена: 800 ₽</div>
                </div>
                <div class="purchase-total">
                    <div class="total-label">Итого к оплате:</div>
                    <div class="total-amount" id="purchase-total-amount">800 ₽</div>
                </div>
            </div>
            
            <form id="purchase-form">
                <div class="form-group">
                    <label for="purchase-date">Дата использования</label>
                    <input type="date" id="purchase-date" class="form-control" required>
                </div>
                
                <div class="form-group">
                    <label for="purchase-time">Время начала</label>
                    <input type="time" id="purchase-time" class="form-control" required>
                </div>
                
                <div class="form-group">
                    <label>Выберите зону:</label>
                    <div class="zone-selection">
                        <div class="zone-option" data-zone="VR Зона">
                            <div class="zone-icon">🕶️</div>
                            <div class="zone-name">VR Зона</div>
                            <div class="zone-description">Виртуальная реальность</div>
                        </div>
                        <div class="zone-option" data-zone="Игровые ПК">
                            <div class="zone-icon">🎮</div>
                            <div class="zone-name">Игровые ПК</div>
                            <div class="zone-description">Мощные компьютеры</div>
                        </div>
                        <div class="zone-option" data-zone="Турнирная зона">
                            <div class="zone-icon">🏆</div>
                            <div class="zone-name">Турнирная зона</div>
                            <div class="zone-description">Соревнования</div>
                        </div>
                        <div class="zone-option" data-zone="Комфорт зона">
                            <div class="zone-icon">🛋️</div>
                            <div class="zone-name">Комфорт зона</div>
                            <div class="zone-description">Отдых и релакс</div>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="purchase-comment">Комментарий (необязательно)</label>
                    <textarea id="purchase-comment" class="form-control" rows="3" placeholder="Особые пожелания или требования"></textarea>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn-secondary" id="purchase-cancel-btn">Отмена</button>
                    <button type="submit" class="btn-success">Подтвердить покупку</button>
                </div>
            </form>
            
            <div class="purchase-confirmation" id="purchase-confirmation">
                <h3 class="confirmation-title">Покупка успешно завершена!</h3>
                <div class="confirmation-details" id="confirmation-details">
                    <!-- Детали покупки будут добавлены динамически -->
                </div>
                <div class="form-actions">
                    <button type="button" class="btn" id="purchase-close-btn">Закрыть</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Модальное окно для управления VK -->
    <div class="modal vk-modal" id="vk-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Управление ВКонтакте</h2>
                <button class="modal-close">&times;</button>
            </div>
            
            <div class="admin-panel">
                <div class="admin-tabs">
                    <button class="admin-tab active" data-tab="vk-posts">Публикация постов</button>
                    <button class="admin-tab" data-tab="vk-stats">Статистика</button>
                    <button class="admin-tab" data-tab="vk-settings">Настройки</button>
                </div>
                
                <div id="vk-posts-tab" class="admin-content active">
                    <h3>Создать пост для ВКонтакте</h3>
                    <form id="vk-post-form">
                        <div class="form-group">
                            <label for="vk-post-text">Текст поста</label>
                            <textarea id="vk-post-text" class="form-control" rows="6" placeholder="Введите текст поста..." required></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="vk-post-image">Изображение (URL)</label>
                            <input type="url" id="vk-post-image" class="form-control" placeholder="https://example.com/image.jpg">
                        </div>
                        
                        <div class="form-group">
                            <label for="vk-post-link">Ссылка</label>
                            <input type="url" id="vk-post-link" class="form-control" placeholder="https://example.com">
                        </div>
                        
                        <div class="form-group">
                            <label for="vk-post-link-title">Заголовок ссылки</label>
                            <input type="text" id="vk-post-link-title" class="form-control" placeholder="Название ссылки">
                        </div>
                        
                        <div class="form-group">
                            <label for="vk-post-schedule">Запланировать публикацию</label>
                            <input type="datetime-local" id="vk-post-schedule" class="form-control">
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="btn-secondary" id="vk-preview-btn">Предпросмотр</button>
                            <button type="submit" class="btn-success">Опубликовать</button>
                            <button type="button" class="btn" id="vk-schedule-btn">Запланировать</button>
                        </div>
                    </form>
                    
                    <div id="vk-preview" class="vk-preview" style="display: none;">
                        <h4>Предпросмотр поста</h4>
                        <div id="vk-preview-content"></div>
                    </div>
                </div>
                
                <div id="vk-stats-tab" class="admin-content">
                    <h3>Статистика сообщества</h3>
                    <div class="profile-stats">
                        <div class="stat-card">
                            <div class="stat-value" id="vk-subscribers">0</div>
                            <div class="stat-label">Подписчиков</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="vk-posts-count">0</div>
                            <div class="stat-label">Всего постов</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="vk-engagement">0%</div>
                            <div class="stat-label">Вовлеченность</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="vk-reach">0</div>
                            <div class="stat-label">Охват</div>
                        </div>
                    </div>
                    
                    <h3 style="margin-top: 3rem;">Последние посты</h3>
                    <div id="vk-recent-posts" class="user-list">
                        <!-- Список постов будет загружен здесь -->
                    </div>
                </div>
                
                <div id="vk-settings-tab" class="admin-content">
                    <h3>Настройки ВКонтакте</h3>
                    <form id="vk-settings-form">
                        <div class="form-group">
                            <label for="vk-group-id">ID сообщества</label>
                            <input type="text" id="vk-group-id" class="form-control" placeholder="-12345678" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="vk-access-token">Access Token</label>
                            <input type="password" id="vk-access-token" class="form-control" value="vk1.a.2iirdPpmmI9I1dqxEHOHEeowx7D6XlcEkzz9jnWCB8ZDCzpQ0joviO2Md6v8i15uST4Y6Ynftqm7WM6iP5Rv44gf-fGxISWJ53pl_QXXNuanY5ILbx1idsceI9nymrQUfj9O--v_Ltz6csbIgCSmCE8btYyRng5DMxilZoEneq9weO8uzhSEX-ps5r03FqUFZxl4GMK9DUIkuo1TnvAsdg" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="vk-api-version">Версия API</label>
                            <input type="text" id="vk-api-version" class="form-control" value="5.131" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="checkbox-group">
                                <input type="checkbox" id="vk-auto-publish">
                                <span>Автоматически публиковать новые турниры</span>
                            </label>
                        </div>
                        
                        <div class="form-group">
                            <label class="checkbox-group">
                                <input type="checkbox" id="vk-publish-events">
                                <span>Публиковать мероприятия</span>
                            </label>
                        </div>
                        
                        <button type="submit" class="btn">Сохранить настройки</button>
                        <button type="button" class="btn-secondary" id="vk-test-connection">Проверить подключение</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Подтверждение выхода -->
    <div class="confirm-modal" id="logout-confirm-modal">
        <div class="confirm-content">
            <h2 class="confirm-title">Подтверждение выхода</h2>
            <p>Вы уверены, что хотите выйти из системы?</p>
            <div class="confirm-buttons">
                <button class="btn-secondary" id="logout-cancel-btn">Отмена</button>
                <button class="btn" id="logout-confirm-btn">Выйти</button>
            </div>
        </div>
    </div>

    <!-- Уведомление -->
    <div class="notification" id="notification">
        <div id="notification-message"></div>
    </div>

    <!-- Добавляем блок для отзывов -->
    <div id="reviews-container" style="display: none;">
        <div class="booking-form" id="review-form-container">
            <h3>Оставить отзыв</h3>
            <form id="add-review-form">
                <div class="form-group">
                    <label for="review-text">Ваш отзыв</label>
                    <textarea id="review-text" class="form-control" rows="4" required></textarea>
                </div>
                <button type="submit" class="btn">Отправить отзыв</button>
            </form>
        </div>
        
        <section>
            <h2>Отзывы наших клиентов</h2>
            <div class="reviews" id="reviews-list">
                <!-- Отзывы будут загружены динамически -->
            </div>
        </section>
    </div>

    <script>
       // Система пользователей и отзывов
class UserSystem {
    constructor() {
        this.users = JSON.parse(localStorage.getItem('users')) || [];
        this.reviews = JSON.parse(localStorage.getItem('reviews')) || [];
        this.currentUser = JSON.parse(localStorage.getItem('currentUser')) || null;
        this.MAX_BALANCE = 10000; // Ограничение баланса
        this.purchases = JSON.parse(localStorage.getItem('purchases')) || [];
        this.pendingConfirmations = JSON.parse(localStorage.getItem('pendingConfirmations')) || {};
        
        // Создаем админа по умолчанию если нет пользователей
        if (this.users.length === 0) {
            this.createDefaultAdmin();
        }
    }

    createDefaultAdmin() {
        const adminUser = {
            id: 1,
            firstName: 'Администратор',
            lastName: 'Системы',
            username: 'admin',
            email: 'admin@kibersfera.ru',
            password: 'admin123',
            phone: '+7 (000) 000-00-00',
            birthdate: '1990-01-01',
            role: 'admin',
            balance: 10000,
            joined: new Date().toISOString(),
            confirmed: true, // Админ уже подтвержден
            confirmedAt: new Date().toISOString(),
            confirmationMethod: 'email',
            stats: {
                tournaments: 0,
                hours: 0,
                reviews: 0
            }
        };
        this.users.push(adminUser);
        this.saveUsers();
    }

    saveUsers() {
        localStorage.setItem('users', JSON.stringify(this.users));
    }

    saveReviews() {
        localStorage.setItem('reviews', JSON.stringify(this.reviews));
    }

    savePurchases() {
        localStorage.setItem('purchases', JSON.stringify(this.purchases));
    }

    savePendingConfirmations() {
        localStorage.setItem('pendingConfirmations', JSON.stringify(this.pendingConfirmations));
    }

    generateConfirmationCode() {
        return Math.floor(100000 + Math.random() * 900000).toString(); // 6-значный код
    }

    sendConfirmationCode(email, phone, method) {
        const code = this.generateConfirmationCode();
        const expiresAt = Date.now() + 5 * 60 * 1000; // Код действует 5 минут
        
        // Сохраняем ожидаемое подтверждение
        const target = method === 'email' ? email : phone;
        this.pendingConfirmations[target] = {
            code: code,
            expiresAt: expiresAt,
            method: method,
            attempts: 0
        };
        
        this.savePendingConfirmations();
        
        // В реальном приложении здесь был бы API вызов для отправки SMS/Email
        // В демо-версии просто возвращаем код для отображения
        return {
            success: true,
            code: code,
            method: method,
            target: target
        };
    }

    verifyConfirmationCode(target, enteredCode) {
        const confirmation = this.pendingConfirmations[target];
        
        if (!confirmation) {
            return { success: false, message: 'Код подтверждения не найден' };
        }
        
        // Проверяем срок действия
        if (Date.now() > confirmation.expiresAt) {
            delete this.pendingConfirmations[target];
            this.savePendingConfirmations();
            return { success: false, message: 'Срок действия кода истек' };
        }
        
        // Увеличиваем счетчик попыток
        confirmation.attempts++;
        this.savePendingConfirmations();
        
        // Проверяем код
        if (confirmation.code === enteredCode) {
            // Успешное подтверждение
            delete this.pendingConfirmations[target];
            this.savePendingConfirmations();
            return { success: true };
        } else {
            if (confirmation.attempts >= 3) {
                // Слишком много неудачных попыток
                delete this.pendingConfirmations[target];
                this.savePendingConfirmations();
                return { 
                    success: false, 
                    message: 'Слишком много неверных попыток. Запросите новый код.' 
                };
            }
            return { 
                success: false, 
                    message: `Неверный код. Осталось попыток: ${3 - confirmation.attempts}` 
            };
        }
    }

    register(userData) {
        // Проверяем, нет ли пользователя с таким email или username
        const existingUser = this.users.find(u => 
            u.email === userData.email || u.username === userData.username
        );

        if (existingUser) {
            return { success: false, message: 'Пользователь с таким email или именем уже существует' };
        }

        // Проверяем дату рождения
        const birthYear = new Date(userData.birthdate).getFullYear();
        if (birthYear >= 2020 && birthYear <= 2025) {
            return { success: false, message: 'Не твой уровень дорогой' };
        }
        
        if (birthYear > 2025) {
            return { success: false, message: 'Год рождения не может быть больше 2025' };
        }

        // Проверяем согласие на подтверждение
        if (!userData.confirmationAgreed) {
            return { success: false, message: 'Необходимо согласие на подтверждение аккаунта' };
        }

        // Проверяем выбранный метод подтверждения
        if (!userData.confirmationMethod || !['email', 'phone'].includes(userData.confirmationMethod)) {
            return { success: false, message: 'Выберите метод подтверждения' };
        }

        const newUser = {
            id: Date.now(),
            ...userData,
            role: 'user',
            balance: 0,
            joined: new Date().toISOString(),
            confirmed: false, // Пользователь не подтвержден до верификации
            confirmedAt: null,
            confirmationMethod: userData.confirmationMethod,
            stats: {
                tournaments: 0,
                hours: Math.floor(Math.random() * 100),
                reviews: 0
            }
        };

        this.users.push(newUser);
        this.saveUsers();
        
        // Отправляем код подтверждения
        const confirmation = this.sendConfirmationCode(
            userData.email,
            userData.phone,
            userData.confirmationMethod
        );
        
        return { 
            success: true, 
            user: newUser,
            confirmation: confirmation
        };
    }

    confirmUser(userId) {
        const userIndex = this.users.findIndex(u => u.id === userId);
        if (userIndex !== -1) {
            this.users[userIndex].confirmed = true;
            this.users[userIndex].confirmedAt = new Date().toISOString();
            this.saveUsers();
            
            // Обновляем текущего пользователя если это он
            if (this.currentUser && this.currentUser.id === userId) {
                this.currentUser.confirmed = true;
                this.currentUser.confirmedAt = this.users[userIndex].confirmedAt;
                localStorage.setItem('currentUser', JSON.stringify(this.currentUser));
            }
            
            return { success: true };
        }
        return { success: false, message: 'Пользователь не найден' };
    }

    login(email, password) {
        const user = this.users.find(u => u.email === email && u.password === password);
        if (user) {
            const { password: _, ...userWithoutPassword } = user;
            this.currentUser = userWithoutPassword;
            localStorage.setItem('currentUser', JSON.stringify(userWithoutPassword));
            
            // Проверяем, подтвержден ли аккаунт
            if (!user.confirmed) {
                return { 
                    success: true, 
                    user: userWithoutPassword,
                    requiresConfirmation: true,
                    confirmationMethod: user.confirmationMethod
                };
            }
            
            return { success: true, user: userWithoutPassword, requiresConfirmation: false };
        }
        return { success: false, message: 'Неверный email или пароль' };
    }

    resendConfirmationCode(email, phone, method) {
        return this.sendConfirmationCode(email, phone, method);
    }

    // Другие методы остаются без изменений, но проверяем confirmed при выполнении действий
    addReview(text, userId) {
        // Проверяем, подтвержден ли пользователь
        const user = this.users.find(u => u.id === userId);
        if (!user || !user.confirmed) {
            return { success: false, message: 'Для добавления отзывов необходимо подтвердить аккаунт' };
        }

        const review = {
            id: Date.now(),
            userId,
            text,
            date: new Date().toISOString(),
            status: 'approved'
        };

        this.reviews.push(review);
        
        // Увеличиваем счетчик отзывов пользователя
        const userIndex = this.users.findIndex(u => u.id === userId);
        if (userIndex !== -1) {
            this.users[userIndex].stats.reviews++;
            this.saveUsers();
        }

        this.saveReviews();
        return { success: true, review: review };
    }

    deductBalance(userId, amount) {
        // Проверяем, подтвержден ли пользователь
        const user = this.users.find(u => u.id === userId);
        if (!user || !user.confirmed) {
            return { success: false, message: 'Для совершения покупок необходимо подтвердить аккаунт' };
        }

        const userIndex = this.users.findIndex(u => u.id === userId);
        if (userIndex !== -1) {
            if (this.users[userIndex].balance < amount) {
                return { success: false, message: 'Недостаточно средств' };
            }
            
            this.users[userIndex].balance -= amount;
            this.saveUsers();

            // Обновляем текущего пользователя если это он
            if (this.currentUser && this.currentUser.id === userId) {
                this.currentUser.balance = this.users[userIndex].balance;
                localStorage.setItem('currentUser', JSON.stringify(this.currentUser));
            }

            return { success: true, newBalance: this.users[userIndex].balance };
        }
        return { success: false, message: 'Пользователь не найден' };
    }

    // Обновляем остальные методы для проверки confirmed
    logout() {
        this.currentUser = null;
        localStorage.removeItem('currentUser');
    }

    updateUser(userId, userData) {
        // Проверяем дату рождения при обновлении профиля
        if (userData.birthdate) {
            const birthYear = new Date(userData.birthdate).getFullYear();
            if (birthYear >= 2020 && birthYear <= 2025) {
                return { success: false, message: 'Не твой уровень дорогой' };
            }
            
            if (birthYear > 2025) {
                return { success: false, message: 'Год рождения не может быть больше 2025' };
            }
        }

        const userIndex = this.users.findIndex(u => u.id === userId);
        if (userIndex !== -1) {
            this.users[userIndex] = { ...this.users[userIndex], ...userData };
            this.saveUsers();

            // Обновляем текущего пользователя если это он
            if (this.currentUser && this.currentUser.id === userId) {
                const { password: _, ...userWithoutPassword } = this.users[userIndex];
                this.currentUser = userWithoutPassword;
                localStorage.setItem('currentUser', JSON.stringify(userWithoutPassword));
            }

            return { success: true };
        }
        return { success: false, message: 'Пользователь не найден' };
    }

    addBalance(userId, amount) {
        const userIndex = this.users.findIndex(u => u.id === userId);
        if (userIndex !== -1) {
            const newBalance = this.users[userIndex].balance + amount;
            
            // Проверяем ограничение баланса
            if (newBalance > this.MAX_BALANCE) {
                return { 
                    success: false, 
                    message: `Превышен максимальный баланс ${formatMoney(this.MAX_BALANCE)} ₽. Текущий баланс: ${formatMoney(this.users[userIndex].balance)} ₽. Вы можете пополнить не более ${formatMoney(this.MAX_BALANCE - this.users[userIndex].balance)} ₽.` 
                };
            }
            
            this.users[userIndex].balance = newBalance;
            this.saveUsers();

            // Обновляем текущего пользователя если это он
            if (this.currentUser && this.currentUser.id === userId) {
                this.currentUser.balance = newBalance;
                localStorage.setItem('currentUser', JSON.stringify(this.currentUser));
            }

            return { success: true, newBalance: newBalance };
        }
        return { success: false, message: 'Пользователь не найден' };
    }

    addPurchase(userId, purchaseData) {
        const user = this.users.find(u => u.id === userId);
        if (!user || !user.confirmed) {
            return { success: false, message: 'Для совершения покупок необходимо подтвердить аккаунт' };
        }

        const purchase = {
            id: Date.now(),
            userId,
            ...purchaseData,
            purchaseDate: new Date().toISOString(),
            status: 'active'
        };

        this.purchases.push(purchase);
        this.savePurchases();
        return { success: true, purchase: purchase };
    }

    getUserPurchases(userId) {
        return this.purchases.filter(p => p.userId === userId);
    }

    getUserReviews(userId) {
        return this.reviews.filter(r => r.userId === userId && r.status === 'approved');
    }

    getAllReviews() {
        return this.reviews.filter(r => r.status === 'approved').map(review => {
            const user = this.users.find(u => u.id === review.userId);
            return {
                ...review,
                userName: user ? `${user.firstName} ${user.lastName}` : 'Неизвестный пользователь',
                userInitials: user ? user.firstName[0] + user.lastName[0] : '??'
            };
        });
    }

    getAllUsers() {
        return this.users.map(user => {
            const userReviews = this.getUserReviews(user.id);
            return {
                ...user,
                reviewCount: userReviews.length,
                lastActivity: userReviews.length > 0 ? 
                    userReviews[userReviews.length - 1].date : user.joined
            };
        });
    }

    isAdmin() {
        return this.currentUser && this.currentUser.role === 'admin';
    }

    isLoggedIn() {
        return this.currentUser !== null;
    }

    isConfirmed() {
        return this.currentUser && this.currentUser.confirmed === true;
    }
}

        // VK API интеграция
        class VKIntegration {
            constructor() {
                this.settings = JSON.parse(localStorage.getItem('vkSettings')) || {
                    groupId: '',
                    accessToken: 'vk1.a.2iirdPpmmI9I1dqxEHOHEeowx7D6XlcEkzz9jnWCB8ZDCzpQ0joviO2Md6v8i15uST4Y6Ynftqm7WM6iP5Rv44gf-fGxISWJ53pl_QXXNuanY5ILbx1idsceI9nymrQUfj9O--v_Ltz6csbIgCSmCE8btYyRng5DMxilZoEneq9weO8uzhSEX-ps5r03FqUFZxl4GMK9DUIkuo1TnvAsdg',
                    apiVersion: '5.131',
                    autoPublish: false,
                    publishEvents: true
                };
                this.isConnected = false;
                this.groupInfo = null;
                this.posts = JSON.parse(localStorage.getItem('vkPosts')) || [];
                this.stats = JSON.parse(localStorage.getItem('vkStats')) || {
                    published: 0,
                    scheduled: 0,
                    failed: 0,
                    lastPost: null
                };
            }

            saveSettings() {
                localStorage.setItem('vkSettings', JSON.stringify(this.settings));
            }

            savePosts() {
                localStorage.setItem('vkPosts', JSON.stringify(this.posts));
            }

            saveStats() {
                localStorage.setItem('vkStats', JSON.stringify(this.stats));
            }

            async testConnection() {
                try {
                    if (!this.settings.groupId || !this.settings.accessToken) {
                        throw new Error('Заполните ID сообщества и Access Token');
                    }

                    // Эмуляция проверки подключения (в реальном приложении здесь будет запрос к VK API)
                    // В демо-версии просто имитируем успешное подключение
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                    this.groupInfo = {
                        name: 'КиберСфера - Киберспортивный клуб',
                        members_count: 1250,
                        description: 'Лучший киберспортивный клуб в городе! Турниры, игровые зоны, VR и многое другое.'
                    };
                    
                    this.isConnected = true;
                    return {
                        success: true,
                        group: this.groupInfo
                    };
                } catch (error) {
                    console.error('VK Connection Error:', error);
                    return {
                        success: false,
                        error: error.message
                    };
                }
            }

            async makeVKRequest(method, params = {}) {
                // Эмуляция запроса к VK API
                // В реальном приложении здесь будет fetch запрос к VK API
                console.log(`VK API Request: ${method}`, params);
                
                // Имитация задержки сети
                await new Promise(resolve => setTimeout(resolve, 800));
                
                // В демо-версии всегда возвращаем успешный результат
                return { success: true, post_id: Math.floor(Math.random() * 10000) };
            }

            async publishPost(postData) {
                try {
                    if (!this.isConnected) {
                        throw new Error('Сначала подключитесь к ВКонтакте');
                    }

                    const result = await this.makeVKRequest('wall.post', {
                        owner_id: this.settings.groupId,
                        from_group: 1,
                        message: postData.text,
                        attachments: postData.image || postData.link ? `${postData.image || ''},${postData.link || ''}` : undefined,
                        publish_date: postData.publishDate ? Math.floor(new Date(postData.publishDate).getTime() / 1000) : undefined
                    });

                    if (result.success) {
                        const post = {
                            id: result.post_id,
                            text: postData.text,
                            image: postData.image,
                            link: postData.link,
                            publishDate: postData.publishDate || new Date().toISOString(),
                            status: postData.publishDate ? 'scheduled' : 'published',
                            timestamp: new Date().toISOString()
                        };

                        this.posts.push(post);
                        
                        if (postData.publishDate) {
                            this.stats.scheduled++;
                        } else {
                            this.stats.published++;
                        }
                        
                        this.stats.lastPost = new Date().toISOString();
                        
                        this.savePosts();
                        this.saveStats();
                        
                        return {
                            success: true,
                            postId: result.post_id
                        };
                    } else {
                        this.stats.failed++;
                        this.saveStats();
                        throw new Error('Не удалось опубликовать пост');
                    }
                } catch (error) {
                    console.error('VK Publish Error:', error);
                    this.stats.failed++;
                    this.saveStats();
                    return {
                        success: false,
                        error: error.message
                    };
                }
            }

            async getGroupStats() {
                if (!this.isConnected) {
                    return {
                        subscribers: 0,
                        postsCount: 0,
                        recentPosts: []
                    };
                }

                // Эмуляция получения статистики
                return {
                    subscribers: this.groupInfo.members_count,
                    postsCount: this.posts.length,
                    recentPosts: this.posts.slice(-5).reverse()
                };
            }

            getVKStats() {
                return this.stats;
            }

            // ИСПРАВЛЕННЫЙ МЕТОД ДЛЯ ЗАГРУЗКИ НОВОСТЕЙ ИЗ ВК - ТЕПЕРЬ ИСПОЛЬЗУЕМ ДЕМО-ДАННЫЕ
            async loadNews() {
                try {
                    // Имитируем задержку сети для реалистичности
                    await new Promise(resolve => setTimeout(resolve, 1500));
                    
                    // Демо-данные новостей вместо реальных запросов к VK API
                    const demoNews = {
                        response: {
                            items: [
                                {
                                    date: Math.floor(Date.now() / 1000) - 86400,
                                    text: "🎮 Турнир по Counter-Strike 2 уже на этой неделе! Призовой фонд 50 000 ₽. Успейте зарегистрироваться!",
                                    attachments: null,
                                    likes: { count: 42 },
                                    comments: { count: 12 },
                                    reposts: { count: 5 }
                                },
                                {
                                    date: Math.floor(Date.now() / 1000) - 172800,
                                    text: "Мы обновили наш парк игровых ПК! Теперь все компьютеры оснащены RTX 4080 и процессорами Intel i9 13-го поколения.",
                                    attachments: {
                                        type: 'photo',
                                        photo: {
                                            sizes: [
                                                { 
                                                    type: 'm', 
                                                    url: 'https://via.placeholder.com/600x400/00f3ff/0a0a12?text=Gaming+PC+RTX+4080' 
                                                }
                                            ]
                                        }
                                    },
                                    likes: { count: 78 },
                                    comments: { count: 25 },
                                    reposts: { count: 10 }
                                },
                                {
                                    date: Math.floor(Date.now() / 1000) - 259200,
                                    text: "Новая VR зона теперь доступна! Испытайте виртуальную реальность на оборудовании Oculus Quest 2.",
                                    attachments: null,
                                    likes: { count: 56 },
                                    comments: { count: 18 },
                                    reposts: { count: 7 }
                                },
                                {
                                    date: Math.floor(Date.now() / 1000) - 345600,
                                    text: "Специальное предложение для студентов: скидка 20% на игровое время по будням с 12:00 до 17:00.",
                                    attachments: null,
                                    likes: { count: 34 },
                                    comments: { count: 8 },
                                    reposts: { count: 3 }
                                }
                            ]
                        }
                    };

                    return {
                        success: true,
                        posts: demoNews.response.items
                    };
                } catch (error) {
                    console.error('VK News Error:', error);
                    return {
                        success: false,
                        error: 'Не удалось загрузить новости. Пожалуйста, попробуйте позже.'
                    };
                }
            }
        }

        // Инициализация систем
        const userSystem = new UserSystem();
        const vkIntegration = new VKIntegration();

        // DOM элементы
        const elements = {
            preloader: document.getElementById('preloader'),
            authButtons: document.getElementById('auth-buttons'),
            userMenu: document.getElementById('user-menu'),
            userAvatar: document.getElementById('user-avatar'),
            userBalance: document.getElementById('user-balance-amount'),
            userAvatarBalance: document.getElementById('user-avatar-balance'),
            adminLink: document.getElementById('admin-link'),
            loginModal: document.getElementById('login-modal'),
            purchaseModal: document.getElementById('purchase-modal'),
            vkModal: document.getElementById('vk-modal'),
            logoutConfirmModal: document.getElementById('logout-confirm-modal'),
            notification: document.getElementById('notification'),
            reviewFormContainer: document.getElementById('review-form-container'),
            reviewsList: document.getElementById('reviews-list'),
            settingsBtn: document.getElementById('settings-btn'),
            settingsDropdown: document.getElementById('settings-dropdown'),
            settingsBtnUser: document.getElementById('settings-btn-user'),
            settingsDropdownUser: document.getElementById('settings-dropdown-user'),
            themeSwitch: document.getElementById('theme-switch'),
            themeSwitchUser: document.getElementById('theme-switch-user'),
            balanceAmount: document.getElementById('balance-amount'),
            adminVkFooter: document.getElementById('admin-vk-footer'),
            // Мобильные элементы
            burgerMenu: document.getElementById('burger-menu'),
            mobileNav: document.getElementById('mobile-nav'),
            mobileOverlay: document.getElementById('mobile-overlay'),
            mobileUserSection: document.getElementById('mobile-user-section'),
            mobileAuthButtons: document.getElementById('mobile-auth-buttons'),
            mobileLoginBtn: document.getElementById('mobile-login-btn'),
            mobileRegisterBtn: document.getElementById('mobile-register-btn'),
            // Новые элементы для новостей
            newsContainer: document.getElementById('news-container'),
            refreshNewsBtn: document.getElementById('refresh-news')
        };

        // Утилиты для форматирования денег
        function formatMoney(amount) {
            return new Intl.NumberFormat('ru-RU', {
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(amount);
        }

        function parseMoney(formattedAmount) {
            return parseInt(formattedAmount.replace(/\s/g, ''));
        }

        // Утилиты для масок ввода
        function applyPhoneMask(input) {
            input.addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                
                if (value.startsWith('7') || value.startsWith('8')) {
                    value = value.substring(1);
                }
                
                let formattedValue = '+7';
                
                if (value.length > 0) {
                    formattedValue += ' (' + value.substring(0, 3);
                }
                if (value.length > 3) {
                    formattedValue += ') ' + value.substring(3, 6);
                }
                if (value.length > 6) {
                    formattedValue += '-' + value.substring(6, 8);
                }
                if (value.length > 8) {
                    formattedValue += '-' + value.substring(8, 10);
                }
                
                e.target.value = formattedValue;
            });
        }

        function applyCardNumberMask(input) {
            input.addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                let formattedValue = '';
                
                for (let i = 0; i < value.length; i++) {
                    if (i > 0 && i % 4 === 0) {
                        formattedValue += ' ';
                    }
                    formattedValue += value[i];
                }
                
                e.target.value = formattedValue.substring(0, 19); // 16 цифр + 3 пробела
            });
        }

        function applyCardExpiryMask(input) {
            input.addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                
                if (value.length > 2) {
                    value = value.substring(0, 2) + '/' + value.substring(2, 4);
                }
                
                e.target.value = value.substring(0, 5);
            });
        }

        function applyCVCMask(input) {
            input.addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                e.target.value = value.substring(0, 3);
            });
        }

        function applyMoneyMask(input) {
            input.addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                
                if (value === '') {
                    e.target.value = '';
                    return;
                }
                
                let numericValue = parseInt(value);
                if (isNaN(numericValue)) {
                    e.target.value = '';
                    return;
                }
                
                e.target.value = formatMoney(numericValue);
                
                // Обновляем связанные элементы с суммой платежа
                const form = e.target.closest('form');
                if (form) {
                    const amountElement = form.querySelector('.payment-amount span');
                    if (amountElement) {
                        amountElement.textContent = formatMoney(numericValue);
                    }
                }
            });
        }

        // Инициализация масок
        function initMasks() {
            // Телефоны
            const phoneInputs = document.querySelectorAll('input[type="tel"]');
            phoneInputs.forEach(input => {
                applyPhoneMask(input);
            });

            // Номера карт
            const cardNumberInputs = document.querySelectorAll('input#card-number');
            cardNumberInputs.forEach(input => {
                applyCardNumberMask(input);
            });

            // Срок действия карт
            const cardExpiryInputs = document.querySelectorAll('input#card-expiry');
            cardExpiryInputs.forEach(input => {
                applyCardExpiryMask(input);
            });

            // CVC
            const cvcInputs = document.querySelectorAll('input#card-cvc');
            cvcInputs.forEach(input => {
                applyCVCMask(input);
            });

            // Денежные суммы
            const moneyInputs = document.querySelectorAll('input.money');
            moneyInputs.forEach(input => {
                applyMoneyMask(input);
            });
        }

        // Утилиты
        function showNotification(message, type = '') {
            const notificationMessage = document.getElementById('notification-message');
            notificationMessage.textContent = message;
            elements.notification.className = 'notification';
            if (type) {
                elements.notification.classList.add(type);
            }
            elements.notification.classList.add('show');
            
            setTimeout(() => {
                elements.notification.classList.remove('show');
            }, 5000);
        }

        function updateAuthUI() {
            if (userSystem.isLoggedIn()) {
                elements.authButtons.style.display = 'none';
                elements.userMenu.style.display = 'flex';
                elements.userAvatar.textContent = 
                    userSystem.currentUser.firstName[0] + userSystem.currentUser.lastName[0];
                
                // Обновляем баланс в объединенной кнопке
                if (elements.userBalance) {
                    elements.userBalance.textContent = formatMoney(userSystem.currentUser.balance);
                }
                
                if (userSystem.isAdmin()) {
                    elements.adminLink.style.display = 'block';
                    // Показываем кнопку VK для админов
                    if (elements.adminVkFooter) {
                        elements.adminVkFooter.style.display = 'block';
                    }
                } else {
                    // Скрываем кнопку VK для не-админов
                    if (elements.adminVkFooter) {
                        elements.adminVkFooter.style.display = 'none';
                    }
                }

                // Показываем форму отзывов если пользователь авторизован
                if (elements.reviewFormContainer) {
                    elements.reviewFormContainer.style.display = 'block';
                }
                
                // Обновляем баланс на странице баланса
                if (elements.balanceAmount) {
                    elements.balanceAmount.textContent = formatMoney(userSystem.currentUser.balance) + ' ₽';
                }

                // Обновляем мобильное меню для авторизованного пользователя
                updateMobileMenu();
            } else {
                elements.authButtons.style.display = 'flex';
                elements.userMenu.style.display = 'none';
                elements.adminLink.style.display = 'none';

                // Скрываем кнопку VK для неавторизованных пользователей
                if (elements.adminVkFooter) {
                    elements.adminVkFooter.style.display = 'none';
                }

                // Скрываем форму отзывов
                if (elements.reviewFormContainer) {
                    elements.reviewFormContainer.style.display = 'none';
                }

                // Обновляем мобильное меню для неавторизованного пользователя
                updateMobileMenu();
            }
            loadReviews();
        }

        // Обновление мобильного меню
        // Обновите функцию updateMobileMenu
function updateMobileMenu() {
    if (!elements.mobileUserSection) return;
    
    if (userSystem.isLoggedIn()) {
        elements.mobileUserSection.innerHTML = `
            <div class="user-avatar-with-balance" style="margin: 1rem 0;">
                <div class="user-avatar">${userSystem.currentUser.firstName[0] + userSystem.currentUser.lastName[0]}</div>
                <div class="user-balance">Баланс: ${formatMoney(userSystem.currentUser.balance)} ₽</div>
            </div>
            <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                <a href="#" class="nav-link" data-page="profile" style="text-align: center;">Кабинет</a>
                ${userSystem.isAdmin() ? '<a href="#" class="nav-link" data-page="admin" style="text-align: center;">Админ</a>' : ''}
                <a href="#" class="nav-link" id="mobile-logout-btn" style="text-align: center;">Выйти</a>
            </div>
        `;
        elements.mobileAuthButtons.style.display = 'none';
        elements.mobileUserSection.style.display = 'block';
    } else {
        elements.mobileUserSection.style.display = 'none';
        elements.mobileAuthButtons.style.display = 'flex';
    }
}
        function updateMobileMenu() {
            if (userSystem.isLoggedIn()) {
                // Показываем секцию пользователя в мобильном меню
                elements.mobileUserSection.innerHTML = `
                    <div class="user-avatar-with-balance">
                        <div class="user-avatar">${userSystem.currentUser.firstName[0] + userSystem.currentUser.lastName[0]}</div>
                        <div class="user-balance">Баланс: ${formatMoney(userSystem.currentUser.balance)} ₽</div>
                    </div>
                    <a href="#" class="nav-link" data-page="profile">Кабинет</a>
                    ${userSystem.isAdmin() ? '<a href="#" class="nav-link" data-page="admin">Админ</a>' : ''}
                    <a href="#" class="nav-link" id="mobile-logout-btn">Выйти</a>
                `;
                elements.mobileAuthButtons.style.display = 'none';
                elements.mobileUserSection.style.display = 'block';

                // Добавляем обработчик для выхода в мобильном меню
                document.getElementById('mobile-logout-btn').addEventListener('click', function(e) {
                    e.preventDefault();
                    closeMobileMenu();
                    elements.logoutConfirmModal.classList.add('active');
                });
            } else {
                // Показываем кнопки авторизации в мобильном меню
                elements.mobileUserSection.style.display = 'none';
                elements.mobileAuthButtons.style.display = 'flex';
            }
        }

        // Функции для работы с мобильным меню
        function openMobileMenu() {
            elements.mobileNav.classList.add('active');
            elements.mobileOverlay.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeMobileMenu() {
            elements.mobileNav.classList.remove('active');
            elements.mobileOverlay.classList.remove('active');
            elements.burgerMenu.classList.remove('active');
            document.body.style.overflow = '';
        }

        function loadReviews() {
            if (!elements.reviewsList) return;
            
            const reviews = userSystem.getAllReviews();
            elements.reviewsList.innerHTML = '';

            if (reviews.length === 0) {
                elements.reviewsList.innerHTML = '<p style="text-align: center; color: var(--text-secondary);">Пока нет отзывов. Будьте первым!</p>';
                return;
            }

            reviews.forEach(review => {
                const reviewElement = document.createElement('div');
                reviewElement.className = 'review-card';
                reviewElement.innerHTML = `
                    <div class="review-text">${review.text}</div>
                    <div class="review-author">– ${review.userName}</div>
                    ${userSystem.isAdmin() ? `
                        <div class="review-actions">
                            <button class="btn-danger btn-sm" onclick="deleteReview(${review.id})">Удалить</button>
                        </div>
                    ` : ''}
                `;
                elements.reviewsList.appendChild(reviewElement);
            });
            
        }


        function loadUserReviews() {
            const userReviewsList = document.getElementById('user-reviews-list');
            if (!userReviewsList || !userSystem.currentUser) return;

            const reviews = userSystem.getUserReviews(userSystem.currentUser.id);
            userReviewsList.innerHTML = '';

            if (reviews.length === 0) {
                userReviewsList.innerHTML = '<p style="text-align: center; color: var(--text-secondary);">Вы еще не оставляли отзывов.</p>';
                return;
            }

            reviews.forEach(review => {
                const reviewElement = document.createElement('div');
                reviewElement.className = 'review-card';
                reviewElement.innerHTML = `
                    <div class="review-text">${review.text}</div>
                    <div class="review-author">– ${new Date(review.date).toLocaleDateString()}</div>
                    <div class="review-actions">
                        <button class="btn-danger btn-sm" onclick="deleteUserReview(${review.id})">Удалить</button>
                    </div>
                `;
                userReviewsList.appendChild(reviewElement);
            });
        }

        function loadAdminUsers() {
            const usersList = document.getElementById('admin-users-list');
            if (!usersList) return;

            const users = userSystem.getAllUsers();
            usersList.innerHTML = '';

            users.forEach(user => {
                const userElement = document.createElement('div');
                userElement.className = 'user-item';
                userElement.innerHTML = `
                    <div class="user-info">
                        <div class="user-name">${user.firstName} ${user.lastName} (${user.username})</div>
                        <div class="user-email">${user.email} • ${user.role} • Отзывов: ${user.reviewCount} • Баланс: ${formatMoney(user.balance)} ₽</div>
                    </div>
                    <div class="admin-actions">
                        ${user.role !== 'admin' ? `
                            <button class="btn-danger btn-sm" onclick="deleteUser(${user.id})">Удалить</button>
                        ` : '<span style="color: var(--neon-cyan);">Админ</span>'}
                    </div>
                `;
                usersList.appendChild(userElement);
            });

            // Обновляем статистику
            document.getElementById('admin-total-users').textContent = users.length;
            document.getElementById('admin-total-reviews').textContent = userSystem.reviews.length;
            document.getElementById('admin-active-today').textContent = users.filter(u => 
                new Date(u.lastActivity).toDateString() === new Date().toDateString()
            ).length;
            document.getElementById('admin-new-week').textContent = users.filter(u => 
                new Date(u.joined) > new Date(Date.now() - 7 * 24 * 60 * 60 * 1000)
            ).length;
        }

        function loadProfileData() {
            if (!userSystem.currentUser) return;

            const user = userSystem.currentUser;
            document.getElementById('profile-avatar').textContent = 
                user.firstName[0] + user.lastName[0];
            document.getElementById('profile-name').textContent = 
                `${user.firstName} ${user.lastName} (@${user.username})`;
            document.getElementById('profile-email').textContent = user.email;

            // Заполняем форму
            document.getElementById('profile-firstname').value = user.firstName;
            document.getElementById('profile-lastname').value = user.lastName;
            document.getElementById('profile-username').value = user.username;
            document.getElementById('profile-email').value = user.email;
            document.getElementById('profile-phone').value = user.phone;
            document.getElementById('profile-birthdate').value = user.birthdate;

            // Обновляем статистику
            document.getElementById('stat-tournaments').textContent = user.stats.tournaments;
            document.getElementById('stat-hours').textContent = user.stats.hours;
            document.getElementById('stat-reviews').textContent = user.stats.reviews;
            document.getElementById('stat-joined').textContent = new Date(user.joined).getFullYear();

            loadUserReviews();
        }

        // ИСПРАВЛЕННАЯ ФУНКЦИЯ ДЛЯ ЗАГРУЗКИ НОВОСТЕЙ ИЗ ВК
        async function loadVKNews() {
            if (!elements.newsContainer) return;
            
            // Показываем индикатор загрузки
            elements.newsContainer.innerHTML = `
                <div class="news-loading">
                    <h3>Загрузка новостей...</h3>
                    <p>Пожалуйста, подождите, новости загружаются из ВКонтакте</p>
                </div>
            `;

            try {
                const result = await vkIntegration.loadNews();
                
                if (result.success) {
                    displayNews(result.posts);
                } else {
                    throw new Error(result.error);
                }
            } catch (error) {
                console.error('Ошибка загрузки новостей:', error);
                elements.newsContainer.innerHTML = `
                    <div class="news-error">
                        <h3>Ошибка загрузки новостей</h3>
                        <p>${error.message}</p>
                        <p>Попробуйте обновить страницу позже</p>
                    </div>
                `;
            }
        }

        // ФУНКЦИЯ ДЛЯ ОТОБРАЖЕНИЯ НОВОСТЕЙ
        function displayNews(posts) {
            if (!elements.newsContainer) return;
            
            if (!posts || posts.length === 0) {
                elements.newsContainer.innerHTML = '<p style="text-align: center; color: var(--text-secondary);">Новости не найдены.</p>';
                return;
            }

            elements.newsContainer.innerHTML = '';

            posts.forEach(post => {
                const postElement = document.createElement('div');
                postElement.className = 'news-post';

                // Форматируем дату
                const postDate = new Date(post.date * 1000).toLocaleDateString('ru-RU', {
                    day: 'numeric',
                    month: 'long',
                    year: 'numeric'
                });

                // Обрабатываем текст (заменяем переносы на <br>)
                const postText = post.text ? post.text.replace(/\n/g, '<br>') : '';

                // Обрабатываем вложения (ищем фото)
                let photoHtml = '';
                if (post.attachments && post.attachments.type === 'photo' && post.attachments.photo) {
                    const photoUrl = post.attachments.photo.sizes.find(size => size.type === 'm')?.url;
                    if (photoUrl) {
                        photoHtml = `<img src="${photoUrl}" alt="Изображение" class="news-image" onerror="this.style.display='none'">`;
                    }
                }

                // Статистика
                const likes = post.likes ? post.likes.count : 0;
                const comments = post.comments ? post.comments.count : 0;
                const reposts = post.reposts ? post.reposts.count : 0;

                postElement.innerHTML = `
                    <div class="news-post-header">
                        <div class="news-post-date">${postDate}</div>
                        <div class="news-post-stats">
                            <span class="news-stat">❤️ ${likes}</span>
                            <span class="news-stat">💬 ${comments}</span>
                            <span class="news-stat">↩️ ${reposts}</span>
                        </div>
                    </div>
                    <div class="news-post-content">
                        ${postText ? `<div class="news-text">${postText}</div>` : ''}
                        ${photoHtml}
                    </div>
                `;

                elements.newsContainer.appendChild(postElement);
            });
        }

        // Настройки темы
        function initSettings() {
            // Загружаем настройки из localStorage
            const isLightTheme = localStorage.getItem('lightTheme') === 'true';
            
            // Применяем настройки
            if (isLightTheme) {
                document.body.classList.add('light-theme');
                elements.themeSwitch.checked = true;
                if (elements.themeSwitchUser) elements.themeSwitchUser.checked = true;
            }
            
            // Обработчики для переключателей темы
            elements.themeSwitch.addEventListener('change', function() {
                toggleTheme(this.checked);
                if (elements.themeSwitchUser) elements.themeSwitchUser.checked = this.checked;
            });
            
            if (elements.themeSwitchUser) {
                elements.themeSwitchUser.addEventListener('change', function() {
                    toggleTheme(this.checked);
                    elements.themeSwitch.checked = this.checked;
                });
            }
        }

        function toggleTheme(isLight) {
            if (isLight) {
                document.body.classList.add('light-theme');
                localStorage.setItem('lightTheme', 'true');
            } else {
                document.body.classList.remove('light-theme');
                localStorage.setItem('lightTheme', 'false');
            }
        }

        // Инициализация VK интеграции
        function initVKIntegration() {
            // Загружаем настройки в форму
            document.getElementById('vk-group-id').value = vkIntegration.settings.groupId;
            document.getElementById('vk-access-token').value = vkIntegration.settings.accessToken;
            document.getElementById('vk-api-version').value = vkIntegration.settings.apiVersion;
            document.getElementById('vk-auto-publish').checked = vkIntegration.settings.autoPublish;
            document.getElementById('vk-publish-events').checked = vkIntegration.settings.publishEvents;

            // Обновляем статистику VK
            updateVKStats();

            // Обработчики событий для VK
            document.getElementById('vk-settings-form').addEventListener('submit', function(e) {
                e.preventDefault();
                saveVKSettings();
            });

            document.getElementById('vk-test-connection').addEventListener('click', testVKConnection);
            document.getElementById('vk-post-form').addEventListener('submit', function(e) {
                e.preventDefault();
                publishVKPost();
            });

            document.getElementById('vk-preview-btn').addEventListener('click', previewVKPost);
            document.getElementById('vk-schedule-btn').addEventListener('click', scheduleVKPost);

            // Обработчики для VK табов в модальном окне
            document.querySelectorAll('#vk-modal .admin-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    
                    document.querySelectorAll('#vk-modal .admin-tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    document.querySelectorAll('#vk-modal .admin-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    document.getElementById(`${tabName}-tab`).classList.add('active');

                    if (tabName === 'vk-stats') {
                        loadVKStats();
                    }
                });
            });

            // Кнопка открытия VK модального окна
            document.getElementById('open-vk-modal').addEventListener('click', function() {
                elements.vkModal.classList.add('active');
            });

            // Кнопка обновления новостей
            if (elements.refreshNewsBtn) {
                elements.refreshNewsBtn.addEventListener('click', loadVKNews);
            }
        }

        function saveVKSettings() {
            vkIntegration.settings.groupId = document.getElementById('vk-group-id').value;
            vkIntegration.settings.accessToken = document.getElementById('vk-access-token').value;
            vkIntegration.settings.apiVersion = document.getElementById('vk-api-version').value;
            vkIntegration.settings.autoPublish = document.getElementById('vk-auto-publish').checked;
            vkIntegration.settings.publishEvents = document.getElementById('vk-publish-events').checked;
            
            vkIntegration.saveSettings();
            showNotification('Настройки ВКонтакте сохранены!', 'success');
        }

        async function testVKConnection() {
            const testBtn = document.getElementById('vk-test-connection');
            const originalText = testBtn.textContent;
            
            testBtn.textContent = 'Проверка...';
            testBtn.disabled = true;

            const result = await vkIntegration.testConnection();
            
            testBtn.textContent = originalText;
            testBtn.disabled = false;

            if (result.success) {
                showNotification(`Успешное подключение к сообществу "${result.group.name}"!`, 'success');
            } else {
                showNotification(`Ошибка подключения: ${result.error}`, 'error');
            }
        }

        function previewVKPost() {
            const text = document.getElementById('vk-post-text').value;
            const image = document.getElementById('vk-post-image').value;
            const link = document.getElementById('vk-post-link').value;
            const linkTitle = document.getElementById('vk-post-link-title').value;

            let previewHTML = '';
            
            if (text) {
                previewHTML += `<div class="vk-preview-text">${text.replace(/\n/g, '<br>')}</div>`;
            }
            
            if (image) {
                previewHTML += `<img src="${image}" alt="Preview" class="vk-preview-image" onerror="this.style.display='none'">`;
            }
            
            if (link && linkTitle) {
                previewHTML += `<a href="${link}" class="vk-preview-link" target="_blank">${linkTitle}</a>`;
            }

            const previewContainer = document.getElementById('vk-preview-content');
            const previewSection = document.getElementById('vk-preview');
            
            if (previewHTML) {
                previewContainer.innerHTML = previewHTML;
                previewSection.style.display = 'block';
            } else {
                previewSection.style.display = 'none';
                showNotification('Заполните хотя бы текст поста для предпросмотра', 'error');
            }
        }

        async function publishVKPost() {
            const text = document.getElementById('vk-post-text').value;
            if (!text.trim()) {
                showNotification('Введите текст поста', 'error');
                return;
            }

            const postData = {
                text: text,
                image: document.getElementById('vk-post-image').value,
                link: document.getElementById('vk-post-link').value
            };

            const result = await vkIntegration.publishPost(postData);
            
            if (result.success) {
                showNotification('Пост успешно опубликован в ВКонтакте!', 'success');
                document.getElementById('vk-post-form').reset();
                document.getElementById('vk-preview').style.display = 'none';
                updateVKStats();
                loadVKStats();
            } else {
                showNotification(`Ошибка публикации: ${result.error}`, 'error');
            }
        }

        async function scheduleVKPost() {
            const text = document.getElementById('vk-post-text').value;
            const scheduleDate = document.getElementById('vk-post-schedule').value;
            
            if (!text.trim()) {
                showNotification('Введите текст поста', 'error');
                return;
            }

            if (!scheduleDate) {
                showNotification('Выберите дату и время публикации', 'error');
                return;
            }

            const postData = {
                text: text,
                image: document.getElementById('vk-post-image').value,
                link: document.getElementById('vk-post-link').value,
                publishDate: scheduleDate
            };

            const result = await vkIntegration.publishPost(postData);
            
            if (result.success) {
                showNotification('Пост успешно запланирован в ВКонтакте!', 'success');
                document.getElementById('vk-post-form').reset();
                document.getElementById('vk-preview').style.display = 'none';
                updateVKStats();
                loadVKStats();
            } else {
                showNotification(`Ошибка планирования: ${result.error}`, 'error');
            }
        }

        async function loadVKStats() {
            const stats = await vkIntegration.getGroupStats();
            
            // Обновляем основную статистику
            document.getElementById('vk-subscribers').textContent = formatMoney(stats.subscribers);
            document.getElementById('vk-posts-count').textContent = formatMoney(stats.postsCount);
            
            // Рассчитываем вовлеченность (примерная формула)
            const engagement = stats.subscribers > 0 ? Math.min(100, Math.floor((stats.subscribers * 0.1) / 100 * 100)) : 0;
            document.getElementById('vk-engagement').textContent = engagement + '%';
            
            // Охват (примерный расчет)
            const reach = Math.floor(stats.subscribers * 1.5);
            document.getElementById('vk-reach').textContent = formatMoney(reach);

            // Обновляем список постов
            const postsContainer = document.getElementById('vk-recent-posts');
            postsContainer.innerHTML = '';

            if (stats.recentPosts.length === 0) {
                postsContainer.innerHTML = '<p style="text-align: center; color: var(--text-secondary);">Нет опубликованных постов</p>';
                return;
            }

            stats.recentPosts.forEach(post => {
                const postElement = document.createElement('div');
                postElement.className = 'vk-post-item';
                
                const postDate = new Date(post.publishDate).toLocaleDateString('ru-RU');
                const postText = post.text ? (post.text.length > 100 ? post.text.substring(0, 100) + '...' : post.text) : 'Пост с вложениями';
                
                postElement.innerHTML = `
                    <div class="vk-post-date">${postDate} • ${post.status === 'scheduled' ? 'Запланирован' : 'Опубликован'}</div>
                    <div class="vk-post-text">${postText}</div>
                `;
                
                postsContainer.appendChild(postElement);
            });
        }

        function updateVKStats() {
            const stats = vkIntegration.getVKStats();
            document.getElementById('vk-stats-posts').textContent = stats.published;
            document.getElementById('vk-stats-scheduled').textContent = stats.scheduled;
            document.getElementById('vk-stats-failed').textContent = stats.failed;
            document.getElementById('vk-stats-last').textContent = stats.lastPost ? 
                new Date(stats.lastPost).toLocaleDateString('ru-RU') : '-';
        }

        // Глобальные функции для обработчиков событий
        window.deleteReview = function(reviewId) {
            if (userSystem.deleteReview(reviewId)) {
                showNotification('Отзыв удален', 'success');
                loadReviews();
                if (document.getElementById('admin-page').classList.contains('active')) {
                    loadAdminUsers();
                }
            }
        };

        window.deleteUserReview = function(reviewId) {
            if (userSystem.deleteReview(reviewId)) {
                showNotification('Ваш отзыв удален', 'success');
                loadUserReviews();
                loadProfileData();
            }
        };

        window.deleteUser = function(userId) {
            if (confirm('Вы уверены, что хотите удалить этого пользователя?')) {
                const userIndex = userSystem.users.findIndex(u => u.id === userId);
                if (userIndex !== -1) {
                    // Удаляем отзывы пользователя
                    userSystem.reviews = userSystem.reviews.filter(r => r.userId !== userId);
                    userSystem.saveReviews();

                    // Удаляем пользователя
                    userSystem.users.splice(userIndex, 1);
                    userSystem.saveUsers();

                    showNotification('Пользователь удален', 'success');
                    loadAdminUsers();
                }
            }
        };

        // Анимация счетчиков на главной странице
        function animateCounter(element, target, duration = 2000) {
            let start = 0;
            const increment = target / (duration / 16);
            const timer = setInterval(() => {
                start += increment;
                if (start >= target) {
                    element.textContent = target;
                    clearInterval(timer);
                } else {
                    element.textContent = Math.floor(start);
                }
            }, 16);
        }

        // Обработчики событий
        document.addEventListener('DOMContentLoaded', function() {
            // Инициализация прелоадера
            const loadingProgress = document.getElementById('loading-progress');
            let progress = 0;
            
            const loadingInterval = setInterval(() => {
                progress += Math.random() * 12;
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(loadingInterval);
                    
                    setTimeout(() => {
                        loadingProgress.style.width = '100%';
                        
                        setTimeout(() => {
                            elements.preloader.classList.add('hidden');
                            updateAuthUI();
                            initSettings();
                            initMasks();
                            initVKIntegration();
                            
                            // Запускаем анимацию счетчиков на главной странице
                            if (document.getElementById('main-page').classList.contains('active')) {
                                setTimeout(() => {
                                    document.querySelectorAll('.stat').forEach(stat => {
                                        const valueElement = stat.querySelector('.stat-value');
                                        const target = parseInt(stat.getAttribute('data-value'));
                                        animateCounter(valueElement, target);
                                    });
                                }, 500);
                            }
                        }, 800);
                    }, 500);
                }
                loadingProgress.style.width = `${progress}%`;
            }, 200);

            // Мобильное меню
            elements.burgerMenu.addEventListener('click', function() {
                this.classList.toggle('active');
                if (this.classList.contains('active')) {
                    openMobileMenu();
                } else {
                    closeMobileMenu();
                }
            });

            elements.mobileOverlay.addEventListener('click', closeMobileMenu);

            // Закрытие мобильного меню при клике на ссылку
            document.querySelectorAll('.mobile-nav a').forEach(link => {
                link.addEventListener('click', function(e) {
                    if (this.getAttribute('data-page')) {
                        e.preventDefault();
                        const pageName = this.getAttribute('data-page');
                        
                        // Проверка прав доступа
                        if (pageName === 'admin' && !userSystem.isAdmin()) {
                            showNotification('У вас нет прав доступа к админ-панели', 'error');
                            return;
                        }
                        
                        if (pageName === 'profile' && !userSystem.isLoggedIn()) {
                            showNotification('Для доступа к личному кабинету необходимо войти в систему', 'error');
                            return;
                        }

                        closeMobileMenu();
                        switchPage(pageName);
                    }
                });
            });

            // Кнопки авторизации в мобильном меню
            elements.mobileLoginBtn.addEventListener('click', function(e) {
                e.preventDefault();
                closeMobileMenu();
                elements.loginModal.classList.add('active');
            });

            elements.mobileRegisterBtn.addEventListener('click', function(e) {
                e.preventDefault();
                closeMobileMenu();
                switchPage('registration');
            });

            // Интерактивные элементы на главной странице
            document.querySelectorAll('.grid-item').forEach(item => {
                item.addEventListener('click', function() {
                    const page = this.getAttribute('data-page');
                    switchPage(page);
                });
            });

            // Настройки - открытие/закрытие выпадающего меню
            elements.settingsBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                elements.settingsDropdown.classList.toggle('active');
            });

            if (elements.settingsBtnUser) {
                elements.settingsBtnUser.addEventListener('click', function(e) {
                    e.stopPropagation();
                    elements.settingsDropdownUser.classList.toggle('active');
                });
            }

            // Закрытие выпадающих меню при клике вне их
            document.addEventListener('click', function() {
                elements.settingsDropdown.classList.remove('active');
                if (elements.settingsDropdownUser) {
                    elements.settingsDropdownUser.classList.remove('active');
                }
            });

            // Закрытие модальных окон при клике вне их
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('modal')) {
                    e.target.classList.remove('active');
                }
            });

            // Закрытие модальных окон по кнопке закрытия
            document.querySelectorAll('.modal-close').forEach(closeBtn => {
                closeBtn.addEventListener('click', function() {
                    this.closest('.modal').classList.remove('active');
                });
            });

            // Объединенная кнопка баланса и аватара - переход на страницу баланса
            elements.userAvatarBalance.addEventListener('click', function() {
                switchPage('balance');
            });

            // Регистрация
            document.getElementById('registration-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const userData = {
                    firstName: document.getElementById('reg-firstname').value,
                    lastName: document.getElementById('reg-lastname').value,
                    username: document.getElementById('reg-username').value,
                    email: document.getElementById('reg-email').value,
                    password: document.getElementById('reg-password').value,
                    phone: document.getElementById('reg-phone').value,
                    birthdate: document.getElementById('reg-birthdate').value
                };

                const confirmPassword = document.getElementById('reg-confirm-password').value;
                
                if (userData.password !== confirmPassword) {
                    showNotification('Пароли не совпадают!', 'error');
                    return;
                }

                const result = userSystem.register(userData);
                if (result.success) {
                    showNotification('Регистрация прошла успешно!', 'success');
                    userSystem.login(userData.email, userData.password);
                    updateAuthUI();
                    switchPage('main');
                    this.reset();
                } else {
                    showNotification(result.message, 'error');
                }
            });

            // Вход
            document.getElementById('login-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const email = document.getElementById('login-email').value;
                const password = document.getElementById('login-password').value;

                const result = userSystem.login(email, password);
                if (result.success) {
                    showNotification('Вход выполнен!', 'success');
                    elements.loginModal.classList.remove('active');
                    updateAuthUI();
                    this.reset();
                } else {
                    showNotification(result.message, 'error');
                }
            });

            // Обновление профиля
            document.getElementById('profile-form').addEventListener('submit', function(e) {
                e.preventDefault();
                if (!userSystem.currentUser) return;

                const userData = {
                    firstName: document.getElementById('profile-firstname').value,
                    lastName: document.getElementById('profile-lastname').value,
                    username: document.getElementById('profile-username').value,
                    email: document.getElementById('profile-email').value,
                    phone: document.getElementById('profile-phone').value,
                    birthdate: document.getElementById('profile-birthdate').value
                };

                const result = userSystem.updateUser(userSystem.currentUser.id, userData);
                if (result.success) {
                    showNotification('Профиль обновлен!', 'success');
                    loadProfileData();
                    updateAuthUI();
                } else {
                    showNotification(result.message, 'error');
                }
            });

            // Добавление отзыва
            document.getElementById('add-review-form').addEventListener('submit', function(e) {
                e.preventDefault();
                if (!userSystem.currentUser) {
                    showNotification('Для добавления отзыва необходимо войти в систему', 'error');
                    return;
                }

                const text = document.getElementById('review-text').value;
                if (text.trim().length < 10) {
                    showNotification('Отзыв должен содержать не менее 10 символов', 'error');
                    return;
                }

                userSystem.addReview(text, userSystem.currentUser.id);
                showNotification('Отзыв добавлен!', 'success');
                this.reset();
                loadReviews();
                loadProfileData();
            });

            // Форма бронирования
            document.getElementById('booking-form').addEventListener('submit', function(e) {
                e.preventDefault();
                showNotification('Бронирование принято! Мы свяжемся с вами для подтверждения.', 'success');
                this.reset();
            });

            // Кнопки покупки в магазине
            document.querySelectorAll('.buy-btn').forEach(button => {
                button.addEventListener('click', function() {
                    if (!userSystem.isLoggedIn()) {
                        showNotification('Для покупки необходимо войти в систему', 'error');
                        return;
                    }
                    
                    const product = this.getAttribute('data-product');
                    const price = parseInt(this.getAttribute('data-price'));
                    
                    // Проверяем баланс
                    if (userSystem.currentUser.balance < price) {
                        showNotification('Вам надо пофармить голды', 'error');
                        return;
                    }
                    
                    // Заполняем модальное окно покупки
                    document.getElementById('purchase-product-name').textContent = `Товар: ${product}`;
                    document.getElementById('purchase-product-price').textContent = `Цена: ${formatMoney(price)} ₽`;
                    document.getElementById('purchase-total-amount').textContent = `${formatMoney(price)} ₽`;
                    
                    // Устанавливаем текущую дату как минимальную
                    const today = new Date().toISOString().split('T')[0];
                    document.getElementById('purchase-date').min = today;
                    document.getElementById('purchase-date').value = today;
                    
                    // Устанавливаем текущее время + 1 час как минимальное
                    const now = new Date();
                    now.setHours(now.getHours() + 1);
                    document.getElementById('purchase-time').value = now.toTimeString().slice(0,5);
                    
                    // Сбрасываем выбор зоны
                    document.querySelectorAll('.zone-option').forEach(option => {
                        option.classList.remove('selected');
                    });
                    
                    // Сбрасываем форму
                    document.getElementById('purchase-form').reset();
                    document.getElementById('purchase-confirmation').classList.remove('active');
                    
                    // Сохраняем данные о товаре в data-атрибуты формы
                    const form = document.getElementById('purchase-form');
                    form.dataset.product = product;
                    form.dataset.price = price;
                    
                    // Показываем модальное окно
                    elements.purchaseModal.classList.add('active');
                });
            });

            // Выбор зоны в модальном окне покупки
            document.querySelectorAll('.zone-option').forEach(option => {
                option.addEventListener('click', function() {
                    // Снимаем выделение со всех зон
                    document.querySelectorAll('.zone-option').forEach(opt => {
                        opt.classList.remove('selected');
                    });
                    
                    // Выделяем выбранную зону
                    this.classList.add('selected');
                    
                    // Сохраняем выбранную зону в data-атрибут формы
                    document.getElementById('purchase-form').dataset.zone = this.dataset.zone;
                });
            });

            // Обработка формы покупки
            document.getElementById('purchase-form').addEventListener('submit', function(e) {
                e.preventDefault();
                if (!userSystem.currentUser) return;

                const product = this.dataset.product;
                const price = parseInt(this.dataset.price);
                const date = document.getElementById('purchase-date').value;
                const time = document.getElementById('purchase-time').value;
                const zone = this.dataset.zone;
                const comment = document.getElementById('purchase-comment').value;

                if (!zone) {
                    showNotification('Пожалуйста, выберите зону', 'error');
                    return;
                }

                // Списание средств
                const result = userSystem.deductBalance(userSystem.currentUser.id, price);
                if (result.success) {
                    // Добавляем покупку в историю
                    const purchaseData = {
                        product: product,
                        price: price,
                        date: date,
                        time: time,
                        zone: zone,
                        comment: comment
                    };
                    
                    userSystem.addPurchase(userSystem.currentUser.id, purchaseData);
                    
                    // Показываем подтверждение
                    const confirmationDetails = document.getElementById('confirmation-details');
                    confirmationDetails.innerHTML = `
                        <div class="confirmation-item">
                            <span class="confirmation-label">Товар:</span>
                            <span class="confirmation-value">${product}</span>
                        </div>
                        <div class="confirmation-item">
                            <span class="confirmation-label">Сумма:</span>
                            <span class="confirmation-value">${formatMoney(price)} ₽</span>
                        </div>
                        <div class="confirmation-item">
                            <span class="confirmation-label">Дата:</span>
                            <span class="confirmation-value">${date}</span>
                        </div>
                        <div class="confirmation-item">
                            <span class="confirmation-label">Время:</span>
                            <span class="confirmation-value">${time}</span>
                        </div>
                        <div class="confirmation-item">
                            <span class="confirmation-label">Зона:</span>
                            <span class="confirmation-value">${zone}</span>
                        </div>
                        ${comment ? `
                        <div class="confirmation-item">
                            <span class="confirmation-label">Комментарий:</span>
                            <span class="confirmation-value">${comment}</span>
                        </div>
                        ` : ''}
                        <div class="confirmation-item">
                            <span class="confirmation-label">Новый баланс:</span>
                            <span class="confirmation-value">${formatMoney(result.newBalance)} ₽</span>
                        </div>
                    `;
                    
                    document.getElementById('purchase-confirmation').classList.add('active');
                    updateAuthUI();
                } else {
                    showNotification(result.message, 'error');
                }
            });

            // Закрытие модального окна покупки
            document.getElementById('purchase-close-btn').addEventListener('click', function() {
                elements.purchaseModal.classList.remove('active');
            });

            document.getElementById('purchase-cancel-btn').addEventListener('click', function() {
                elements.purchaseModal.classList.remove('active');
            });

            // Кнопки участия в турнирах
            document.querySelectorAll('.register-btn').forEach(button => {
                button.addEventListener('click', function() {
                    if (!userSystem.isLoggedIn()) {
                        showNotification('Для участия в турнире необходимо войти в систему', 'error');
                        return;
                    }
                    showNotification('Заявка на участие в турнире отправлена!', 'success');
                });
            });

            // Кнопки авторизации
            document.getElementById('login-btn').addEventListener('click', function(e) {
                e.preventDefault();
                elements.loginModal.classList.add('active');
            });

            document.getElementById('register-btn').addEventListener('click', function(e) {
                e.preventDefault();
                switchPage('registration');
            });

            document.getElementById('register-main-btn').addEventListener('click', function() {
                switchPage('registration');
            });

            // Подтверждение выхода
            document.getElementById('logout-btn').addEventListener('click', function(e) {
                e.preventDefault();
                elements.logoutConfirmModal.classList.add('active');
            });

            document.getElementById('logout-cancel-btn').addEventListener('click', function() {
                elements.logoutConfirmModal.classList.remove('active');
            });

            document.getElementById('logout-confirm-btn').addEventListener('click', function() {
                userSystem.logout();
                updateAuthUI();
                showNotification('Вы вышли из системы', 'success');
                switchPage('main');
                elements.logoutConfirmModal.classList.remove('active');
            });

            // Закрытие модальных окон
            document.querySelectorAll('.modal-close, #login-cancel-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    elements.loginModal.classList.remove('active');
                });
            });

            // Админ табы
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    
                    // Обновляем активные табы
                    document.querySelectorAll('.admin-tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Показываем соответствующий контент
                    document.querySelectorAll('.admin-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    document.getElementById(`${tabName}-tab`).classList.add('active');

                    // Загружаем данные если нужно
                    if (tabName === 'users') {
                        loadAdminUsers();
                    } else if (tabName === 'reviews') {
                        loadReviews();
                    } else if (tabName === 'vk') {
                        updateVKStats();
                    }
                });
            });

            // Переключение страниц
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const pageName = this.getAttribute('data-page');
                    
                    // Проверка прав доступа
                    if (pageName === 'admin' && !userSystem.isAdmin()) {
                        showNotification('У вас нет прав доступа к админ-панели', 'error');
                        return;
                    }
                    
                    if (pageName === 'profile' && !userSystem.isLoggedIn()) {
                        showNotification('Для доступа к личному кабинету необходимо войти в систему', 'error');
                        return;
                    }

                    switchPage(pageName);
                });
            });

            // Переход на главную по логотипу
            document.getElementById('home-link').addEventListener('click', function(e) {
                e.preventDefault();
                switchPage('main');
            });

            // Отмена регистрации
            document.getElementById('reg-cancel-btn').addEventListener('click', function() {
                switchPage('main');
            });

            // Система пополнения баланса
            document.querySelectorAll('.payment-method').forEach(method => {
                method.addEventListener('click', function() {
                    const paymentMethod = this.getAttribute('data-method');
                    
                    // Скрываем все формы
                    document.querySelectorAll('.payment-form').forEach(form => {
                        form.classList.remove('active');
                    });
                    
                    // Показываем выбранную форму
                    document.getElementById(`${paymentMethod}-payment-form`).classList.add('active');
                });
            });

            // Обновление суммы платежа в реальном времени
            document.querySelectorAll('.money').forEach(input => {
                input.addEventListener('input', function() {
                    const form = this.closest('form');
                    if (form) {
                        const amountElement = form.querySelector('.payment-amount span');
                        if (amountElement) {
                            amountElement.textContent = this.value;
                        }
                    }
                });
            });

            // Обработка форм пополнения
            document.getElementById('card-payment-form-content').addEventListener('submit', function(e) {
                e.preventDefault();
                const amount = parseMoney(document.getElementById('card-amount').value);
                
                // Проверяем ограничение баланса на клиенте
                if (userSystem.currentUser.balance + amount > userSystem.MAX_BALANCE) {
                    showNotification(`Ошибка: Сумма пополнения превышает максимальный баланс. Максимально можно пополнить на ${formatMoney(userSystem.MAX_BALANCE - userSystem.currentUser.balance)} ₽.`, 'error');
                    return;
                }
                
                const result = userSystem.addBalance(userSystem.currentUser.id, amount);
                if (result.success) {
                    showNotification(`Баланс успешно пополнен на ${formatMoney(amount)} ₽!`, 'success');
                    updateAuthUI();
                    this.reset();
                    document.getElementById('card-payment-amount').textContent = '1 000';
                } else {
                    showNotification(result.message, 'error');
                }
            });

            document.getElementById('qiwi-payment-form-content').addEventListener('submit', function(e) {
                e.preventDefault();
                const amount = parseMoney(document.getElementById('qiwi-amount').value);
                
                // Проверяем ограничение баланса на клиенте
                if (userSystem.currentUser.balance + amount > userSystem.MAX_BALANCE) {
                    showNotification(`Ошибка: Сумма пополнения превышает максимальный баланс. Максимально можно пополнить на ${formatMoney(userSystem.MAX_BALANCE - userSystem.currentUser.balance)} ₽.`, 'error');
                    return;
                }
                
                const result = userSystem.addBalance(userSystem.currentUser.id, amount);
                if (result.success) {
                    showNotification(`Баланс успешно пополнен на ${formatMoney(amount)} ₽ через QIWI!`, 'success');
                    updateAuthUI();
                    this.reset();
                    document.getElementById('qiwi-payment-amount').textContent = '1 000';
                } else {
                    showNotification(result.message, 'error');
                }
            });

            document.getElementById('yoomoney-payment-form-content').addEventListener('submit', function(e) {
                e.preventDefault();
                const amount = parseMoney(document.getElementById('yoomoney-amount').value);
                
                // Проверяем ограничение баланса на клиенте
                if (userSystem.currentUser.balance + amount > userSystem.MAX_BALANCE) {
                    showNotification(`Ошибка: Сумма пополнения превышает максимальный баланс. Максимально можно пополнить на ${formatMoney(userSystem.MAX_BALANCE - userSystem.currentUser.balance)} ₽.`, 'error');
                    return;
                }
                
                const result = userSystem.addBalance(userSystem.currentUser.id, amount);
                if (result.success) {
                    showNotification(`Баланс успешно пополнен на ${formatMoney(amount)} ₽ через ЮMoney!`, 'success');
                    updateAuthUI();
                    this.reset();
                    document.getElementById('yoomoney-payment-amount').textContent = '1 000';
                } else {
                    showNotification(result.message, 'error');
                }
            });

            document.getElementById('crypto-payment-form-content').addEventListener('submit', function(e) {
                e.preventDefault();
                const amount = parseMoney(document.getElementById('crypto-amount').value);
                
                // Проверяем ограничение баланса на клиенте
                if (userSystem.currentUser.balance + amount > userSystem.MAX_BALANCE) {
                    showNotification(`Ошибка: Сумма пополнения превышает максимальный баланс. Максимально можно пополнить на ${formatMoney(userSystem.MAX_BALANCE - userSystem.currentUser.balance)} ₽.`, 'error');
                    return;
                }
                
                // Копируем адрес в буфер обмена
                const addressElement = document.querySelector('#crypto-payment-form .form-control');
                navigator.clipboard.writeText(addressElement.textContent)
                    .then(() => {
                        showNotification('Адрес для оплаты скопирован в буфер обмена!', 'success');
                    })
                    .catch(() => {
                        showNotification('Адрес для оплаты: ' + addressElement.textContent, 'success');
                    });
                
                showNotification(`После подтверждения транзакции на сумму ${formatMoney(amount)} ₽, баланс будет пополнен в течение 10 минут.`, 'success');
            });
        });

        // Функция переключения страниц
        function switchPage(pageName) {
            // Скрыть все страницы
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Показать выбранную страницу
            const pageId = pageName + '-page';
            document.getElementById(pageId).classList.add('active');
            document.getElementById(pageId).classList.add('page-transition');
            
            // Загрузить данные если нужно
            if (pageName === 'profile' && userSystem.isLoggedIn()) {
                loadProfileData();
            } else if (pageName === 'admin' && userSystem.isAdmin()) {
                loadAdminUsers();
            } else if (pageName === 'balance' && userSystem.isLoggedIn()) {
                // Обновляем баланс
                if (elements.balanceAmount) {
                    elements.balanceAmount.textContent = formatMoney(userSystem.currentUser.balance) + ' ₽';
                }
            } else if (pageName === 'news') {
                // Загружаем новости при переходе на страницу новостей
                loadVKNews();
            }
            
            // Запустить анимацию счетчиков если перешли на главную
            if (pageName === 'main') {
                setTimeout(() => {
                    document.querySelectorAll('.stat').forEach(stat => {
                        const valueElement = stat.querySelector('.stat-value');
                        const target = parseInt(stat.getAttribute('data-value'));
                        animateCounter(valueElement, target);
                    });
                }, 500);
            }
            
            // Прокрутить к верху
            window.scrollTo(0, 0);
        }

        // Создание красных молний
        function createRedLightning() {
            const container = document.getElementById('lightning-container');
            const lightningCount = 40;
            
            for (let i = 0; i < lightningCount; i++) {
                const lightning = document.createElement('div');
                lightning.classList.add('lightning');
                
                const top = Math.random() * 100;
                const delay = Math.random() * 6;
                const duration = 1.5 + Math.random() * 2;
                const direction = Math.random() > 0.5 ? 'lightningFlash' : 'lightningFlashReverse';
                
                lightning.style.top = `${top}%`;
                lightning.style.animationDelay = `${delay}s`;
                lightning.style.animationDuration = `${duration}s`;
                lightning.style.animationName = direction;
                
                container.appendChild(lightning);
            }
        }

        // Создание частиц
        function createParticles() {
            const container = document.getElementById('particles-container');
            const particleCount = 120;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.classList.add('particle');
                
                const left = Math.random() * 100;
                const delay = Math.random() * 15;
                const duration = 15 + Math.random() * 10;
                const size = 2 + Math.random() * 4;
                
                particle.style.left = `${left}%`;
                particle.style.animationDelay = `${delay}s`;
                particle.style.animationDuration = `${duration}s`;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                
                container.appendChild(particle);
            }
        }

        // Инициализация эффектов
        createRedLightning();
        createParticles();
        // Система подтверждения регистрации
class ConfirmationSystem {
    constructor() {
        this.confirmationModal = document.getElementById('confirmation-modal');
        this.confirmationCode = '';
        this.confirmationMethod = 'email';
        this.confirmationTarget = '';
        this.userData = null;
        this.timerInterval = null;
        this.timeLeft = 60;
    }

    showConfirmation(userData, confirmationData) {
        this.userData = userData;
        this.confirmationMethod = confirmationData.method;
        this.confirmationTarget = confirmationData.target;
        this.confirmationCode = confirmationData.code;
        
        // Обновляем UI
        this.updateConfirmationUI();
        
        // Сбрасываем таймер
        this.resetTimer();
        
        // Показываем модальное окно
        this.confirmationModal.classList.add('active');
        
        // Фокус на первый input
        setTimeout(() => {
            document.querySelector('.confirmation-code-input[data-index="0"]').focus();
        }, 100);
    }

    updateConfirmationUI() {
        // Обновляем бейдж метода
        const badgeIcon = document.getElementById('confirmation-badge-icon');
        const badgeText = document.getElementById('confirmation-badge-text');
        
        if (this.confirmationMethod === 'email') {
            badgeIcon.textContent = '📧';
            badgeText.textContent = 'Подтверждение по Email';
        } else {
            badgeIcon.textContent = '📱';
            badgeText.textContent = 'Подтверждение по SMS';
        }
        
        // Обновляем цель
        document.getElementById('confirmation-target').textContent = this.confirmationTarget;
        
        // Показываем код для демо
        document.getElementById('demo-confirmation-code').textContent = this.confirmationCode;
        
        // Сбрасываем inputs
        document.querySelectorAll('.confirmation-code-input').forEach(input => {
            input.value = '';
            input.classList.remove('filled');
        });
        
        // Скрываем успешное сообщение и ошибку
        document.getElementById('confirmation-success').style.display = 'none';
        document.getElementById('confirmation-error').classList.remove('show');
        document.getElementById('confirmation-inputs-container').style.display = 'flex';
        document.getElementById('confirmation-actions').style.display = 'flex';
    }

    resetTimer() {
        clearInterval(this.timerInterval);
        this.timeLeft = 60;
        this.updateTimer();
        
        this.timerInterval = setInterval(() => {
            this.timeLeft--;
            this.updateTimer();
            
            if (this.timeLeft <= 0) {
                clearInterval(this.timerInterval);
                this.enableResendButton();
            }
        }, 1000);
        
        this.disableResendButton();
    }

    updateTimer() {
        const timerElement = document.getElementById('timer-count');
        const timerContainer = document.getElementById('confirmation-timer');
        
        timerElement.textContent = this.timeLeft;
        
        if (this.timeLeft <= 10) {
            timerContainer.classList.add('expired');
        } else {
            timerContainer.classList.remove('expired');
        }
    }

    disableResendButton() {
        const resendBtn = document.getElementById('resend-code-btn');
        resendBtn.disabled = true;
        resendBtn.textContent = 'Отправить повторно';
    }

    enableResendButton() {
        const resendBtn = document.getElementById('resend-code-btn');
        resendBtn.disabled = false;
        resendBtn.textContent = 'Отправить новый код';
    }

    verifyCode() {
        // Собираем код из inputs
        const codeInputs = document.querySelectorAll('.confirmation-code-input');
        let enteredCode = '';
        
        codeInputs.forEach(input => {
            enteredCode += input.value;
        });
        
        // Проверяем длину
        if (enteredCode.length !== 6) {
            this.showError('Введите полный 6-значный код');
            return false;
        }
        
        // Проверяем код
        const result = userSystem.verifyConfirmationCode(this.confirmationTarget, enteredCode);
        
        if (result.success) {
            // Подтверждаем пользователя
            userSystem.confirmUser(this.userData.id);
            
            // Автоматически логиним пользователя
            const loginResult = userSystem.login(this.userData.email, this.userData.password);
            
            if (loginResult.success) {
                this.showSuccess();
                return true;
            }
        } else {
            this.showError(result.message);
            return false;
        }
    }

    showError(message) {
        const errorElement = document.getElementById('confirmation-error');
        errorElement.textContent = message;
        errorElement.classList.add('show');
        
        // Анимация ошибки
        errorElement.style.animation = 'none';
        setTimeout(() => {
            errorElement.style.animation = 'fadeIn 0.3s ease';
        }, 10);
    }

    showSuccess() {
        // Показываем успешное сообщение
        document.getElementById('confirmation-inputs-container').style.display = 'none';
        document.getElementById('confirmation-actions').style.display = 'none';
        document.getElementById('confirmation-error').classList.remove('show');
        document.getElementById('confirmation-success').style.display = 'block';
        
        // Останавливаем таймер
        clearInterval(this.timerInterval);
    }

    resendCode() {
        // Отправляем новый код
        const result = userSystem.resendConfirmationCode(
            this.userData.email,
            this.userData.phone,
            this.confirmationMethod
        );
        
        if (result.success) {
            this.confirmationCode = result.code;
            this.updateConfirmationUI();
            this.resetTimer();
            showNotification('Новый код отправлен!', 'success');
        }
    }
}

// Инициализация системы подтверждения
const confirmationSystem = new ConfirmationSystem();

// Обновляем функцию updateAuthUI для отображения статуса подтверждения
function updateAuthUI() {
    if (userSystem.isLoggedIn()) {
        elements.authButtons.style.display = 'none';
        elements.userMenu.style.display = 'flex';
        elements.userAvatar.textContent = 
            userSystem.currentUser.firstName[0] + userSystem.currentUser.lastName[0];
        
        // Проверяем, подтвержден ли аккаунт
        if (userSystem.isConfirmed()) {
            // Добавляем бейдж подтверждения
            const balanceElement = document.getElementById('user-balance-amount');
            if (balanceElement && !balanceElement.parentElement.querySelector('.user-confirmed-badge')) {
                const badge = document.createElement('span');
                badge.className = 'user-confirmed-badge';
                badge.innerHTML = '✓ Подтвержден';
                balanceElement.parentElement.appendChild(badge);
            }
        } else {
            // Показываем предупреждение
            showUnconfirmedWarning();
        }
        
        // Обновляем баланс в объединенной кнопке
        if (elements.userBalance) {
            elements.userBalance.textContent = formatMoney(userSystem.currentUser.balance);
        }
        
        if (userSystem.isAdmin()) {
            elements.adminLink.style.display = 'block';
        }
        
        // Показываем форму отзывов если пользователь авторизован И подтвержден
        if (elements.reviewFormContainer) {
            if (userSystem.isConfirmed()) {
                elements.reviewFormContainer.style.display = 'block';
            } else {
                elements.reviewFormContainer.style.display = 'none';
            }
        }
        
        // Обновляем баланс на странице баланса
        if (elements.balanceAmount) {
            elements.balanceAmount.textContent = formatMoney(userSystem.currentUser.balance) + ' ₽';
        }

        // Обновляем мобильное меню
        updateMobileMenu();
    } else {
        elements.authButtons.style.display = 'flex';
        elements.userMenu.style.display = 'none';
        elements.adminLink.style.display = 'none';

        // Скрываем форму отзывов
        if (elements.reviewFormContainer) {
            elements.reviewFormContainer.style.display = 'none';
        }

        // Обновляем мобильное меню
        updateMobileMenu();
    }
    loadReviews();
}

// Функция для показа предупреждения о неподтвержденном аккаунте
function showUnconfirmedWarning() {
    // Проверяем, не добавлено ли уже предупреждение
    if (document.querySelector('.unconfirmed-warning')) return;
    
    // Создаем предупреждение
    const warning = document.createElement('div');
    warning.className = 'unconfirmed-warning';
    warning.innerHTML = `
        <h4>⚠️ Аккаунт не подтвержден</h4>
        <p>Для доступа ко всем функциям платформы необходимо подтвердить ваш аккаунт.</p>
        <p>Проверьте ${userSystem.currentUser.confirmationMethod === 'email' ? 'электронную почту' : 'SMS сообщения'} и введите код подтверждения.</p>
        <button class="btn-secondary" id="request-new-code-btn">Отправить код повторно</button>
    `;
    
    // Добавляем предупреждение на главную страницу
    const mainPage = document.getElementById('main-page');
    if (mainPage.querySelector('.welcome-banner')) {
        mainPage.querySelector('.welcome-banner').after(warning);
    }
    
    // Обработчик для кнопки отправки кода повторно
    setTimeout(() => {
        const requestBtn = document.getElementById('request-new-code-btn');
        if (requestBtn) {
            requestBtn.addEventListener('click', function() {
                const result = userSystem.resendConfirmationCode(
                    userSystem.currentUser.email,
                    userSystem.currentUser.phone,
                    userSystem.currentUser.confirmationMethod
                );
                
                if (result.success) {
                    // Показываем модальное окно подтверждения
                    confirmationSystem.showConfirmation(userSystem.currentUser, result);
                    showNotification('Новый код отправлен!', 'success');
                }
            });
        }
    }, 100);
}

// Обновляем обработчик регистрации
document.getElementById('registration-form').addEventListener('submit', function(e) {
    e.preventDefault();
    
    // Получаем выбранный метод подтверждения
    const confirmationMethod = document.getElementById('confirmation-method').value;
    const confirmationAgreed = document.getElementById('confirmation-agreement').checked;
    
    const userData = {
        firstName: document.getElementById('reg-firstname').value,
        lastName: document.getElementById('reg-lastname').value,
        username: document.getElementById('reg-username').value,
        email: document.getElementById('reg-email').value,
        password: document.getElementById('reg-password').value,
        phone: document.getElementById('reg-phone').value,
        birthdate: document.getElementById('reg-birthdate').value,
        confirmationMethod: confirmationMethod,
        confirmationAgreed: confirmationAgreed
    };

    const confirmPassword = document.getElementById('reg-confirm-password').value;
    
    if (userData.password !== confirmPassword) {
        showNotification('Пароли не совпадают!', 'error');
        return;
    }
    
    if (!confirmationAgreed) {
        showNotification('Необходимо согласие на подтверждение аккаунта!', 'error');
        return;
    }

    const result = userSystem.register(userData);
    if (result.success) {
        showNotification('Регистрация прошла успешно! Подтвердите ваш аккаунт.', 'success');
        
        // Показываем модальное окно подтверждения
        confirmationSystem.showConfirmation(result.user, result.confirmation);
        
        // Не логиним автоматически, ждем подтверждения
        this.reset();
    } else {
        showNotification(result.message, 'error');
    }
});

// Обновляем обработчик входа для проверки подтверждения
document.getElementById('login-form').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const email = document.getElementById('login-email').value;
    const password = document.getElementById('login-password').value;

    const result = userSystem.login(email, password);
    if (result.success) {
        if (result.requiresConfirmation) {
            // Пользователь не подтвержден - показываем модальное окно подтверждения
            showNotification('Ваш аккаунт требует подтверждения', 'error');
            
            // Отправляем новый код
            const user = userSystem.users.find(u => u.email === email);
            if (user) {
                const confirmation = userSystem.resendConfirmationCode(
                    user.email,
                    user.phone,
                    user.confirmationMethod
                );
                
                if (confirmation.success) {
                    confirmationSystem.showConfirmation(user, confirmation);
                }
            }
        } else {
            showNotification('Вход выполнен!', 'success');
            elements.loginModal.classList.remove('active');
            updateAuthUI();
            this.reset();
        }
    } else {
        showNotification(result.message, 'error');
    }
});

// Обработчики для модального окна подтверждения
document.addEventListener('DOMContentLoaded', function() {
    // Выбор метода подтверждения в форме регистрации
    document.querySelectorAll('.confirmation-method').forEach(method => {
        method.addEventListener('click', function() {
            // Убираем выделение у всех методов
            document.querySelectorAll('.confirmation-method').forEach(m => {
                m.classList.remove('selected');
            });
            
            // Выделяем выбранный метод
            this.classList.add('selected');
            
            // Обновляем hidden input
            const methodValue = this.getAttribute('data-method');
            document.getElementById('confirmation-method').value = methodValue;
        });
    });
    
    // Ввод кода подтверждения
    document.querySelectorAll('.confirmation-code-input').forEach(input => {
        input.addEventListener('input', function(e) {
            const value = e.target.value;
            const index = parseInt(this.getAttribute('data-index'));
            
            // Разрешаем только цифры
            if (!/^\d?$/.test(value)) {
                this.value = '';
                return;
            }
            
            // Добавляем/убираем класс filled
            if (value) {
                this.classList.add('filled');
                
                // Автопереход к следующему полю
                if (index < 5) {
                    const nextInput = document.querySelector(`.confirmation-code-input[data-index="${index + 1}"]`);
                    if (nextInput) nextInput.focus();
                }
            } else {
                this.classList.remove('filled');
                
                // Переход к предыдущему полю при удалении
                if (index > 0 && e.inputType === 'deleteContentBackward') {
                    const prevInput = document.querySelector(`.confirmation-code-input[data-index="${index - 1}"]`);
                    if (prevInput) prevInput.focus();
                }
            }
        });
        
        // Обработка нажатия клавиш
        input.addEventListener('keydown', function(e) {
            const index = parseInt(this.getAttribute('data-index'));
            
            // Стрелка влево
            if (e.key === 'ArrowLeft' && index > 0) {
                e.preventDefault();
                const prevInput = document.querySelector(`.confirmation-code-input[data-index="${index - 1}"]`);
                if (prevInput) prevInput.focus();
            }
            
            // Стрелка вправо
            if (e.key === 'ArrowRight' && index < 5) {
                e.preventDefault();
                const nextInput = document.querySelector(`.confirmation-code-input[data-index="${index + 1}"]`);
                if (nextInput) nextInput.focus();
            }
            
            // Backspace
            if (e.key === 'Backspace' && !this.value && index > 0) {
                e.preventDefault();
                const prevInput = document.querySelector(`.confirmation-code-input[data-index="${index - 1}"]`);
                if (prevInput) {
                    prevInput.value = '';
                    prevInput.classList.remove('filled');
                    prevInput.focus();
                }
            }
        });
        
        // Вставка из буфера обмена
        input.addEventListener('paste', function(e) {
            e.preventDefault();
            const pasteData = e.clipboardData.getData('text').trim();
            
            if (/^\d{6}$/.test(pasteData)) {
                const inputs = document.querySelectorAll('.confirmation-code-input');
                inputs.forEach((inputEl, idx) => {
                    if (idx < 6) {
                        inputEl.value = pasteData[idx];
                        inputEl.classList.add('filled');
                    }
                });
                
                // Фокус на последнее поле
                inputs[5].focus();
            }
        });
    });
    
    // Кнопка подтверждения кода
    document.getElementById('verify-code-btn').addEventListener('click', function() {
        const success = confirmationSystem.verifyCode();
        if (success) {
            // Закрываем модальное окно через 3 секунды
            setTimeout(() => {
                confirmationSystem.confirmationModal.classList.remove('active');
                updateAuthUI();
                switchPage('main');
            }, 3000);
        }
    });
    
    // Кнопка отправки кода повторно
    document.getElementById('resend-code-btn').addEventListener('click', function() {
        confirmationSystem.resendCode();
    });
    
    // Кнопка продолжения после успешного подтверждения
    document.getElementById('confirmation-continue-btn').addEventListener('click', function() {
        confirmationSystem.confirmationModal.classList.remove('active');
        updateAuthUI();
        switchPage('main');
    });
    
    // Закрытие модального окна подтверждения
    confirmationSystem.confirmationModal.querySelector('.modal-close').addEventListener('click', function() {
        confirmationSystem.confirmationModal.classList.remove('active');
        
        // Если пользователь только что зарегистрировался, но не подтвердился
        if (userSystem.currentUser && !userSystem.isConfirmed()) {
            showNotification('Завершите подтверждение аккаунта для доступа ко всем функциям', 'error');
        }
    });
    
    // Автоподтверждение при вводе последней цифры
    document.addEventListener('input', function(e) {
        if (e.target.classList.contains('confirmation-code-input')) {
            const inputs = document.querySelectorAll('.confirmation-code-input');
            let allFilled = true;
            let code = '';
            
            inputs.forEach(input => {
                if (!input.value) allFilled = false;
                code += input.value;
            });
            
            // Если все поля заполнены, автоматически подтверждаем
            if (allFilled && code.length === 6) {
                // Небольшая задержка для UX
                setTimeout(() => {
                    const success = confirmationSystem.verifyCode();
                    if (success) {
                        setTimeout(() => {
                            confirmationSystem.confirmationModal.classList.remove('active');
                            updateAuthUI();
                            switchPage('main');
                        }, 3000);
                    }
                }, 500);
            }
        }
    });
});
// В обработчике кнопки покупки
document.querySelectorAll('.buy-btn').forEach(button => {
    button.addEventListener('click', function() {
        if (!userSystem.isLoggedIn()) {
            showNotification('Для покупки необходимо войти в систему', 'error');
            return;
        }
        
        // ПРОВЕРКА ПОДТВЕРЖДЕНИЯ
        if (!userSystem.isConfirmed()) {
            showNotification('Для совершения покупок необходимо подтвердить аккаунт', 'error');
            return;
        }
        
        // ... остальной код покупки
    });
});

// В обработчике добавления отзыва
document.getElementById('add-review-form').addEventListener('submit', function(e) {
    e.preventDefault();
    if (!userSystem.isLoggedIn()) {
        showNotification('Для добавления отзыва необходимо войти в систему', 'error');
        return;
    }
    
    // ПРОВЕРКА ПОДТВЕРЖДЕНИЯ
    if (!userSystem.isConfirmed()) {
        showNotification('Для добавления отзывов необходимо подтвердить аккаунт', 'error');
        return;
    }
    
    // ... остальной код отзыва
});
function updateMobileMenu() {
    if (!elements.mobileUserSection) return;
    
    if (userSystem.isLoggedIn()) {
        let confirmationBadge = '';
        if (userSystem.isConfirmed()) {
            confirmationBadge = '<span class="user-confirmed-badge" style="margin-left: 0.5rem;">✓</span>';
        }
        
        elements.mobileUserSection.innerHTML = `
            <div class="user-avatar-with-balance" style="margin: 1rem 0;">
                <div class="user-avatar">${userSystem.currentUser.firstName[0] + userSystem.currentUser.lastName[0]}</div>
                <div class="user-balance">Баланс: ${formatMoney(userSystem.currentUser.balance)} ₽ ${confirmationBadge}</div>
            </div>
            ${!userSystem.isConfirmed() ? `
            <div class="unconfirmed-warning" style="margin: 1rem 0; padding: 1rem;">
                <h4 style="font-size: 0.9rem;">⚠️ Аккаунт не подтвержден</h4>
                <button class="btn-secondary" id="mobile-request-code-btn" style="width: 100%; margin-top: 0.5rem;">
                    Отправить код подтверждения
                </button>
            </div>
            ` : ''}
            <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                <a href="#" class="nav-link" data-page="profile" style="text-align: center;">Кабинет</a>
                ${userSystem.isAdmin() ? '<a href="#" class="nav-link" data-page="admin" style="text-align: center;">Админ</a>' : ''}
                <a href="#" class="nav-link" id="mobile-logout-btn" style="text-align: center;">Выйти</a>
            </div>
        `;
        elements.mobileAuthButtons.style.display = 'none';
        elements.mobileUserSection.style.display = 'block';
        
        // Обработчик для кнопки отправки кода в мобильном меню
        const requestBtn = document.getElementById('mobile-request-code-btn');
        if (requestBtn) {
            requestBtn.addEventListener('click', function() {
                const result = userSystem.resendConfirmationCode(
                    userSystem.currentUser.email,
                    userSystem.currentUser.phone,
                    userSystem.currentUser.confirmationMethod
                );
                
                if (result.success) {
                    confirmationSystem.showConfirmation(userSystem.currentUser, result);
                    closeMobileMenu();
                    showNotification('Новый код отправлен!', 'success');
                }
            });
        }
    } else {
        elements.mobileUserSection.style.display = 'none';
        elements.mobileAuthButtons.style.display = 'flex';
    }
}
// Симуляция отправки кода подтверждения
class ConfirmationSimulator {
    constructor() {
        this.sentCodes = JSON.parse(localStorage.getItem('demoConfirmationCodes')) || {};
    }

    saveCodes() {
        localStorage.setItem('demoConfirmationCodes', JSON.stringify(this.sentCodes));
    }

    // Симуляция отправки SMS
    simulateSMSSend(phoneNumber, code) {
        console.log(`📱 [ДЕМО] SMS отправлено на ${phoneNumber}: Ваш код подтверждения: ${code}`);
        console.log(`Для демо используйте код: ${code}`);
        
        // Сохраняем код для демо
        this.sentCodes[phoneNumber] = {
            code: code,
            timestamp: Date.now(),
            type: 'sms'
        };
        this.saveCodes();
        
        // Показываем уведомление в интерфейсе
        this.showDemoNotification(`SMS отправлено на ${phoneNumber} (демо)`, code);
        
        return true;
    }

    // Симуляция отправки Email
    simulateEmailSend(email, code) {
        console.log(`📧 [ДЕМО] Email отправлен на ${email}: Ваш код подтверждения: ${code}`);
        console.log(`Для демо используйте код: ${code}`);
        
        // Сохраняем код для демо
        this.sentCodes[email] = {
            code: code,
            timestamp: Date.now(),
            type: 'email'
        };
        this.saveCodes();
        
        // Показываем уведомление в интерфейсе
        this.showDemoNotification(`Email отправлен на ${email} (демо)`, code);
        
        return true;
    }

    // Показать демо-уведомление
    showDemoNotification(message, code) {
        const notification = document.createElement('div');
        notification.className = 'notification success';
        notification.innerHTML = `
            <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                <strong>${message}</strong>
                <div style="display: flex; align-items: center; gap: 1rem; margin-top: 0.5rem;">
                    <span>Код для демо:</span>
                    <div style="
                        background: rgba(0, 255, 136, 0.1);
                        border: 2px solid var(--neon-green);
                        color: var(--neon-green);
                        padding: 0.5rem 1rem;
                        border-radius: 8px;
                        font-weight: 900;
                        font-size: 1.2rem;
                        letter-spacing: 3px;
                        font-family: 'Courier New', monospace;
                    ">${code}</div>
                </div>
                <small style="color: var(--text-secondary);">В реальном приложении код придет на указанный адрес/телефон</small>
            </div>
        `;
        
        document.body.appendChild(notification);
        
        // Показываем уведомление
        setTimeout(() => {
            notification.classList.add('show');
        }, 100);
        
        // Убираем через 10 секунд
        setTimeout(() => {
            notification.classList.remove('show');
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 500);
        }, 10000);
    }

    // Проверка кода
    verifyCode(target, code) {
        const savedCode = this.sentCodes[target];
        if (!savedCode) {
            return { success: false, message: 'Код не найден' };
        }
        
        // Проверяем, не устарел ли код (30 минут)
        if (Date.now() - savedCode.timestamp > 30 * 60 * 1000) {
            delete this.sentCodes[target];
            this.saveCodes();
            return { success: false, message: 'Код устарел' };
        }
        
        if (savedCode.code === code) {
            // Удаляем использованный код
            delete this.sentCodes[target];
            this.saveCodes();
            return { success: true };
        }
        
        return { success: false, message: 'Неверный код' };
    }

    // Получить все отправленные коды (для админки)
    getAllSentCodes() {
        return this.sentCodes;
    }
}

// Инициализация симулятора
const confirmationSimulator = new ConfirmationSimulator();

// ОБНОВЛЯЕМ КЛАСС UserSystem - ДОБАВЛЯЕМ РЕАЛЬНУЮ СИМУЛЯЦИЮ
// Найдите метод sendConfirmationCode в классе UserSystem и замените его на этот:
UserSystem.prototype.sendConfirmationCode = function(email, phone, method) {
    const code = this.generateConfirmationCode();
    const expiresAt = Date.now() + 30 * 60 * 1000; // Код действует 30 минут
    
    // Сохраняем ожидаемое подтверждение
    const target = method === 'email' ? email : phone;
    this.pendingConfirmations[target] = {
        code: code,
        expiresAt: expiresAt,
        method: method,
        attempts: 0,
        createdAt: Date.now()
    };
    
    this.savePendingConfirmations();
    
    // Симуляция отправки
    if (method === 'email') {
        confirmationSimulator.simulateEmailSend(email, code);
    } else {
        confirmationSimulator.simulateSMSSend(phone, code);
    }
    
    return {
        success: true,
        code: code,
        method: method,
        target: target
    };
};

// ОБНОВЛЯЕМ ПРОВЕРКУ КОДА - ДОБАВЛЯЕМ СИМУЛЯЦИЮ
UserSystem.prototype.verifyConfirmationCode = function(target, enteredCode) {
    // Сначала проверяем через симулятор (для демо)
    const demoVerification = confirmationSimulator.verifyCode(target, enteredCode);
    if (demoVerification.success) {
        // Удаляем из pendingConfirmations
        delete this.pendingConfirmations[target];
        this.savePendingConfirmations();
        return { success: true };
    }
    
    // Затем проверяем обычную систему (на всякий случай)
    const confirmation = this.pendingConfirmations[target];
    
    if (!confirmation) {
        return { success: false, message: 'Код подтверждения не найден' };
    }
    
    // Проверяем срок действия
    if (Date.now() > confirmation.expiresAt) {
        delete this.pendingConfirmations[target];
        this.savePendingConfirmations();
        return { success: false, message: 'Срок действия кода истек' };
    }
    
    // Увеличиваем счетчик попыток
    confirmation.attempts++;
    this.savePendingConfirmations();
    
    // Проверяем код
    if (confirmation.code === enteredCode) {
        // Успешное подтверждение
        delete this.pendingConfirmations[target];
        this.savePendingConfirmations();
        return { success: true };
    } else {
        if (confirmation.attempts >= 5) {
            // Слишком много неудачных попыток
            delete this.pendingConfirmations[target];
            this.savePendingConfirmations();
            return { 
                success: false, 
                message: 'Слишком много неверных попыток. Запросите новый код.' 
            };
        }
        return { 
            success: false, 
            message: `Неверный код. Осталось попыток: ${5 - confirmation.attempts}` 
        };
    }
};

// ДОБАВЛЯЕМ АДМИН-ПАНЕЛЬ ДЛЯ УПРАВЛЕНИЯ КОДАМИ
function addConfirmationAdminPanel() {
    // Добавляем вкладку в админ-панель
    const adminTabs = document.querySelector('.admin-tabs');
    if (adminTabs && !document.getElementById('confirmation-admin-tab')) {
        const tab = document.createElement('button');
        tab.className = 'admin-tab';
        tab.id = 'confirmation-admin-tab';
        tab.dataset.tab = 'confirmations';
        tab.textContent = '📧 Коды подтверждения';
        adminTabs.appendChild(tab);
        
        // Добавляем контент
        const adminContent = document.querySelector('.admin-panel');
        if (adminContent) {
            const content = document.createElement('div');
            content.id = 'confirmations-tab';
            content.className = 'admin-content';
            content.innerHTML = `
                <h3>Отправленные коды подтверждения</h3>
                <div class="user-list" id="confirmation-codes-list">
                    <p>Загружаем данные...</p>
                </div>
                <div class="form-actions" style="margin-top: 2rem;">
                    <button class="btn-secondary" id="refresh-codes-btn">Обновить список</button>
                    <button class="btn-danger" id="clear-old-codes-btn">Очистить старые коды (30+ мин)</button>
                </div>
                <div class="unconfirmed-warning" style="margin-top: 2rem;">
                    <h4>ℹ️ Информация о системе подтверждения</h4>
                    <p><strong>Демо-режим:</strong> Коды отображаются в консоли и в уведомлениях</p>
                    <p><strong>Для реального использования:</strong> Подключите SMS-шлюз или Email-сервис</p>
                    <p><strong>Лимиты:</strong> 5 попыток ввода, код действителен 30 минут</p>
                </div>
            `;
            adminContent.appendChild(content);
        }
        
        // Обработчик для вкладки
        tab.addEventListener('click', function() {
            loadConfirmationCodes();
        });
    }
}

// Функция загрузки отправленных кодов
function loadConfirmationCodes() {
    const container = document.getElementById('confirmation-codes-list');
    if (!container) return;
    
    const codes = confirmationSimulator.getAllSentCodes();
    const pending = userSystem.pendingConfirmations;
    
    if (Object.keys(codes).length === 0 && Object.keys(pending).length === 0) {
        container.innerHTML = '<p>Нет отправленных кодов</p>';
        return;
    }
    
    let html = '';
    
    // Отправленные коды (симуляция)
    for (const [target, data] of Object.entries(codes)) {
        const timeAgo = Math.floor((Date.now() - data.timestamp) / 60000); // минут назад
        const expired = timeAgo > 30;
        
        html += `
            <div class="user-item" style="${expired ? 'opacity: 0.6;' : ''}">
                <div class="user-info">
                    <div class="user-name">
                        ${data.type === 'email' ? '📧' : '📱'} 
                        ${target}
                        ${expired ? '<span style="color: var(--neon-pink);"> (Просрочен)</span>' : ''}
                    </div>
                    <div class="user-email">
                        Код: <strong>${data.code}</strong> • 
                        Отправлен: ${timeAgo} минут назад • 
                        Тип: ${data.type === 'email' ? 'Email' : 'SMS'}
                    </div>
                </div>
                <div class="admin-actions">
                    <span style="color: ${expired ? 'var(--neon-pink)' : 'var(--neon-green)'}">
                        ${expired ? '❌ Просрочен' : '✅ Активен'}
                    </span>
                </div>
            </div>
        `;
    }
    
    // Ожидающие подтверждения (система)
    for (const [target, data] of Object.entries(pending)) {
        const timeLeft = Math.floor((data.expiresAt - Date.now()) / 60000); // минут осталось
        const attempts = data.attempts || 0;
        
        html += `
            <div class="user-item" style="background: rgba(255, 238, 0, 0.05);">
                <div class="user-info">
                    <div class="user-name">
                        ${data.method === 'email' ? '📧' : '📱'} 
                        ${target}
                        <span style="color: var(--neon-yellow);"> (Ожидает подтверждения)</span>
                    </div>
                    <div class="user-email">
                        Код: <strong>${data.code}</strong> • 
                        Истекает через: ${timeLeft} минут • 
                        Попыток: ${attempts}/5
                    </div>
                </div>
                <div class="admin-actions">
                    <span style="color: var(--neon-yellow);">⏳ ${timeLeft} мин</span>
                </div>
            </div>
        `;
    }
    
    container.innerHTML = html;
}

// ДОБАВЛЯЕМ РЕАЛЬНЫЕ API ДЛЯ ОТПРАВКИ (СТАБЫ)
// В реальном приложении здесь будут настоящие API вызовы

class RealConfirmationAPI {
    // Заглушки для реальных API
    
    static async sendSMS(phone, code) {
        // В реальном приложении здесь будет вызов к SMS-шлюзу
        console.log(`[REAL SMS API] Отправка SMS на ${phone}: ${code}`);
        
        // Примеры реальных сервисов:
        // - Twilio (https://www.twilio.com/docs/sms)
        // - MessageBird (https://developers.messagebird.com/docs/sms-messaging)
        // - СМС-центр (https://smsc.ru/api/)
        // - UniSender (https://www.unisender.com/ru/support/api/messages/sendsms/)
        
        return {
            success: true,
            messageId: `sms_${Date.now()}`,
            provider: 'SMS_шлюз'
        };
    }
    
    static async sendEmail(email, code) {
        // В реальном приложении здесь будет вызов к Email-сервису
        console.log(`[REAL EMAIL API] Отправка Email на ${email}: ${code}`);
        
        // Примеры реальных сервисов:
        // - SendGrid (https://docs.sendgrid.com/for-developers/sending-email/api-getting-started)
        // - Mailgun (https://documentation.mailgun.com/en/latest/quickstart-sending.html)
        // - Amazon SES (https://docs.aws.amazon.com/ses/latest/dg/send-email-api.html)
        // - Яндекс.Почта для доменов
        
        return {
            success: true,
            messageId: `email_${Date.now()}`,
            provider: 'Email_сервис'
        };
    }
    
    static async sendTelegram(chatId, code) {
        // Дополнительно: отправка в Telegram
        console.log(`[REAL TELEGRAM API] Отправка в Telegram ${chatId}: ${code}`);
        
        return {
            success: true,
            messageId: `tg_${Date.now()}`
        };
    }
}

// ДОБАВЛЯЕМ КНОПКУ ДЛЯ ПРОВЕРКИ API В АДМИНКЕ
function addAPITestButtons() {
    const confirmationsTab = document.getElementById('confirmations-tab');
    if (confirmationsTab) {
        const apiTestSection = document.createElement('div');
        apiTestSection.className = 'admin-vk-section';
        apiTestSection.style.marginTop = '2rem';
        apiTestSection.innerHTML = `
            <h3>Тестирование API отправки</h3>
            <p>Проверка подключения к реальным сервисам отправки</p>
            <div style="display: flex; gap: 1rem; margin-top: 1.5rem; flex-wrap: wrap;">
                <button class="btn-secondary" id="test-sms-api">Тест SMS API</button>
                <button class="btn-secondary" id="test-email-api">Тест Email API</button>
                <button class="btn" id="setup-real-api">Настроить реальные API</button>
            </div>
            <div id="api-test-results" style="margin-top: 1.5rem; display: none;">
                <h4>Результаты тестирования:</h4>
                <div id="api-test-output"></div>
            </div>
        `;
        confirmationsTab.appendChild(apiTestSection);
        
        // Обработчики тестов
        document.getElementById('test-sms-api')?.addEventListener('click', testSMSAPI);
        document.getElementById('test-email-api')?.addEventListener('click', testEmailAPI);
        document.getElementById('setup-real-api')?.addEventListener('click', showAPISetupGuide);
    }
}

async function testSMSAPI() {
    const resultsDiv = document.getElementById('api-test-output');
    const resultsContainer = document.getElementById('api-test-results');
    
    resultsContainer.style.display = 'block';
    resultsDiv.innerHTML = '<p>🔄 Тестируем SMS API...</p>';
    
    try {
        // Тестовый номер для демо
        const result = await RealConfirmationAPI.sendSMS('+79990001122', '123456');
        
        if (result.success) {
            resultsDiv.innerHTML = `
                <div style="color: var(--neon-green);">
                    <p>✅ SMS API работает!</p>
                    <p>ID сообщения: ${result.messageId}</p>
                    <p>Провайдер: ${result.provider}</p>
                </div>
                <div class="unconfirmed-warning" style="margin-top: 1rem;">
                    <p><strong>Для реального использования:</strong></p>
                    <ol style="text-align: left; padding-left: 1.5rem;">
                        <li>Зарегистрируйтесь на <a href="https://www.twilio.com" target="_blank">Twilio</a> или другом SMS-шлюзе</li>
                        <li>Получите API ключи (SID, Token)</li>
                        <li>Настройте отправителя (Sender ID)</li>
                        <li>Замените заглушку в RealConfirmationAPI.sendSMS() на реальный код</li>
                    </ol>
                </div>
            `;
        }
    } catch (error) {
        resultsDiv.innerHTML = `<p style="color: var(--neon-pink);">❌ Ошибка: ${error.message}</p>`;
    }
}

async function testEmailAPI() {
    const resultsDiv = document.getElementById('api-test-output');
    const resultsContainer = document.getElementById('api-test-results');
    
    resultsContainer.style.display = 'block';
    resultsDiv.innerHTML = '<p>🔄 Тестируем Email API...</p>';
    
    try {
        const result = await RealConfirmationAPI.sendEmail('test@example.com', '123456');
        
        if (result.success) {
            resultsDiv.innerHTML = `
                <div style="color: var(--neon-green);">
                    <p>✅ Email API работает!</p>
                    <p>ID сообщения: ${result.messageId}</p>
                    <p>Провайдер: ${result.provider}</p>
                </div>
                <div class="unconfirmed-warning" style="margin-top: 1rem;">
                    <p><strong>Для реального использования:</strong></p>
                    <ol style="text-align: left; padding-left: 1.5rem;">
                        <li>Зарегистрируйтесь на <a href="https://sendgrid.com" target="_blank">SendGrid</a> или другом email-сервисе</li>
                        <li>Верифицируйте домен отправителя</li>
                        <li>Получите API ключ</li>
                        <li>Замените заглушку в RealConfirmationAPI.sendEmail() на реальный код</li>
                    </ol>
                </div>
            `;
        }
    } catch (error) {
        resultsDiv.innerHTML = `<p style="color: var(--neon-pink);">❌ Ошибка: ${error.message}</p>`;
    }
}

function showAPISetupGuide() {
    const modal = document.createElement('div');
    modal.className = 'modal active';
    modal.innerHTML = `
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2 class="modal-title">Настройка реальных API</h2>
                <button class="modal-close" onclick="this.closest('.modal').remove()">&times;</button>
            </div>
            <div style="padding: 2rem;">
                <h3>📱 Настройка SMS отправки</h3>
                <div class="booking-form" style="margin: 1rem 0;">
                    <h4>Пример кода для Twilio:</h4>
                    <pre style="
                        background: var(--dark-bg);
                        padding: 1rem;
                        border-radius: 8px;
                        overflow-x: auto;
                        font-family: 'Courier New', monospace;
                        font-size: 0.9rem;
                    ">
// Установите библиотеку: npm install twilio

const accountSid = 'ACXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX';
const authToken = 'your_auth_token';
const client = require('twilio')(accountSid, authToken);

async function sendRealSMS(phone, code) {
    try {
        const message = await client.messages.create({
            body: \`Ваш код подтверждения: \${code}\`,
            from: '+1234567890', // Ваш Twilio номер
            to: phone
        });
        
        return {
            success: true,
            messageId: message.sid
        };
    } catch (error) {
        console.error('SMS отправка не удалась:', error);
        throw error;
    }
}</pre>
                </div>
                
                <h3>📧 Настройка Email отправки</h3>
                <div class="booking-form" style="margin: 1rem 0;">
                    <h4>Пример кода для SendGrid:</h4>
                    <pre style="
                        background: var(--dark-bg);
                        padding: 1rem;
                        border-radius: 8px;
                        overflow-x: auto;
                        font-family: 'Courier New', monospace;
                        font-size: 0.9rem;
                    ">
// Установите библиотеку: npm install @sendgrid/mail

const sgMail = require('@sendgrid/mail');
sgMail.setApiKey(process.env.SENDGRID_API_KEY);

async function sendRealEmail(email, code) {
    const msg = {
        to: email,
        from: 'noreply@ваш-домен.ru',
        subject: 'Код подтверждения КиберСфера',
        text: \`Ваш код подтверждения: \${code}\`,
        html: \`&lt;strong&gt;Ваш код подтверждения: \${code}&lt;/strong&gt;\`
    };
    
    try {
        await sgMail.send(msg);
        return { success: true };
    } catch (error) {
        console.error('Email отправка не удалась:', error);
        throw error;
    }
}</pre>
                </div>
                
                <div class="unconfirmed-warning">
                    <h4>⚠️ Важные замечания:</h4>
                    <ol style="text-align: left; padding-left: 1.5rem; margin-top: 1rem;">
                        <li>Никогда не храните API ключи в фронтенд-коде</li>
                        <li>Используйте бэкенд для отправки сообщений</li>
                        <li>Настройте CORS на бэкенде</li>
                        <li>Реализуйте ограничение частоты запросов (rate limiting)</li>
                        <li>Логируйте все отправки для отладки</li>
                    </ol>
                </div>
                
                <div class="form-actions" style="margin-top: 2rem;">
                    <button class="btn" onclick="this.closest('.modal').remove()">Закрыть</button>
                </div>
            </div>
        </div>
    `;
    
    document.body.appendChild(modal);
}

// ИНИЦИАЛИЗАЦИЯ ПРИ ЗАГРУЗКЕ
document.addEventListener('DOMContentLoaded', function() {
    // Добавляем админ-панель для кодов
    addConfirmationAdminPanel();
    
    // Добавляем кнопки тестирования API
    setTimeout(addAPITestButtons, 1000);
    
    // Обработчики для админ-кнопок
    document.getElementById('refresh-codes-btn')?.addEventListener('click', loadConfirmationCodes);
    document.getElementById('clear-old-codes-btn')?.addEventListener('click', function() {
        const codes = confirmationSimulator.getAllSentCodes();
        let cleared = 0;
        const now = Date.now();
        
        for (const [target, data] of Object.entries(codes)) {
            if (now - data.timestamp > 30 * 60 * 1000) {
                delete confirmationSimulator.sentCodes[target];
                cleared++;
            }
        }
        
        confirmationSimulator.saveCodes();
        loadConfirmationCodes();
        showNotification(`Очищено ${cleared} просроченных кодов`, 'success');
    });
    
    // Добавляем демо-сообщение при загрузке
    setTimeout(() => {
        if (!userSystem.isLoggedIn()) {
            const demoAlert = document.createElement('div');
            demoAlert.className = 'notification';
            demoAlert.style.cssText = `
                position: fixed;
                bottom: 20px;
                left: 50%;
                transform: translateX(-50%);
                z-index: 1000;
                max-width: 500px;
                text-align: center;
            `;
            demoAlert.innerHTML = `
                <strong>🔧 Демо-режим подтверждения</strong>
                <p style="margin: 0.5rem 0; font-size: 0.9rem;">
                    Коды подтверждения отображаются в консоли браузера и во всплывающих уведомлениях.
                    В реальном приложении они будут приходить на email/SMS.
                </p>
                <small style="color: var(--text-secondary);">Нажмите чтобы скрыть</small>
            `;
            
            demoAlert.addEventListener('click', function() {
                this.classList.remove('show');
                setTimeout(() => {
                    if (this.parentNode) {
                        this.parentNode.removeChild(this);
                    }
                }, 500);
            });
            
            document.body.appendChild(demoAlert);
            
            setTimeout(() => {
                demoAlert.classList.add('show');
            }, 100);
        }
    }, 3000);
});

// ОБНОВЛЯЕМ ФУНКЦИЮ ПОКАЗА УВЕДОМЛЕНИЙ ДЛЯ ЛУЧШЕЙ ВИДИМОСТИ
function showNotification(message, type = '') {
    const notification = document.getElementById('notification');
    const notificationMessage = document.getElementById('notification-message');
    
    if (!notification || !notificationMessage) return;
    
    // Создаем новое уведомление если старое активно
    if (notification.classList.contains('show')) {
        notification.classList.remove('show');
        setTimeout(() => {
            showNotification(message, type);
        }, 300);
        return;
    }
    
    notificationMessage.innerHTML = message;
    notification.className = 'notification';
    
    if (type) {
        notification.classList.add(type);
    }
    
    // Добавляем иконку в зависимости от типа
    if (type === 'success') {
        notificationMessage.innerHTML = `✅ ${message}`;
    } else if (type === 'error') {
        notificationMessage.innerHTML = `❌ ${message}`;
    }
    
    notification.classList.add('show');
    
    // Автоматически скрываем через 5 секунд
    setTimeout(() => {
        notification.classList.remove('show');
    }, 5000);
}
    </script>
</body>
</html>
